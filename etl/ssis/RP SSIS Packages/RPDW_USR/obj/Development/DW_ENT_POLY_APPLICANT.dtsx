<?xml version="1.0"?>
<DTS:Executable xmlns:DTS="www.microsoft.com/SqlServer/Dts"
  DTS:refId="Package"
  DTS:CreationDate="1/30/2019 1:46:31 PM"
  DTS:CreationName="Microsoft.Package"
  DTS:CreatorComputerName="NCS-110119GM22"
  DTS:CreatorName="NCS\P0500388"
  DTS:DelayValidation="True"
  DTS:DTSID="{F51334F5-DD7A-4567-8A86-BEE8269DC158}"
  DTS:ExecutableType="Microsoft.Package"
  DTS:LastModifiedProductVersion="15.0.0900.40"
  DTS:LocaleID="18441"
  DTS:ObjectName="DW_ENT_POLY_APPLICANT"
  DTS:PackageType="5"
  DTS:VersionBuild="517"
  DTS:VersionGUID="{37AA8523-97DE-4CAE-84F0-130E9FE2342F}">
  <DTS:Property
    DTS:Name="PackageFormatVersion">8</DTS:Property>
  <DTS:ConnectionManagers>
    <DTS:ConnectionManager
      DTS:refId="Package.ConnectionManagers[OutputTextFile_Conn]"
      DTS:CreationName="FLATFILE"
      DTS:DTSID="{E86D551B-20D5-45C9-B104-4977A44ABAFC}"
      DTS:ObjectName="OutputTextFile_Conn">
      <DTS:PropertyExpression
        DTS:Name="ConnectionString">@[$Project::FTP_LocalPath_Weekly] + @[User::Filename]  +  RIGHT ((DT_STR,4,1252)YEAR(GETDATE()),4) + RIGHT ("0" + (DT_STR,2,1252)MONTH(GETDATE()),2) + RIGHT ("0" + (DT_STR,2,1252)DAY(GETDATE()),2) + ".txt"</DTS:PropertyExpression>
      <DTS:ObjectData>
        <DTS:ConnectionManager
          DTS:Format="Delimited"
          DTS:LocaleID="1033"
          DTS:HeaderRowDelimiter="_x000D__x000A_"
          DTS:ColumnNamesInFirstDataRow="True"
          DTS:RowDelimiter=""
          DTS:TextQualifier="_x003C_none_x003E_"
          DTS:CodePage="1252"
          DTS:ConnectionString="E:\RPDW_USR\AIE\AIE_PRD\DW\Weekly\DW_polyapplicant_20210816.txt">
          <DTS:FlatFileColumns>
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x007C__x003B_"
              DTS:MaximumWidth="11"
              DTS:DataType="129"
              DTS:TextQualified="True"
              DTS:ObjectName="EMPLID"
              DTS:DTSID="{030195A4-C384-45CD-942E-D2F13BC746D8}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x007C__x003B_"
              DTS:MaximumWidth="6"
              DTS:DataType="129"
              DTS:TextQualified="True"
              DTS:ObjectName="Acad_Year"
              DTS:DTSID="{65BF60A6-128F-4273-B47C-CAFA6FFC371F}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x007C__x003B_"
              DTS:MaximumWidth="100"
              DTS:DataType="129"
              DTS:TextQualified="True"
              DTS:ObjectName="Admission_Exercise"
              DTS:DTSID="{9BC54C7A-2234-4146-8325-76F9BCFE9F31}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x007C__x003B_"
              DTS:MaximumWidth="4"
              DTS:DataType="129"
              DTS:TextQualified="True"
              DTS:ObjectName="Admit_Term"
              DTS:DTSID="{872D1A2B-79CD-4971-97F6-C81FF6A1524D}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x007C__x003B_"
              DTS:MaximumWidth="8"
              DTS:DataType="129"
              DTS:TextQualified="True"
              DTS:ObjectName="Application_Number"
              DTS:DTSID="{ACA0FBAA-91D2-4CCB-A8BF-E9539FC9E2CC}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x007C__x003B_"
              DTS:MaximumWidth="10"
              DTS:DataType="129"
              DTS:TextQualified="True"
              DTS:ObjectName="Sec_School_Code"
              DTS:DTSID="{2FCC2A16-067B-436D-B164-842A9C3A3242}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x007C__x003B_"
              DTS:MaximumWidth="6"
              DTS:DataType="129"
              DTS:TextQualified="True"
              DTS:ObjectName="Raw_Agg"
              DTS:DTSID="{E932F632-0318-4F47-87ED-15E66E55F492}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x007C__x003B_"
              DTS:MaximumWidth="6"
              DTS:DataType="129"
              DTS:TextQualified="True"
              DTS:ObjectName="Net_Agg"
              DTS:DTSID="{4B1F6211-1B36-4FD5-8AB7-4B6A452D7B35}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x007C__x003B_"
              DTS:MaximumWidth="4"
              DTS:DataType="129"
              DTS:TextQualified="True"
              DTS:ObjectName="Subject_Code_10"
              DTS:DTSID="{9E03275B-5647-487F-ABC9-666D1523DE17}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x007C__x003B_"
              DTS:MaximumWidth="4"
              DTS:DataType="129"
              DTS:TextQualified="True"
              DTS:ObjectName="Subject_Code_11"
              DTS:DTSID="{43CF1531-B48A-4140-B328-DA64F7193907}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x007C__x003B_"
              DTS:MaximumWidth="4"
              DTS:DataType="129"
              DTS:TextQualified="True"
              DTS:ObjectName="Subject_Code_12"
              DTS:DTSID="{F4B23FAA-C4B2-4452-880F-615F8B2F890D}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x007C__x003B_"
              DTS:MaximumWidth="4"
              DTS:DataType="129"
              DTS:TextQualified="True"
              DTS:ObjectName="Subject_Code_1"
              DTS:DTSID="{04864B93-6978-4830-B332-4B1B13770ACA}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x007C__x003B_"
              DTS:MaximumWidth="4"
              DTS:DataType="129"
              DTS:TextQualified="True"
              DTS:ObjectName="Subject_Code_2"
              DTS:DTSID="{4A6DA60A-CD8F-4AC5-B73F-69851AA5331A}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x007C__x003B_"
              DTS:MaximumWidth="4"
              DTS:DataType="129"
              DTS:TextQualified="True"
              DTS:ObjectName="Subject_Code_3"
              DTS:DTSID="{A8BFC52B-BF97-43A0-8A43-7583DDD888B9}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x007C__x003B_"
              DTS:MaximumWidth="4"
              DTS:DataType="129"
              DTS:TextQualified="True"
              DTS:ObjectName="Subject_Code_4"
              DTS:DTSID="{FBFB4329-FA74-4792-8041-F16DE2F3CA13}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x007C__x003B_"
              DTS:MaximumWidth="4"
              DTS:DataType="129"
              DTS:TextQualified="True"
              DTS:ObjectName="Subject_Code_5"
              DTS:DTSID="{983FAE7B-EA62-457C-A072-55B207FD6B1C}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x007C__x003B_"
              DTS:MaximumWidth="4"
              DTS:DataType="129"
              DTS:TextQualified="True"
              DTS:ObjectName="Subject_Code_6"
              DTS:DTSID="{79EBDA44-444C-4058-A48D-5F0305A90068}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x007C__x003B_"
              DTS:MaximumWidth="4"
              DTS:DataType="129"
              DTS:TextQualified="True"
              DTS:ObjectName="Subject_Code_7"
              DTS:DTSID="{9CA10A1F-1F2E-4F83-950D-A67D83AC6F20}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x007C__x003B_"
              DTS:MaximumWidth="4"
              DTS:DataType="129"
              DTS:TextQualified="True"
              DTS:ObjectName="Subject_Code_8"
              DTS:DTSID="{BF81E8E3-9E0A-44B5-A69C-64DAA71AF68B}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x007C__x003B_"
              DTS:MaximumWidth="4"
              DTS:DataType="129"
              DTS:TextQualified="True"
              DTS:ObjectName="Subject_Code_9"
              DTS:DTSID="{7EF84718-02D3-447B-8B7F-38B6317FA5BF}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x007C__x003B_"
              DTS:MaximumWidth="1"
              DTS:DataType="129"
              DTS:TextQualified="True"
              DTS:ObjectName="Grade_10"
              DTS:DTSID="{F4CD827D-C05F-4B42-8988-4EA6E19D56DC}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x007C__x003B_"
              DTS:MaximumWidth="1"
              DTS:DataType="129"
              DTS:TextQualified="True"
              DTS:ObjectName="Grade_11"
              DTS:DTSID="{16EE097E-DC43-4F31-8A55-4CD8A4A86C76}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x007C__x003B_"
              DTS:MaximumWidth="1"
              DTS:DataType="129"
              DTS:TextQualified="True"
              DTS:ObjectName="Grade_12"
              DTS:DTSID="{37A7CF01-A86E-4868-9BEA-0FDFB7EB61F2}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x007C__x003B_"
              DTS:MaximumWidth="1"
              DTS:DataType="129"
              DTS:TextQualified="True"
              DTS:ObjectName="Grade_1"
              DTS:DTSID="{DD00D7F3-E569-416F-9FDB-230198D3F748}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x007C__x003B_"
              DTS:MaximumWidth="1"
              DTS:DataType="129"
              DTS:TextQualified="True"
              DTS:ObjectName="Grade_2"
              DTS:DTSID="{F115A6B3-C3D2-401B-A28B-B51DA8E83C61}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x007C__x003B_"
              DTS:MaximumWidth="1"
              DTS:DataType="129"
              DTS:TextQualified="True"
              DTS:ObjectName="Grade_3"
              DTS:DTSID="{47481B88-6AB5-4FEA-BE2E-9BB88496481D}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x007C__x003B_"
              DTS:MaximumWidth="1"
              DTS:DataType="129"
              DTS:TextQualified="True"
              DTS:ObjectName="Grade_4"
              DTS:DTSID="{4F83B247-6DD5-4313-83D1-6C0A24CF9C00}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x007C__x003B_"
              DTS:MaximumWidth="1"
              DTS:DataType="129"
              DTS:TextQualified="True"
              DTS:ObjectName="Grade_5"
              DTS:DTSID="{682D8BE6-2525-4437-8074-71CBF83EAE3A}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x007C__x003B_"
              DTS:MaximumWidth="1"
              DTS:DataType="129"
              DTS:TextQualified="True"
              DTS:ObjectName="Grade_6"
              DTS:DTSID="{41DCA3BD-7023-4866-8B66-618A27812486}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x007C__x003B_"
              DTS:MaximumWidth="1"
              DTS:DataType="129"
              DTS:TextQualified="True"
              DTS:ObjectName="Grade_7"
              DTS:DTSID="{1FFCADE1-A48D-4800-A6DE-4DF38BEB20AF}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x007C__x003B_"
              DTS:MaximumWidth="1"
              DTS:DataType="129"
              DTS:TextQualified="True"
              DTS:ObjectName="Grade_8"
              DTS:DTSID="{83F23C37-9B0A-4ED7-9648-9B75D6524FCD}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x007C__x003B_"
              DTS:MaximumWidth="1"
              DTS:DataType="129"
              DTS:TextQualified="True"
              DTS:ObjectName="Grade_9"
              DTS:DTSID="{C39881B0-7670-4D98-BC04-A022A36536D9}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x000D__x000A_"
              DTS:MaximumWidth="4"
              DTS:DataType="129"
              DTS:TextQualified="True"
              DTS:ObjectName="yearexam"
              DTS:DTSID="{EDBF84C2-46DE-4B7E-844F-678F76C49E07}"
              DTS:CreationName="" />
          </DTS:FlatFileColumns>
        </DTS:ConnectionManager>
      </DTS:ObjectData>
    </DTS:ConnectionManager>
  </DTS:ConnectionManagers>
  <DTS:PackageParameters>
    <DTS:PackageParameter
      DTS:CreationName=""
      DTS:DataType="8"
      DTS:DTSID="{EF711E24-EE02-4EF9-B340-6A6D3DF7603C}"
      DTS:ObjectName="NILL_Output_Connection_ConnectionString">
      <DTS:Property
        DTS:DataType="8"
        DTS:Name="ParameterValue">E:\RPDW_USR\AIE\AIE_UAT\DW\DW_course_20201206.txt</DTS:Property>
    </DTS:PackageParameter>
  </DTS:PackageParameters>
  <DTS:Variables>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{128D0B78-C615-40B8-98C3-4E81E9A0D4D4}"
      DTS:IncludeInDebugDump="6789"
      DTS:Namespace="User"
      DTS:ObjectName="DepCursorCnt">
      <DTS:VariableValue
        DTS:DataType="3">0</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{E7230189-2125-445E-89BF-E64A62F08784}"
      DTS:IncludeInDebugDump="6789"
      DTS:Namespace="User"
      DTS:ObjectName="DepFailCnt">
      <DTS:VariableValue
        DTS:DataType="3">0</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{3608008D-2564-45F9-9383-93FC0C480675}"
      DTS:IncludeInDebugDump="6789"
      DTS:Namespace="User"
      DTS:ObjectName="DepSuccessCnt">
      <DTS:VariableValue
        DTS:DataType="3">0</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{39ABFCF3-64B9-45DF-83DA-A35F9DB8ADB4}"
      DTS:IncludeInDebugDump="6789"
      DTS:Namespace="User"
      DTS:ObjectName="Duplicate_Check">
      <DTS:VariableValue
        DTS:DataType="3">0</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{B27E3839-1C0D-4E9D-B778-AA957799F506}"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="DWSourceTable">
      <DTS:VariableValue
        DTS:DataType="8">DW</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{CCF50D29-E3B7-4278-9EED-ACD610B89E6C}"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="Filename">
      <DTS:VariableValue
        DTS:DataType="8">DW_polyapplicant_</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{8145A7CC-4283-40D1-A792-32B5424DB548}"
      DTS:EvaluateAsExpression="True"
      DTS:Expression="@[System::PackageName]"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="Job_name">
      <DTS:VariableValue
        DTS:DataType="8">DW_ENT_POLY_APPLICANT</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{25054502-8BEF-486A-8E15-062FCF7344A0}"
      DTS:IncludeInDebugDump="6789"
      DTS:Namespace="User"
      DTS:ObjectName="Job_Status">
      <DTS:VariableValue
        DTS:DataType="3">0</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{73C1F0FE-3FAF-450B-9CAE-B9A24A300CD6}"
      DTS:IncludeInDebugDump="6789"
      DTS:Namespace="User"
      DTS:ObjectName="JOB_STATUS_ID">
      <DTS:VariableValue
        DTS:DataType="3">0</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{B752C5B4-1DA0-4B0C-8984-EAC2887BDE89}"
      DTS:IncludeInDebugDump="6789"
      DTS:Namespace="User"
      DTS:ObjectName="Mandatory_constraint_Check">
      <DTS:VariableValue
        DTS:DataType="3">0</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{167FE88D-A6BA-4B96-AF28-3FE0D87E3612}"
      DTS:IncludeInDebugDump="6789"
      DTS:Namespace="User"
      DTS:ObjectName="Process_date">
      <DTS:VariableValue
        DTS:DataType="7">2/1/2019 2:58:00 PM</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{B6344B73-1FA0-4D9B-8679-EF4496CBE339}"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="SourceTable">
      <DTS:VariableValue
        DTS:DataType="8">Multiple DW Tables. Refer to ETL Specs</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{CC1F2D68-23D4-463D-96D4-033F525B375C}"
      DTS:EvaluateAsExpression="True"
      DTS:Expression="&quot;&quot;"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="SQL_CheckDepndcy">
      <DTS:VariableValue
        DTS:DataType="8"
        xml:space="preserve"></DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{FF1DBAFC-96B7-4EEA-8F83-F63556399A96}"
      DTS:EvaluateAsExpression="True"
      DTS:Expression="&quot;&#xA;BEGIN TRANSACTION &#xA;BEGIN TRY&#xA;&#xA;------------&#xA;IF OBJECT_ID(N'tempdb..##TMP_Poly_Applicant') IS NOT NULL&#xA;BEGIN&#xA;  DROP TABLE ##TMP_Poly_Applicant&#xA;END&#xA;&#xA;IF OBJECT_ID(N'tempdb..##TMP_TBL1') IS NOT NULL&#xA;BEGIN&#xA;  DROP TABLE ##TMP_TBL1&#xA;END&#xA;&#xA;IF OBJECT_ID(N'tempdb..##TMP_TBL2') IS NOT NULL&#xA;BEGIN&#xA;  DROP TABLE ##TMP_TBL2&#xA;END&#xA;&#xA;IF OBJECT_ID(N'tempdb..##TMP_OTHER_ADM_EXE') IS NOT NULL&#xA;BEGIN&#xA;  DROP TABLE ##TMP_OTHER_ADM_EXE&#xA;END&#xA;&#xA;IF OBJECT_ID(N'tempdb..##TMP_DW_EXT_DPAEAE_JAE') IS NOT NULL&#xA;BEGIN&#xA;  DROP TABLE ##TMP_DW_EXT_DPAEAE_JAE&#xA;END&#xA;&#xA;IF OBJECT_ID(N'tempdb..##TMP_TBL3') IS NOT NULL&#xA;BEGIN&#xA;  DROP TABLE ##TMP_TBL3&#xA;END&#xA;&#xA;IF OBJECT_ID(N'tempdb..##TMP_TBL4') IS NOT NULL&#xA;BEGIN&#xA;  DROP TABLE ##TMP_TBL4&#xA;END&#xA;&#xA;&#xA;&#xA;DECLARE @jobstatusid varchar(5)&#xA;,@condition varchar(100)&#xA;,@filter_criteria varchar(100)&#xA;,@QUAL_TYPE varchar(100)&#xA;,@query nvarchar(max)&#xA;,@job_name varchar(100)&#xA;,@source_cnt INT&#xA;,@target_cnt INT&#xA;,@all_queries varchar(4000)&#xA;,@outputfilename varchar(200)&#xA;,@date1 varchar(10)&#xA;;&#xA;&#xA;SET @source_cnt=0;&#xA;SET @target_cnt=0;&#xA;&#xA;&#xA;select @jobstatusid=&quot;+ (DT_STR, 5,1252) @[User::JOB_STATUS_ID] +&quot;;&#xA;select @date1=convert(varchar(10),GETDATE(),112);&#xA;select @outputfilename=CONCAT('&quot;+ @[User::Filename] +&quot;',@date1,'.txt');&#xA;&#xA;&#xA;SELECT @filter_criteria=FILTER_CRITERIA, @QUAL_TYPE=QUAL_TYPE_CRITERIA FROM &quot;+ @[$Project::RPDW_USR_Initial_Catalog] +&quot;.[dbo].[ETL_JOB_PARAMS]  &#xA;WHERE JOB_NAME='&quot;+ @[User::Job_name] +&quot;';&#xA;&#xA;IF  @filter_criteria='FULL-LOAD' &#xA;  BEGIN&#xA;     SET @condition=';';&#xA;  END&#xA;ELSE IF @filter_criteria&lt;&gt;'' OR ISNULL(@filter_criteria,N'')&lt;&gt;'' &#xA;    BEGIN&#xA;&#x9;    SET @condition=CONCAT('AND ',@filter_criteria,';');&#xA;    END&#xA;;  &#xA;&#xA;&#xA;&#xA;TRUNCATE TABLE &quot;+ @[$Project::RPDW_USR_Initial_Catalog] +&quot;.[dbo].&quot;+ @[User::TgtTableName]+&quot;  &#xA;;&#xA;&#xA;--&#xA;-- 1) POLY APPLICANT DETAILS &#xA;--&#xA;&#xA;-- Begin SET&#xA;SET @query=CONCAT(&#xA;    N'SELECT&#xA;&#x9;&#x9; CONVERT(varchar(4), CONCAT(''20'',LEFT(a.Admit_Term,2))) AS Academic_Year&#xA;&#x9;&#x9;,CASE WHEN RIGHT(a.Admit_Term,2)=''10'' THEN CAST (''S1'' AS VARCHAR(2))&#xA;&#x9;&#x9;&#x9;  WHEN RIGHT(a.Admit_Term,2)=''00'' THEN CAST (''S1'' AS VARCHAR(2))&#xA;&#x9;&#x9;&#x9;  ELSE CAST (''S1'' AS VARCHAR(2))&#xA;&#x9;&#x9;&#x9;  END AS Semester  &#xA;&#x9;&#x9;,a.Admit_Type&#xA;&#x9;&#x9;,a.Applicant_Id                     &#xA;&#x9;&#x9;,a.Admit_Term&#xA;&#x9;&#x9;,a.App_Number&#xA;&#x9;&#x9;,a.Primary_National_ID              &#xA;&#x9;&#x9;,a.Masked_Primary_National_ID        &#xA;&#x9;&#x9;,a.Entry_Qual&#xA;&#x9;&#x9;,LEFT(b.Action_Date,4) as Action_Year&#xA;&#x9;&#x9;&#xA;&#x9;&#x9;INTO ##TMP_TBL1&#xA;&#xA;&#x9;&#x9;FROM &quot;+ @[$Project::RPDW_Initial_Catalog] +&quot;.[dbo].[DW_APPLICANT_DETAILS] a WITH (NOLOCK)&#xA;&#x9;&#xA;&#x9;&#x9;LEFT JOIN &quot;+ @[$Project::RPDW_Initial_Catalog] +&quot;.[dbo].[DW_APPLICANT_PROGRAM_STATUS] b  WITH (NOLOCK)&#xA;&#x9;&#xA;&#x9;&#x9;ON a.App_Number = b.App_Number&#xA;&#x9;&#x9;and a.Admit_Term = b.Admit_Term&#xA;&#xA;&#x9;&#x9;WHERE a.Admit_Term &lt;&gt; (''NA'') &#xA;&#x9;&#x9;AND b.Programme_Action = (''ADMT'')&#xA;&#x9;&#x9;AND a.Qual_Type IN &#xA;&#x9;',@QUAL_TYPE&#xA;&#x9;);  -- End Set&#x9;&#xA;&#x9; &#xA;  PRINT (@query);&#xA;  SET @all_queries=CONCAT(N'',@all_queries,@query);  &#xA;  EXEC (@query);&#x9; &#xA;&#xA;&#xA;--&#xA;-- DW_EXT_DPAEAE_JAE &#xA;--&#xA;; WITH TMP_DW_EXT_DPAEAE_JAE AS (&#xA;&#xA; &#x9;&#x9;-- EXT_DPAEAE_JAE&#xA;&#x9;&#x9;SELECT &#xA;&#x9;&#x9;UIN&#x9;COLLATE SQL_Latin1_General_CP1_CI_AS&#x9;&#x9;&#x9;AS UIN&#xA;&#x9;&#x9;,MASKED_NATIONAL_ID&#x9;COLLATE SQL_Latin1_General_CP1_CI_AS AS MASKED_NATIONAL_ID   &#xA;&#x9;&#x9;,AY_YEAR COLLATE SQL_Latin1_General_CP1_CI_AS&#x9;&#x9;AS  ACAD_YEAR             &#xA;&#x9;&#x9;,AY_SEM COLLATE SQL_Latin1_General_CP1_CI_AS&#x9;&#x9;AS SEMESTER &#xA;&#x9;&#x9;,'DPA' COLLATE SQL_Latin1_General_CP1_CI_AS&#x9;&#x9;&#x9;AS ADMISSION_EXERCISE       &#xA;&#x9;&#x9;,'' COLLATE SQL_Latin1_General_CP1_CI_AS&#x9;&#x9;&#x9;AS SEC_SCHOOL_CODE&#xA;&#x9;&#x9;,RAW_AGGREGATE COLLATE SQL_Latin1_General_CP1_CI_AS AS RAW_AGG&#xA;&#x9;&#x9;,NET_AGGREGATE COLLATE SQL_Latin1_General_CP1_CI_AS AS NET_AGG&#xA;&#x9;&#x9;,JAE_SUBJECT_CD_10  COLLATE SQL_Latin1_General_CP1_CI_AS AS SUBJECT_CODE_10&#xA;&#x9;&#x9;,JAE_SUBJECT_CD_11  COLLATE SQL_Latin1_General_CP1_CI_AS AS SUBJECT_CODE_11&#xA;&#x9;&#x9;,JAE_SUBJECT_CD_12  COLLATE SQL_Latin1_General_CP1_CI_AS AS SUBJECT_CODE_12&#xA;&#x9;&#x9;,JAE_SUBJECT_CD_1   COLLATE SQL_Latin1_General_CP1_CI_AS AS SUBJECT_CODE_1&#xA;&#x9;&#x9;,JAE_SUBJECT_CD_2   COLLATE SQL_Latin1_General_CP1_CI_AS AS SUBJECT_CODE_2&#xA;&#x9;&#x9;,JAE_SUBJECT_CD_3   COLLATE SQL_Latin1_General_CP1_CI_AS AS SUBJECT_CODE_3  &#xA;&#x9;&#x9;,JAE_SUBJECT_CD_4   COLLATE SQL_Latin1_General_CP1_CI_AS AS SUBJECT_CODE_4 &#xA;&#x9;&#x9;,JAE_SUBJECT_CD_5   COLLATE SQL_Latin1_General_CP1_CI_AS AS SUBJECT_CODE_5 &#xA;&#x9;&#x9;,JAE_SUBJECT_CD_6   COLLATE SQL_Latin1_General_CP1_CI_AS AS SUBJECT_CODE_6&#xA;&#x9;&#x9;,JAE_SUBJECT_CD_7   COLLATE SQL_Latin1_General_CP1_CI_AS AS SUBJECT_CODE_7&#xA;&#x9;&#x9;,JAE_SUBJECT_CD_8   COLLATE SQL_Latin1_General_CP1_CI_AS AS SUBJECT_CODE_8&#xA;&#x9;&#x9;,JAE_SUBJECT_CD_9   COLLATE SQL_Latin1_General_CP1_CI_AS AS SUBJECT_CODE_9&#xA;&#x9;&#x9;,JAE_GRADE_10  COLLATE SQL_Latin1_General_CP1_CI_AS AS GRADE_10 &#xA;&#x9;&#x9;,JAE_GRADE_11  COLLATE SQL_Latin1_General_CP1_CI_AS AS GRADE_11&#xA;&#x9;&#x9;,JAE_GRADE_12  COLLATE SQL_Latin1_General_CP1_CI_AS AS GRADE_12&#xA;&#x9;&#x9;,JAE_GRADE_1   COLLATE SQL_Latin1_General_CP1_CI_AS AS GRADE_1&#xA;&#x9;&#x9;,JAE_GRADE_2   COLLATE SQL_Latin1_General_CP1_CI_AS AS GRADE_2&#xA;&#x9;&#x9;,JAE_GRADE_3   COLLATE SQL_Latin1_General_CP1_CI_AS AS GRADE_3&#xA;&#x9;&#x9;,JAE_GRADE_4   COLLATE SQL_Latin1_General_CP1_CI_AS AS GRADE_4&#xA;&#x9;&#x9;,JAE_GRADE_5   COLLATE SQL_Latin1_General_CP1_CI_AS AS GRADE_5&#xA;&#x9;&#x9;,JAE_GRADE_6   COLLATE SQL_Latin1_General_CP1_CI_AS AS GRADE_6&#xA;&#x9;&#x9;,JAE_GRADE_7   COLLATE SQL_Latin1_General_CP1_CI_AS AS GRADE_7&#xA;&#x9;&#x9;,JAE_GRADE_8   COLLATE SQL_Latin1_General_CP1_CI_AS AS GRADE_8&#xA;&#x9;&#x9;,JAE_GRADE_9   COLLATE SQL_Latin1_General_CP1_CI_AS AS GRADE_9&#xA;&#x9;&#x9;,CONVERT (VARCHAR(4),(SELECT MAX(VALUE) FROM STRING_SPLIT(COMBINED_SITTING,',')) COLLATE SQL_Latin1_General_CP1_CI_AS) AS ADM_EXE_YEAR_EXAM &#xA;&#xA;&#x9;&#x9;FROM &quot;+ @[$Project::RPDW_Initial_Catalog] +&quot;.dbo.DW_EXT_DPAEAE_JAE WITH (NOLOCK)  -- SOURCE DB: RPDW_STG&#xA;&#xA;&#xA;)  SELECT * &#xA;   INTO ##TMP_DW_EXT_DPAEAE_JAE&#xA;   FROM TMP_DW_EXT_DPAEAE_JAE &#xA;   OPTION (MAXDOP 1)&#xA;;  &#xA;--&#xA;-- OTHER ADM EXE&#xA;-- &#xA;  &#xA;WITH TMP_OTHER_ADM_EXE AS (&#xA;&#x9;&#x9;-- EXT_JAE --Latin1&#xA;&#x9;&#x9;SELECT &#xA;&#x9;&#x9;UIN COLLATE SQL_Latin1_General_CP1_CI_AS&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;AS UIN&#xA;&#x9;&#x9;,MASKED_NATIONAL_ID COLLATE SQL_Latin1_General_CP1_CI_AS&#x9;&#x9;AS MASKED_NATIONAL_ID&#xA;&#x9;&#x9;&#xA;&#x9;&#x9;&#xA;&#x9;&#x9;,FILE_NAME_ACADEMIC_YEAR COLLATE SQL_Latin1_General_CP1_CI_AS&#x9;AS ACAD_YEAR -- COMMENTED IN STG/UAT ONLY&#xA;&#x9;&#x9;,FILE_NAME_SEMESTER COLLATE SQL_Latin1_General_CP1_CI_AS&#x9;&#x9;AS SEMESTER&#x9; -- COMMENTED IN STG/UAT ONLY&#xA;&#x9;&#x9;&#xA;&#x9;&#x9;--,' '  COLLATE SQL_Latin1_General_CP1_CI_AS&#x9;    AS ACAD_YEAR &#xA;&#x9;&#x9;--,' '  COLLATE SQL_Latin1_General_CP1_CI_AS&#x9;&#x9;AS SEMESTER&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#xA;&#x9;&#x9;,'JAE' COLLATE SQL_Latin1_General_CP1_CI_AS&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;AS ADMISSION_EXERCISE&#xA;&#x9;&#x9;,SEC_SCHOOL_CD COLLATE SQL_Latin1_General_CP1_CI_AS&#x9;&#x9;&#x9;&#x9;AS SEC_SCHOOL_CODE&#xA;&#x9;&#x9;,POSTED_POINT  COLLATE SQL_Latin1_General_CP1_CI_AS&#x9;&#x9;&#x9;&#x9;AS RAW_AGG&#xA;&#x9;&#x9;,AGG_POSTED    COLLATE SQL_Latin1_General_CP1_CI_AS&#x9;&#x9;&#x9;&#x9;AS NET_AGG&#xA;&#x9;&#x9;,JAE_SUBJECT_CD_10 COLLATE SQL_Latin1_General_CP1_CI_AS&#x9;&#x9;&#x9;AS SUBJECT_CODE_10&#xA;&#x9;&#x9;,JAE_SUBJECT_CD_11 COLLATE SQL_Latin1_General_CP1_CI_AS&#x9;&#x9;&#x9;AS SUBJECT_CODE_11&#xA;&#x9;&#x9;,JAE_SUBJECT_CD_12 COLLATE SQL_Latin1_General_CP1_CI_AS&#x9;&#x9;&#x9;AS SUBJECT_CODE_12&#xA;&#x9;&#x9;,JAE_SUBJECT_CD_1  COLLATE SQL_Latin1_General_CP1_CI_AS&#x9;&#x9;&#x9;AS SUBJECT_CODE_1&#xA;&#x9;&#x9;,JAE_SUBJECT_CD_2  COLLATE SQL_Latin1_General_CP1_CI_AS&#x9;&#x9;&#x9;AS SUBJECT_CODE_2&#xA;&#x9;&#x9;,JAE_SUBJECT_CD_3  COLLATE SQL_Latin1_General_CP1_CI_AS&#x9;&#x9;&#x9;AS SUBJECT_CODE_3&#xA;&#x9;&#x9;,JAE_SUBJECT_CD_4  COLLATE SQL_Latin1_General_CP1_CI_AS&#x9;&#x9;&#x9;AS SUBJECT_CODE_4&#xA;&#x9;&#x9;,JAE_SUBJECT_CD_5  COLLATE SQL_Latin1_General_CP1_CI_AS&#x9;&#x9;&#x9;AS SUBJECT_CODE_5&#xA;&#x9;&#x9;,JAE_SUBJECT_CD_6  COLLATE SQL_Latin1_General_CP1_CI_AS&#x9;&#x9;&#x9;AS SUBJECT_CODE_6&#xA;&#x9;&#x9;,JAE_SUBJECT_CD_7  COLLATE SQL_Latin1_General_CP1_CI_AS&#x9;&#x9;&#x9;AS SUBJECT_CODE_7&#xA;&#x9;&#x9;,JAE_SUBJECT_CD_8  COLLATE SQL_Latin1_General_CP1_CI_AS&#x9;&#x9;&#x9;AS SUBJECT_CODE_8&#xA;&#x9;&#x9;,JAE_SUBJECT_CD_9  COLLATE SQL_Latin1_General_CP1_CI_AS&#x9;&#x9;&#x9;AS SUBJECT_CODE_9&#xA;&#x9;&#x9;,JAE_GRADE_10 COLLATE SQL_Latin1_General_CP1_CI_AS&#x9;&#x9;&#x9;&#x9;AS GRADE_10&#xA;&#x9;&#x9;,JAE_GRADE_11 COLLATE SQL_Latin1_General_CP1_CI_AS&#x9;&#x9;&#x9;&#x9;AS GRADE_11&#xA;&#x9;&#x9;,JAE_GRADE_12 COLLATE SQL_Latin1_General_CP1_CI_AS&#x9;&#x9;&#x9;&#x9;AS GRADE_12&#xA;&#x9;&#x9;,JAE_GRADE_1  COLLATE SQL_Latin1_General_CP1_CI_AS&#x9;&#x9;&#x9;&#x9;AS GRADE_1&#xA;&#x9;&#x9;,JAE_GRADE_2  COLLATE SQL_Latin1_General_CP1_CI_AS&#x9;&#x9;&#x9;&#x9;AS GRADE_2&#xA;&#x9;&#x9;,JAE_GRADE_3  COLLATE SQL_Latin1_General_CP1_CI_AS&#x9;&#x9;&#x9;&#x9;AS GRADE_3&#xA;&#x9;&#x9;,JAE_GRADE_4  COLLATE SQL_Latin1_General_CP1_CI_AS&#x9;&#x9;&#x9;&#x9;AS GRADE_4&#xA;&#x9;&#x9;,JAE_GRADE_5  COLLATE SQL_Latin1_General_CP1_CI_AS&#x9;&#x9;&#x9;&#x9;AS GRADE_5&#xA;&#x9;&#x9;,JAE_GRADE_6  COLLATE SQL_Latin1_General_CP1_CI_AS&#x9;&#x9;&#x9;&#x9;AS GRADE_6&#xA;&#x9;&#x9;,JAE_GRADE_7  COLLATE SQL_Latin1_General_CP1_CI_AS&#x9;&#x9;&#x9;&#x9;AS GRADE_7&#xA;&#x9;&#x9;,JAE_GRADE_8  COLLATE SQL_Latin1_General_CP1_CI_AS&#x9;&#x9;&#x9;&#x9;AS GRADE_8&#xA;&#x9;&#x9;,JAE_GRADE_9  COLLATE SQL_Latin1_General_CP1_CI_AS&#x9;&#x9;&#x9;&#x9;AS GRADE_9&#xA;&#x9;&#x9;,CONVERT(VARCHAR(4),YEAR_EXAM COLLATE SQL_Latin1_General_CP1_CI_AS) AS ADM_EXE_YEAR_EXAM&#xA;&#xA;&#x9;&#x9;FROM &quot;+ @[$Project::RPDW_Initial_Catalog] +&quot;.[dbo].[DW_EXT_JAE]  WITH (NOLOCK)  -- SOURCE DB: RPDW_STG&#xA;&#x9;&#x9;&#xA;&#x9;&#x9;UNION ALL&#xA;&#xA;&#x9;&#x9;-- EXT_PFP --latin1&#xA;&#x9;&#x9;SELECT &#xA;&#x9;&#x9;UIN COLLATE SQL_Latin1_General_CP1_CI_AS&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;AS UIN&#xA;&#x9;&#x9;,MASKED_NATIONAL_ID&#x9;COLLATE SQL_Latin1_General_CP1_CI_AS&#x9;&#x9;AS MASKED_NATIONAL_ID&#x9;&#xA;&#x9;&#x9;,[AY_YEAR] COLLATE SQL_Latin1_General_CP1_CI_AS&#x9;&#x9;&#x9;&#x9;&#x9;AS ACAD_YEAR&#xA;&#x9;&#x9;,[AY_SEM]  COLLATE SQL_Latin1_General_CP1_CI_AS&#x9;&#x9;&#x9;&#x9;&#x9;AS SEMESTER&#xA;&#x9;&#x9;,'PFP'&#x9;   COLLATE SQL_Latin1_General_CP1_CI_AS&#x9;&#x9;&#x9;&#x9;&#x9;AS ADMISSION_EXERCISE&#xA;&#x9;&#x9;,[SECONDARY SCHOOL] COLLATE SQL_Latin1_General_CP1_CI_AS&#x9;&#x9;AS SEC_SCHOOL_CODE&#xA;&#x9;&#x9;,[FINAL RAW SCORE] COLLATE SQL_Latin1_General_CP1_CI_AS&#x9;&#x9;&#x9;AS RAW_AGG&#xA;&#x9;&#x9;,[FINAL NET SCORE] COLLATE SQL_Latin1_General_CP1_CI_AS&#x9;&#x9;&#x9;AS NET_AGG&#xA;&#x9;&#x9;,'' COLLATE SQL_Latin1_General_CP1_CI_AS AS SUBJECT_CODE_10&#xA;&#x9;&#x9;,'' COLLATE SQL_Latin1_General_CP1_CI_AS AS SUBJECT_CODE_11&#xA;&#x9;&#x9;,'' COLLATE SQL_Latin1_General_CP1_CI_AS AS SUBJECT_CODE_12&#xA;&#x9;&#x9;,'' COLLATE SQL_Latin1_General_CP1_CI_AS AS SUBJECT_CODE_1&#xA;&#x9;&#x9;,'' COLLATE SQL_Latin1_General_CP1_CI_AS AS SUBJECT_CODE_2&#xA;&#x9;&#x9;,'' COLLATE SQL_Latin1_General_CP1_CI_AS AS SUBJECT_CODE_3&#xA;&#x9;&#x9;,'' COLLATE SQL_Latin1_General_CP1_CI_AS AS SUBJECT_CODE_4&#xA;&#x9;&#x9;,'' COLLATE SQL_Latin1_General_CP1_CI_AS AS SUBJECT_CODE_5&#xA;&#x9;&#x9;,'' COLLATE SQL_Latin1_General_CP1_CI_AS AS SUBJECT_CODE_6&#xA;&#x9;&#x9;,'' COLLATE SQL_Latin1_General_CP1_CI_AS AS SUBJECT_CODE_7&#xA;&#x9;&#x9;,'' COLLATE SQL_Latin1_General_CP1_CI_AS AS SUBJECT_CODE_8&#xA;&#x9;&#x9;,'' COLLATE SQL_Latin1_General_CP1_CI_AS AS SUBJECT_CODE_9&#xA;&#x9;&#x9;,'' COLLATE SQL_Latin1_General_CP1_CI_AS AS GRADE_10&#xA;&#x9;&#x9;,'' COLLATE SQL_Latin1_General_CP1_CI_AS AS GRADE_11&#xA;&#x9;&#x9;,'' COLLATE SQL_Latin1_General_CP1_CI_AS AS GRADE_12&#xA;&#x9;&#x9;,'' COLLATE SQL_Latin1_General_CP1_CI_AS AS GRADE_1&#xA;&#x9;&#x9;,'' COLLATE SQL_Latin1_General_CP1_CI_AS AS GRADE_2&#xA;&#x9;&#x9;,'' COLLATE SQL_Latin1_General_CP1_CI_AS AS GRADE_3&#xA;&#x9;&#x9;,'' COLLATE SQL_Latin1_General_CP1_CI_AS AS GRADE_4&#xA;&#x9;&#x9;,'' COLLATE SQL_Latin1_General_CP1_CI_AS AS GRADE_5&#xA;&#x9;&#x9;,'' COLLATE SQL_Latin1_General_CP1_CI_AS AS GRADE_6&#xA;&#x9;&#x9;,'' COLLATE SQL_Latin1_General_CP1_CI_AS AS GRADE_7&#xA;&#x9;&#x9;,'' COLLATE SQL_Latin1_General_CP1_CI_AS AS GRADE_8&#xA;&#x9;&#x9;,'' COLLATE SQL_Latin1_General_CP1_CI_AS AS GRADE_9&#xA;&#x9;&#x9;,CONVERT(VARCHAR(4),[EXAM YEAR] COLLATE SQL_Latin1_General_CP1_CI_AS) AS ADM_EXE_YEAR_EXAM&#x9;&#x9;&#xA;&#xA;&#x9;&#x9;FROM &quot;+ @[$Project::RPDW_Initial_Catalog] +&quot;.dbo.[DW_EXT_PFP]  WITH (NOLOCK)  -- SOURCE DB: RPDW_STG&#xA;&#xA;&#x9;&#x9;UNION ALL&#xA;&#xA;&#x9;&#x9;-- EXT_JPSAE --latin1&#xA;&#x9;&#x9;SELECT &#xA;&#x9;&#x9;[NRIC FIN] COLLATE SQL_Latin1_General_CP1_CI_AS&#x9;&#x9;&#x9;&#x9;&#x9;AS UIN&#xA;&#x9;&#x9;,MASKED_NATIONAL_ID COLLATE SQL_Latin1_General_CP1_CI_AS&#x9;&#x9;AS MASKED_NATIONAL_ID&#xA;&#xA;&#x9;&#x9;,FILE_NAME_ACADEMIC_YEAR COLLATE SQL_Latin1_General_CP1_CI_AS   AS ACAD_YEAR   -- COMMENTED IN STG/UAT ONLY&#xA;&#x9;&#x9;,FILE_NAME_SEMESTER COLLATE SQL_Latin1_General_CP1_CI_AS&#x9;&#x9;AS SEMESTER    -- COMMENTED IN STG/UAT ONLY&#xA;&#x9;&#x9;&#xA;&#x9;    --,''  COLLATE SQL_Latin1_General_CP1_CI_AS       AS ACAD_YEAR    &#xA;&#x9;&#x9;--,''  COLLATE SQL_Latin1_General_CP1_CI_AS&#x9;&#x9;AS SEMESTER  &#xA;&#x9;&#x9;&#xA;&#x9;&#x9;,'JSE' COLLATE SQL_Latin1_General_CP1_CI_AS&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;AS ADMISSION_EXERCISE&#xA;&#x9;&#x9;,[Sec School] COLLATE SQL_Latin1_General_CP1_CI_AS&#x9;&#x9;&#x9;&#x9;AS SEC_SCHOOL_CODE&#xA;&#x9;&#x9;,[POSTED AGGREGATE] COLLATE SQL_Latin1_General_CP1_CI_AS&#x9;&#x9;AS RAW_AGG&#xA;&#x9;&#x9;,[NET POSTED AGGREGATE] COLLATE SQL_Latin1_General_CP1_CI_AS&#x9;AS NET_AGG&#xA;&#x9;&#x9;,[SUBJECT CODE_10] COLLATE SQL_Latin1_General_CP1_CI_AS AS SUBJECT_CODE_10&#xA;&#x9;&#x9;,[SUBJECT CODE_11] COLLATE SQL_Latin1_General_CP1_CI_AS AS SUBJECT_CODE_11&#xA;&#x9;&#x9;,[SUBJECT CODE_12] COLLATE SQL_Latin1_General_CP1_CI_AS AS SUBJECT_CODE_12&#xA;&#x9;&#x9;,[SUBJECT CODE_1]  COLLATE SQL_Latin1_General_CP1_CI_AS AS SUBJECT_CODE_1&#xA;&#x9;&#x9;,[SUBJECT CODE_2]  COLLATE SQL_Latin1_General_CP1_CI_AS AS SUBJECT_CODE_2&#xA;&#x9;&#x9;,[SUBJECT CODE_3]  COLLATE SQL_Latin1_General_CP1_CI_AS AS SUBJECT_CODE_3&#xA;&#x9;&#x9;,[SUBJECT CODE_4]  COLLATE SQL_Latin1_General_CP1_CI_AS AS SUBJECT_CODE_4&#xA;&#x9;&#x9;,[SUBJECT CODE_5]  COLLATE SQL_Latin1_General_CP1_CI_AS AS SUBJECT_CODE_5&#xA;&#x9;&#x9;,[SUBJECT CODE_6]  COLLATE SQL_Latin1_General_CP1_CI_AS AS SUBJECT_CODE_6&#xA;&#x9;&#x9;,[SUBJECT CODE_7]  COLLATE SQL_Latin1_General_CP1_CI_AS AS SUBJECT_CODE_7&#xA;&#x9;&#x9;,[SUBJECT CODE_8]  COLLATE SQL_Latin1_General_CP1_CI_AS AS SUBJECT_CODE_8&#xA;&#x9;&#x9;,[SUBJECT CODE_9]  COLLATE SQL_Latin1_General_CP1_CI_AS AS SUBJECT_CODE_9&#xA;&#x9;&#x9;,[ SUBJECT GRADE_10] COLLATE SQL_Latin1_General_CP1_CI_AS AS GRADE_10&#xA;&#x9;&#x9;,[ SUBJECT GRADE_11] COLLATE SQL_Latin1_General_CP1_CI_AS AS GRADE_11&#xA;&#x9;&#x9;,[ SUBJECT GRADE_12] COLLATE SQL_Latin1_General_CP1_CI_AS AS GRADE_12&#xA;&#x9;&#x9;,[ SUBJECT GRADE_1]  COLLATE SQL_Latin1_General_CP1_CI_AS AS GRADE_1&#xA;&#x9;&#x9;,[ SUBJECT GRADE_2]  COLLATE SQL_Latin1_General_CP1_CI_AS AS GRADE_2&#xA;&#x9;&#x9;,[ SUBJECT GRADE_3]  COLLATE SQL_Latin1_General_CP1_CI_AS AS GRADE_3&#xA;&#x9;&#x9;,[ SUBJECT GRADE_4]  COLLATE SQL_Latin1_General_CP1_CI_AS AS GRADE_4&#xA;&#x9;&#x9;,[ SUBJECT GRADE_5]  COLLATE SQL_Latin1_General_CP1_CI_AS AS GRADE_5&#xA;&#x9;&#x9;,[ SUBJECT GRADE_6]  COLLATE SQL_Latin1_General_CP1_CI_AS AS GRADE_6&#xA;&#x9;&#x9;,[ SUBJECT GRADE_7]  COLLATE SQL_Latin1_General_CP1_CI_AS AS GRADE_7&#xA;&#x9;&#x9;,[ SUBJECT GRADE_8]  COLLATE SQL_Latin1_General_CP1_CI_AS AS GRADE_8&#xA;&#x9;&#x9;,[ SUBJECT GRADE_9]  COLLATE SQL_Latin1_General_CP1_CI_AS AS GRADE_9&#xA;&#x9;&#x9;,CONVERT(VARCHAR(4),CASE WHEN [Year Taken 1] &gt; [Year Taken 2] THEN [Year Taken 1] &#xA;&#x9;&#x9;&#x9;                      WHEN [Year Taken 2] &gt; [Year Taken 1] THEN [Year Taken 2]&#xA;&#x9;&#x9;&#x9;                      WHEN [Year Taken 1] = [Year Taken 2] THEN [Year Taken 1]&#xA;&#x9;&#x9;                     END COLLATE SQL_Latin1_General_CP1_CI_AS)&#xA;        AS ADM_EXE_YEAR_EXAM&#xA;&#xA;&#x9;&#x9;FROM &quot;+ @[$Project::RPDW_Initial_Catalog] +&quot;.dbo.[DW_EXT_JPSAE] WITH (NOLOCK)   -- SOURCE DB: RPDW_STG&#xA;&#x9;&#x9;&#xA;)  SELECT * &#xA;   INTO ##TMP_OTHER_ADM_EXE&#xA;   FROM TMP_OTHER_ADM_EXE&#xA;   OPTION (MAXDOP 1)&#xA;;&#xA;&#xA;  &#xA;--&#xA;-- 2) EXT ADMISSION EXERCISE &#xA;-- &#xA;WITH TMP_EXT_ADM_EXE AS (&#xA;  SELECT * FROM ##TMP_DW_EXT_DPAEAE_JAE WITH (NOLOCK)&#xA;  UNION ALL&#xA;  SELECT * FROM ##TMP_OTHER_ADM_EXE WITH (NOLOCK)&#xA;) SELECT * &#xA;  INTO ##TMP_TBL2&#xA;  FROM TMP_EXT_ADM_EXE&#xA;  OPTION (MAXDOP 1)&#xA;;&#xA;  &#xA;--&#xA;-- 3) TEST YEAR DATE&#xA;-- &#xA;;WITH TMP_WRK_POLY_YEAR_TEST_DATE AS(&#xA; SELECT &#xA;  a.Applicant_ID  &#xA; ,a.Test_ID&#xA; ,a.Test_Date&#xA; ,a.Year_Taken_ITE&#xA; ,b.Entry_Qual_Type&#xA;&#x9;,a.Acad_Gpa   &#xA;&#x9;,a.Adjust_Gpa &#xA;&#x9;,CASE WHEN a.Test_ID IN ('MY SPM V','MY UECV','OTH INT QLF','OTHERS IB','OTHR INTL','SG IB','SG IP') THEN '' ELSE a.SUBJECT_10 END AS SUBJECT_10&#xA;&#x9;,CASE WHEN a.Test_ID IN ('MY SPM V','MY UECV','OTH INT QLF','OTHERS IB','OTHR INTL','SG IB','SG IP') THEN '' ELSE a.SUBJECT_1 END AS SUBJECT_1&#xA;&#x9;,CASE WHEN a.Test_ID IN ('MY SPM V','MY UECV','OTH INT QLF','OTHERS IB','OTHR INTL','SG IB','SG IP') THEN '' ELSE a.SUBJECT_2 END AS SUBJECT_2&#xA;&#x9;,CASE WHEN a.Test_ID IN ('MY SPM V','MY UECV','OTH INT QLF','OTHERS IB','OTHR INTL','SG IB','SG IP') THEN '' ELSE a.SUBJECT_3 END AS SUBJECT_3&#xA;&#x9;,CASE WHEN a.Test_ID IN ('MY SPM V','MY UECV','OTH INT QLF','OTHERS IB','OTHR INTL','SG IB','SG IP') THEN '' ELSE a.SUBJECT_4 END AS SUBJECT_4&#xA;&#x9;,CASE WHEN a.Test_ID IN ('MY SPM V','MY UECV','OTH INT QLF','OTHERS IB','OTHR INTL','SG IB','SG IP') THEN '' ELSE a.SUBJECT_5 END AS SUBJECT_5&#xA;&#x9;,CASE WHEN a.Test_ID IN ('MY SPM V','MY UECV','OTH INT QLF','OTHERS IB','OTHR INTL','SG IB','SG IP') THEN '' ELSE a.SUBJECT_6 END AS SUBJECT_6&#xA;&#x9;,CASE WHEN a.Test_ID IN ('MY SPM V','MY UECV','OTH INT QLF','OTHERS IB','OTHR INTL','SG IB','SG IP') THEN '' ELSE a.SUBJECT_7 END AS SUBJECT_7&#xA;&#x9;,CASE WHEN a.Test_ID IN ('MY SPM V','MY UECV','OTH INT QLF','OTHERS IB','OTHR INTL','SG IB','SG IP') THEN '' ELSE a.SUBJECT_8 END AS SUBJECT_8&#xA;&#x9;,CASE WHEN a.Test_ID IN ('MY SPM V','MY UECV','OTH INT QLF','OTHERS IB','OTHR INTL','SG IB','SG IP') THEN '' ELSE a.SUBJECT_9 END AS SUBJECT_9&#xA;&#x9;,a.GRADE_10    &#xA;&#x9;,a.GRADE_1&#xA;&#x9;,a.GRADE_2&#xA;&#x9;,a.GRADE_3&#xA;&#x9;,a.GRADE_4&#xA;&#x9;,a.GRADE_5&#xA;&#x9;,a.GRADE_6&#xA;&#x9;,a.GRADE_7&#xA;&#x9;,a.GRADE_8&#xA;&#x9;,a.GRADE_9&#xA;&#xA; ,CASE WHEN b.Entry_Qual_Type IN ('HINITEC','NITEC') THEN CONVERT(VARCHAR(4),a.Year_Taken_ITE) &#xA;       ELSE CONVERT(VARCHAR(4),YEAR(a.Test_Date))&#xA;&#x9;   END AS TEST_RESULTS_YEAR_EXAM&#xA; ,ROW_NUMBER() OVER (PARTITION BY  Applicant_ID ORDER BY Test_Date DESC) as rec_cnt_by_pk&#xA;&#xA; FROM &quot;+ @[$Project::RPDW_Initial_Catalog] +&quot;.[dbo].[DW_APPLICANT_TEST_RESULTS] a  WITH (NOLOCK) &#xA; LEFT JOIN &quot;+ @[$Project::RPDW_Initial_Catalog] +&quot;.[dbo].[DW_EXT_ENTRY_QUAL_TYPE] b  WITH (NOLOCK) &#xA; ON a.Test_ID = b.Entry_Qual&#xA; &#xA;) SELECT * &#xA;  INTO ##TMP_TBL3&#xA;  FROM TMP_WRK_POLY_YEAR_TEST_DATE where rec_cnt_by_pk = 1&#xA;  OPTION (MAXDOP 1)&#xA;;&#xA;  &#xA;------------------------&#xA;-- CREATE Poly_Applicant&#xA;------------------------&#xA; &#xA;;WITH WRK_POLY_EXT_ADM_WITH_STUDENT_DTL_MATCH AS (&#xA;SELECT&#xA;&#x9; a.Academic_Year&#xA;&#x9;,a.Admit_Term&#xA;&#x9;,a.App_Number&#xA;&#x9;,a.Semester&#xA;&#x9;,a.Admit_Type&#xA;&#x9;,a.Applicant_Id&#xA;&#x9;,a.Primary_National_ID&#xA;&#x9;,a.Entry_Qual&#xA;&#x9;,b.ADMISSION_EXERCISE&#xA;&#x9;,b.SEC_SCHOOL_CODE&#xA;&#x9;,b.RAW_AGG&#xA;&#x9;,b.NET_AGG&#xA;    ,b.MASKED_NATIONAL_ID&#xA;&#x9;,b.UIN &#xA;&#x9;,b.ACAD_YEAR&#xA;&#x9;,b.SUBJECT_CODE_10&#xA;&#x9;,b.SUBJECT_CODE_11&#xA;&#x9;,b.SUBJECT_CODE_12&#xA;&#x9;,b.SUBJECT_CODE_1&#xA;&#x9;,b.SUBJECT_CODE_2&#xA;&#x9;,b.SUBJECT_CODE_3&#xA;&#x9;,b.SUBJECT_CODE_4&#xA;&#x9;,b.SUBJECT_CODE_5&#xA;&#x9;,b.SUBJECT_CODE_6&#xA;&#x9;,b.SUBJECT_CODE_7&#xA;&#x9;,b.SUBJECT_CODE_8&#xA;&#x9;,b.SUBJECT_CODE_9&#xA;&#x9;,b.GRADE_10&#xA;&#x9;,b.GRADE_11&#xA;&#x9;,b.GRADE_12&#xA;&#x9;,b.GRADE_1&#xA;&#x9;,b.GRADE_2&#xA;&#x9;,b.GRADE_3&#xA;&#x9;,b.GRADE_4&#xA;&#x9;,b.GRADE_5&#xA;&#x9;,b.GRADE_6&#xA;&#x9;,b.GRADE_7&#xA;&#x9;,b.GRADE_8&#xA;&#x9;,b.GRADE_9&#xA;&#x9;,b.ADM_EXE_YEAR_EXAM&#xA;&#x9;,CASE WHEN (ISNULL(b.ACAD_YEAR,N'')='' AND ISNULL(b.SEMESTER,N'')='' AND ISNULL(b.ADMISSION_EXERCISE,N'')='' ) THEN 'N' ELSE 'Y' END AS TAG_ADMISSION_EXE_MATCH&#xA;&#x9;,c.Acad_Gpa&#xA;&#x9;,c.Adjust_Gpa&#xA;&#x9;,c.SUBJECT_10&#xA;&#x9;,c.SUBJECT_1&#xA;&#x9;,c.SUBJECT_2&#xA;&#x9;,c.SUBJECT_3&#xA;&#x9;,c.SUBJECT_4&#xA;&#x9;,c.SUBJECT_5&#xA;&#x9;,c.SUBJECT_6&#xA;&#x9;,c.SUBJECT_7&#xA;&#x9;,c.SUBJECT_8&#xA;&#x9;,c.SUBJECT_9&#xA;&#x9;,c.GRADE_10 AS [c.grade_10]&#xA;&#x9;,c.GRADE_1  AS [c.grade_1]&#xA;&#x9;,c.GRADE_2  AS [c.grade_2]&#xA;&#x9;,c.GRADE_3  AS [c.grade_3]&#xA;&#x9;,c.GRADE_4  AS [c.grade_4]&#xA;&#x9;,c.GRADE_5  AS [c.grade_5]&#xA;&#x9;,c.GRADE_6  AS [c.grade_6]&#xA;&#x9;,c.GRADE_7  AS [c.grade_7]&#xA;&#x9;,c.GRADE_8  AS [c.grade_8]&#xA;&#x9;,c.GRADE_9  AS [c.grade_9]&#xA;&#x9;,c.TEST_RESULTS_YEAR_EXAM&#xA;&#x9;,CASE WHEN ISNULL(c.Applicant_Id,N'')='' AND ISNULL(c.Test_ID,N'')='' THEN 'N' ELSE 'Y' END AS TAG_APPLNT_TEST_RESULT_MATCH &#xA;&#xA;FROM ##TMP_TBL1 a WITH (NOLOCK)&#xA;&#xA;  -- JOIN1: DW_APPLICANT_DETAILS AS BASE,&#xA;  -- LEFT JOIN WITH DW_APPLICANT_TEST_RESULTS TO GET THE YEAR_TEST_DATE&#xA;  &#xA;LEFT JOIN ##TMP_TBL2 b WITH (NOLOCK)&#xA;ON  a.Masked_Primary_National_ID = b.MASKED_NATIONAL_ID &#xA;and a.Action_Year COLLATE SQL_Latin1_General_CP1_CI_AS = b.ACAD_YEAR COLLATE SQL_Latin1_General_CP1_CI_AS &#xA;and a.Admit_Type COLLATE SQL_Latin1_General_CP1_CI_AS = LEFT(b.ADMISSION_EXERCISE,3) COLLATE SQL_Latin1_General_CP1_CI_AS&#xA;&#xA;  -- JOIN2: UNMATCH FROM JOIN1 &#xA;  -- LEFT JOIN WRK_POLY_EXT_ADMISSION_EXE and DW_APPLICANT_TEST_RESULTS TO EXTRACT THE SUBJECT1-10, GRADE1-10 and YEAREXAM FOR THOSE&#xA;  -- UNNMATCHED FROM DW_EXT_ADMISSION_EXE&#xA;&#xA;LEFT JOIN ##TMP_TBL3 c WITH (NOLOCK)&#xA;ON  a.Applicant_Id = c.Applicant_Id&#xA;AND a.Entry_Qual = c.Test_ID &#xA;AND (ISNULL(b.ACAD_YEAR,N'')='' AND ISNULL(b.SEMESTER,N'')='' AND ISNULL(b.ADMISSION_EXERCISE,N'')='' )&#xA;&#xA;) SELECT * &#xA;  INTO ##TMP_TBL4&#xA;  FROM WRK_POLY_EXT_ADM_WITH_STUDENT_DTL_MATCH&#xA;  OPTION (MAXDOP 1)&#xA;;&#xA; &#xA;-- Begin SET&#xA;SET @query=CONCAT(&#xA;    N'SELECT &#xA;&#x9; Applicant_Id         as [EMPLID]       &#xA;    ,Academic_Year        as [Acad_Year]&#xA;&#x9;,Admit_Type           as [Admission_Exercise]&#xA;&#x9;,Admit_Term&#xA;&#x9;,App_Number           as [Application_Number]&#xA;&#x9;,SEC_SCHOOL_CODE      as [Sec_School_Code]&#xA;&#x9;,CASE WHEN TAG_ADMISSION_EXE_MATCH = ''Y'' THEN RAW_AGG ELSE CAST (Acad_Gpa AS VARCHAR(6)) END as [Raw_Agg] &#xA;&#x9;,CASE WHEN TAG_ADMISSION_EXE_MATCH = ''Y'' THEN NET_AGG ELSE CAST (Adjust_Gpa AS VARCHAR(6)) END as [Net_Agg] &#xA;&#x9;,CASE WHEN TAG_ADMISSION_EXE_MATCH = ''Y'' THEN SUBJECT_CODE_10 ELSE SUBJECT_10 END as [Subject_Code_10]&#xA;&#x9;,SUBJECT_CODE_11 as [Subject_Code_11]&#xA;&#x9;,SUBJECT_CODE_12 as [Subject_Code_12]&#xA;&#x9;,CASE WHEN TAG_ADMISSION_EXE_MATCH = ''Y'' THEN SUBJECT_CODE_1 ELSE SUBJECT_1 END as [Subject_Code_1]&#xA;&#x9;,CASE WHEN TAG_ADMISSION_EXE_MATCH = ''Y'' THEN SUBJECT_CODE_2 ELSE SUBJECT_2 END as [Subject_Code_2]&#xA;&#x9;,CASE WHEN TAG_ADMISSION_EXE_MATCH = ''Y'' THEN SUBJECT_CODE_3 ELSE SUBJECT_3 END as [Subject_Code_3]&#xA;&#x9;,CASE WHEN TAG_ADMISSION_EXE_MATCH = ''Y'' THEN SUBJECT_CODE_4 ELSE SUBJECT_4 END as [Subject_Code_4]&#xA;&#x9;,CASE WHEN TAG_ADMISSION_EXE_MATCH = ''Y'' THEN SUBJECT_CODE_5 ELSE SUBJECT_5 END as [Subject_Code_5]&#xA;&#x9;,CASE WHEN TAG_ADMISSION_EXE_MATCH = ''Y'' THEN SUBJECT_CODE_6 ELSE SUBJECT_6 END as [Subject_Code_6]&#xA;&#x9;,CASE WHEN TAG_ADMISSION_EXE_MATCH = ''Y'' THEN SUBJECT_CODE_7 ELSE SUBJECT_7 END as [Subject_Code_7]&#x9;&#xA;&#x9;,CASE WHEN TAG_ADMISSION_EXE_MATCH = ''Y'' THEN SUBJECT_CODE_8 ELSE SUBJECT_8 END as [Subject_Code_8]&#xA;&#x9;,CASE WHEN TAG_ADMISSION_EXE_MATCH = ''Y'' THEN SUBJECT_CODE_9 ELSE SUBJECT_9 END as [Subject_Code_9]&#xA;&#x9;,CASE WHEN TAG_ADMISSION_EXE_MATCH = ''Y'' THEN GRADE_10 ELSE [c.grade_10] END as [Grade_10]&#xA;&#x9;,GRADE_11 as [Grade_11]&#xA;&#x9;,GRADE_12 as [Grade_12]&#xA;&#x9;,CASE WHEN TAG_ADMISSION_EXE_MATCH = ''Y'' THEN GRADE_1 ELSE [c.grade_1] END as [Grade_1]&#xA;&#x9;,CASE WHEN TAG_ADMISSION_EXE_MATCH = ''Y'' THEN GRADE_2 ELSE [c.grade_2] END as [Grade_2]&#xA;&#x9;,CASE WHEN TAG_ADMISSION_EXE_MATCH = ''Y'' THEN GRADE_3 ELSE [c.grade_3] END as [Grade_3]&#xA;&#x9;,CASE WHEN TAG_ADMISSION_EXE_MATCH = ''Y'' THEN GRADE_4 ELSE [c.grade_4] END as [Grade_4]&#xA;&#x9;,CASE WHEN TAG_ADMISSION_EXE_MATCH = ''Y'' THEN GRADE_5 ELSE [c.grade_5] END as [Grade_5]&#xA;&#x9;,CASE WHEN TAG_ADMISSION_EXE_MATCH = ''Y'' THEN GRADE_6 ELSE [c.grade_6] END as [Grade_6]&#xA;&#x9;,CASE WHEN TAG_ADMISSION_EXE_MATCH = ''Y'' THEN GRADE_7 ELSE [c.grade_7] END as [Grade_7]&#xA;&#x9;,CASE WHEN TAG_ADMISSION_EXE_MATCH = ''Y'' THEN GRADE_8 ELSE [c.grade_8] END as [Grade_8]&#xA;&#x9;,CASE WHEN TAG_ADMISSION_EXE_MATCH = ''Y'' THEN GRADE_9 ELSE [c.grade_9] END as [Grade_9]&#xA;&#x9;,CASE WHEN TAG_ADMISSION_EXE_MATCH = ''Y'' THEN ADM_EXE_YEAR_EXAM ELSE TEST_RESULTS_YEAR_EXAM END as [yearexam]&#xA;&#x9;,ROW_NUMBER() OVER &#xA;&#x9;(PARTITION BY Applicant_Id, Academic_Year, Admit_Type &#xA;&#x9; ORDER BY Applicant_Id, Academic_Year, Admit_Type) as rec_cnt_by_pk -- ADDED DURING TESTING AS THERE ARE DUP BY KEY&#xA; INTO ##TMP_Poly_Applicant &#xA; FROM ##TMP_TBL4 WITH (NOLOCK)&#xA; WHERE 1=1&#xA; ',@condition&#x9; &#xA;&#x9; &#xA;); -- End Set&#x9; &#xA; &#xA;  PRINT (@query);&#xA;  SET @all_queries=CONCAT(N'',@all_queries,@query);  &#xA;  EXEC (@query);&#x9; &#xA;&#xA;&#xA;&#xA; &#xA;  INSERT INTO &quot;+ @[$Project::RPDW_USR_Initial_Catalog] +&quot;.[dbo].&quot;+ @[User::TgtTableName]+&quot;               &#xA;      (  &#xA;&#x9;   [EMPLID]&#xA;      ,[Acad_Year]&#xA;      ,[Admission_Exercise]&#xA;      ,[Admit_Term]&#xA;      ,[Application_Number]&#xA;      ,[Sec_School_Code]&#xA;      ,[Raw_Agg]&#xA;      ,[Net_Agg]&#xA;      ,[Subject_Code_10]&#xA;      ,[Subject_Code_11]&#xA;      ,[Subject_Code_12]&#xA;      ,[Subject_Code_1]&#xA;      ,[Subject_Code_2]&#xA;      ,[Subject_Code_3]&#xA;      ,[Subject_Code_4]&#xA;      ,[Subject_Code_5]&#xA;      ,[Subject_Code_6]&#xA;      ,[Subject_Code_7]&#xA;      ,[Subject_Code_8]&#xA;      ,[Subject_Code_9]&#xA;      ,[Grade_10]&#xA;      ,[Grade_11]&#xA;      ,[Grade_12]&#xA;      ,[Grade_1]&#xA;      ,[Grade_2]&#xA;      ,[Grade_3]&#xA;      ,[Grade_4]&#xA;      ,[Grade_5]&#xA;      ,[Grade_6]&#xA;      ,[Grade_7]&#xA;      ,[Grade_8]&#xA;      ,[Grade_9]&#xA;      ,[yearexam]&#xA;      ,[CREATED_ON]&#xA;      ,[MODIFIED_ON]&#xA;&#x9;   ) &#xA;&#x9;SELECT &#xA;&#x9;   [EMPLID]&#xA;      ,[Acad_Year]&#xA;      ,[Admission_Exercise]&#xA;      ,[Admit_Term]&#xA;      ,[Application_Number]&#xA;      ,[Sec_School_Code]&#xA;      ,[Raw_Agg]&#xA;      ,[Net_Agg]&#xA;      ,[Subject_Code_10]&#xA;      ,[Subject_Code_11]&#xA;      ,[Subject_Code_12]&#xA;      ,[Subject_Code_1]&#xA;      ,[Subject_Code_2]&#xA;      ,[Subject_Code_3]&#xA;      ,[Subject_Code_4]&#xA;      ,[Subject_Code_5]&#xA;      ,[Subject_Code_6]&#xA;      ,[Subject_Code_7]&#xA;      ,[Subject_Code_8]&#xA;      ,[Subject_Code_9]&#xA;      ,[Grade_10]&#xA;      ,[Grade_11]&#xA;      ,[Grade_12]&#xA;      ,[Grade_1]&#xA;      ,[Grade_2]&#xA;      ,[Grade_3]&#xA;      ,[Grade_4]&#xA;      ,[Grade_5]&#xA;      ,[Grade_6]&#xA;      ,[Grade_7]&#xA;      ,[Grade_8]&#xA;      ,[Grade_9]&#xA;      ,[yearexam]&#xA;&#x9;  ,getdate()&#xA;&#x9;  ,getdate()&#xA;&#x9;FROM ##TMP_Poly_Applicant WITH (NOLOCK)&#xA;&#x9;WHERE rec_cnt_by_pk = 1&#xA;&#x9;OPTION (MAXDOP 1)&#xA;;&#xA;&#xA;&#xA;-- Check Source Table Count&#xA;SELECT @source_cnt=COUNT(*) FROM ##TMP_Poly_Applicant WITH (NOLOCK) WHERE rec_cnt_by_pk = 1;&#xA;&#x9;&#xA;-- Check Tgt Table Count&#xA;SELECT @target_cnt=COUNT(*) FROM &quot;+ @[$Project::RPDW_USR_Initial_Catalog] +&quot;.[dbo].&quot;+ @[User::TgtTableName]+&quot;;&#xA;    &#xA;-- Update Counts&#xA;UPDATE &quot;+ @[$Project::RPDW_USR_Initial_Catalog] +&quot;.[dbo].[ETL_JOB_STATUS] &#xA;   SET [SRC_CNT]=@source_cnt,&#xA;       [TGT_CNT]=@target_cnt,&#xA;&#x9;   [REMARKS]=@all_queries,&#xA;&#x9;   [FILENAME]=@outputfilename&#xA;   WHERE [JOB_STATUS_ID]=@jobstatusid;&#x9;&#xA;    &#xA;    &#xA;&#xA;--------------------------------------&#xA;COMMIT TRANSACTION&#xA;END TRY&#xA;&#xA;BEGIN CATCH&#xA;  ROLLBACK TRANSACTION&#xA;&#xA;  INSERT INTO &quot;+ @[$Project::RPDW_USR_Initial_Catalog] + &quot;.[dbo].[ETL_ERROR_LOG](JOB_STATUS_ID,ERROR_RECORD,created_on)&#xA;  SELECT   &#xA;         CAST(@jobstatusid as int) as JOB_STATUS_ID&#xA;        ,ERROR_MESSAGE() AS ErrorMessage&#xA;&#x9;&#x9;,getdate()  as created_on&#xA;&#xA;-- Update SQL QUERIES EXECUTED&#xA;UPDATE &quot;+ @[$Project::RPDW_USR_Initial_Catalog] +&quot;.[dbo].[ETL_JOB_STATUS] &#xA;   SET [REMARKS]=@all_queries&#xA;   WHERE [JOB_STATUS_ID]=@jobstatusid;&#x9;&#xA;   &#xA;END CATCH &#xA;GO&#xA;&quot;"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="SQL_DM_Load">
      <DTS:VariableValue
        DTS:DataType="8">
BEGIN TRANSACTION 
BEGIN TRY

------------
IF OBJECT_ID(N'tempdb..##TMP_Poly_Applicant') IS NOT NULL
BEGIN
  DROP TABLE ##TMP_Poly_Applicant
END

IF OBJECT_ID(N'tempdb..##TMP_TBL1') IS NOT NULL
BEGIN
  DROP TABLE ##TMP_TBL1
END

IF OBJECT_ID(N'tempdb..##TMP_TBL2') IS NOT NULL
BEGIN
  DROP TABLE ##TMP_TBL2
END

IF OBJECT_ID(N'tempdb..##TMP_OTHER_ADM_EXE') IS NOT NULL
BEGIN
  DROP TABLE ##TMP_OTHER_ADM_EXE
END

IF OBJECT_ID(N'tempdb..##TMP_DW_EXT_DPAEAE_JAE') IS NOT NULL
BEGIN
  DROP TABLE ##TMP_DW_EXT_DPAEAE_JAE
END

IF OBJECT_ID(N'tempdb..##TMP_TBL3') IS NOT NULL
BEGIN
  DROP TABLE ##TMP_TBL3
END

IF OBJECT_ID(N'tempdb..##TMP_TBL4') IS NOT NULL
BEGIN
  DROP TABLE ##TMP_TBL4
END



DECLARE @jobstatusid varchar(5)
,@condition varchar(100)
,@filter_criteria varchar(100)
,@QUAL_TYPE varchar(100)
,@query nvarchar(max)
,@job_name varchar(100)
,@source_cnt INT
,@target_cnt INT
,@all_queries varchar(4000)
,@outputfilename varchar(200)
,@date1 varchar(10)
;

SET @source_cnt=0;
SET @target_cnt=0;


select @jobstatusid=0;
select @date1=convert(varchar(10),GETDATE(),112);
select @outputfilename=CONCAT('DW_polyapplicant_',@date1,'.txt');


SELECT @filter_criteria=FILTER_CRITERIA, @QUAL_TYPE=QUAL_TYPE_CRITERIA FROM RPDW_USR_PRD.[dbo].[ETL_JOB_PARAMS]  
WHERE JOB_NAME='DW_ENT_POLY_APPLICANT';

IF  @filter_criteria='FULL-LOAD' 
  BEGIN
     SET @condition=';';
  END
ELSE IF @filter_criteria&lt;&gt;'' OR ISNULL(@filter_criteria,N'')&lt;&gt;'' 
    BEGIN
	    SET @condition=CONCAT('AND ',@filter_criteria,';');
    END
;  



TRUNCATE TABLE RPDW_USR_PRD.[dbo].DW_ENT_POLY_APPLICANT  
;

--
-- 1) POLY APPLICANT DETAILS 
--

-- Begin SET
SET @query=CONCAT(
    N'SELECT
		 CONVERT(varchar(4), CONCAT(''20'',LEFT(a.Admit_Term,2))) AS Academic_Year
		,CASE WHEN RIGHT(a.Admit_Term,2)=''10'' THEN CAST (''S1'' AS VARCHAR(2))
			  WHEN RIGHT(a.Admit_Term,2)=''00'' THEN CAST (''S1'' AS VARCHAR(2))
			  ELSE CAST (''S1'' AS VARCHAR(2))
			  END AS Semester  
		,a.Admit_Type
		,a.Applicant_Id                     
		,a.Admit_Term
		,a.App_Number
		,a.Primary_National_ID              
		,a.Masked_Primary_National_ID        
		,a.Entry_Qual
		,LEFT(b.Action_Date,4) as Action_Year
		
		INTO ##TMP_TBL1

		FROM RPDW_PRD.[dbo].[DW_APPLICANT_DETAILS] a WITH (NOLOCK)
	
		LEFT JOIN RPDW_PRD.[dbo].[DW_APPLICANT_PROGRAM_STATUS] b  WITH (NOLOCK)
	
		ON a.App_Number = b.App_Number
		and a.Admit_Term = b.Admit_Term

		WHERE a.Admit_Term &lt;&gt; (''NA'') 
		AND b.Programme_Action = (''ADMT'')
		AND a.Qual_Type IN 
	',@QUAL_TYPE
	);  -- End Set	
	 
  PRINT (@query);
  SET @all_queries=CONCAT(N'',@all_queries,@query);  
  EXEC (@query);	 


--
-- DW_EXT_DPAEAE_JAE 
--
; WITH TMP_DW_EXT_DPAEAE_JAE AS (

 		-- EXT_DPAEAE_JAE
		SELECT 
		UIN	COLLATE SQL_Latin1_General_CP1_CI_AS			AS UIN
		,MASKED_NATIONAL_ID	COLLATE SQL_Latin1_General_CP1_CI_AS AS MASKED_NATIONAL_ID   
		,AY_YEAR COLLATE SQL_Latin1_General_CP1_CI_AS		AS  ACAD_YEAR             
		,AY_SEM COLLATE SQL_Latin1_General_CP1_CI_AS		AS SEMESTER 
		,'DPA' COLLATE SQL_Latin1_General_CP1_CI_AS			AS ADMISSION_EXERCISE       
		,'' COLLATE SQL_Latin1_General_CP1_CI_AS			AS SEC_SCHOOL_CODE
		,RAW_AGGREGATE COLLATE SQL_Latin1_General_CP1_CI_AS AS RAW_AGG
		,NET_AGGREGATE COLLATE SQL_Latin1_General_CP1_CI_AS AS NET_AGG
		,JAE_SUBJECT_CD_10  COLLATE SQL_Latin1_General_CP1_CI_AS AS SUBJECT_CODE_10
		,JAE_SUBJECT_CD_11  COLLATE SQL_Latin1_General_CP1_CI_AS AS SUBJECT_CODE_11
		,JAE_SUBJECT_CD_12  COLLATE SQL_Latin1_General_CP1_CI_AS AS SUBJECT_CODE_12
		,JAE_SUBJECT_CD_1   COLLATE SQL_Latin1_General_CP1_CI_AS AS SUBJECT_CODE_1
		,JAE_SUBJECT_CD_2   COLLATE SQL_Latin1_General_CP1_CI_AS AS SUBJECT_CODE_2
		,JAE_SUBJECT_CD_3   COLLATE SQL_Latin1_General_CP1_CI_AS AS SUBJECT_CODE_3  
		,JAE_SUBJECT_CD_4   COLLATE SQL_Latin1_General_CP1_CI_AS AS SUBJECT_CODE_4 
		,JAE_SUBJECT_CD_5   COLLATE SQL_Latin1_General_CP1_CI_AS AS SUBJECT_CODE_5 
		,JAE_SUBJECT_CD_6   COLLATE SQL_Latin1_General_CP1_CI_AS AS SUBJECT_CODE_6
		,JAE_SUBJECT_CD_7   COLLATE SQL_Latin1_General_CP1_CI_AS AS SUBJECT_CODE_7
		,JAE_SUBJECT_CD_8   COLLATE SQL_Latin1_General_CP1_CI_AS AS SUBJECT_CODE_8
		,JAE_SUBJECT_CD_9   COLLATE SQL_Latin1_General_CP1_CI_AS AS SUBJECT_CODE_9
		,JAE_GRADE_10  COLLATE SQL_Latin1_General_CP1_CI_AS AS GRADE_10 
		,JAE_GRADE_11  COLLATE SQL_Latin1_General_CP1_CI_AS AS GRADE_11
		,JAE_GRADE_12  COLLATE SQL_Latin1_General_CP1_CI_AS AS GRADE_12
		,JAE_GRADE_1   COLLATE SQL_Latin1_General_CP1_CI_AS AS GRADE_1
		,JAE_GRADE_2   COLLATE SQL_Latin1_General_CP1_CI_AS AS GRADE_2
		,JAE_GRADE_3   COLLATE SQL_Latin1_General_CP1_CI_AS AS GRADE_3
		,JAE_GRADE_4   COLLATE SQL_Latin1_General_CP1_CI_AS AS GRADE_4
		,JAE_GRADE_5   COLLATE SQL_Latin1_General_CP1_CI_AS AS GRADE_5
		,JAE_GRADE_6   COLLATE SQL_Latin1_General_CP1_CI_AS AS GRADE_6
		,JAE_GRADE_7   COLLATE SQL_Latin1_General_CP1_CI_AS AS GRADE_7
		,JAE_GRADE_8   COLLATE SQL_Latin1_General_CP1_CI_AS AS GRADE_8
		,JAE_GRADE_9   COLLATE SQL_Latin1_General_CP1_CI_AS AS GRADE_9
		,CONVERT (VARCHAR(4),(SELECT MAX(VALUE) FROM STRING_SPLIT(COMBINED_SITTING,',')) COLLATE SQL_Latin1_General_CP1_CI_AS) AS ADM_EXE_YEAR_EXAM 

		FROM RPDW_PRD.dbo.DW_EXT_DPAEAE_JAE WITH (NOLOCK)  -- SOURCE DB: RPDW_STG


)  SELECT * 
   INTO ##TMP_DW_EXT_DPAEAE_JAE
   FROM TMP_DW_EXT_DPAEAE_JAE 
   OPTION (MAXDOP 1)
;  
--
-- OTHER ADM EXE
-- 
  
WITH TMP_OTHER_ADM_EXE AS (
		-- EXT_JAE --Latin1
		SELECT 
		UIN COLLATE SQL_Latin1_General_CP1_CI_AS						AS UIN
		,MASKED_NATIONAL_ID COLLATE SQL_Latin1_General_CP1_CI_AS		AS MASKED_NATIONAL_ID
		
		
		,FILE_NAME_ACADEMIC_YEAR COLLATE SQL_Latin1_General_CP1_CI_AS	AS ACAD_YEAR -- COMMENTED IN STG/UAT ONLY
		,FILE_NAME_SEMESTER COLLATE SQL_Latin1_General_CP1_CI_AS		AS SEMESTER	 -- COMMENTED IN STG/UAT ONLY
		
		--,' '  COLLATE SQL_Latin1_General_CP1_CI_AS	    AS ACAD_YEAR 
		--,' '  COLLATE SQL_Latin1_General_CP1_CI_AS		AS SEMESTER			
		
		,'JAE' COLLATE SQL_Latin1_General_CP1_CI_AS						AS ADMISSION_EXERCISE
		,SEC_SCHOOL_CD COLLATE SQL_Latin1_General_CP1_CI_AS				AS SEC_SCHOOL_CODE
		,POSTED_POINT  COLLATE SQL_Latin1_General_CP1_CI_AS				AS RAW_AGG
		,AGG_POSTED    COLLATE SQL_Latin1_General_CP1_CI_AS				AS NET_AGG
		,JAE_SUBJECT_CD_10 COLLATE SQL_Latin1_General_CP1_CI_AS			AS SUBJECT_CODE_10
		,JAE_SUBJECT_CD_11 COLLATE SQL_Latin1_General_CP1_CI_AS			AS SUBJECT_CODE_11
		,JAE_SUBJECT_CD_12 COLLATE SQL_Latin1_General_CP1_CI_AS			AS SUBJECT_CODE_12
		,JAE_SUBJECT_CD_1  COLLATE SQL_Latin1_General_CP1_CI_AS			AS SUBJECT_CODE_1
		,JAE_SUBJECT_CD_2  COLLATE SQL_Latin1_General_CP1_CI_AS			AS SUBJECT_CODE_2
		,JAE_SUBJECT_CD_3  COLLATE SQL_Latin1_General_CP1_CI_AS			AS SUBJECT_CODE_3
		,JAE_SUBJECT_CD_4  COLLATE SQL_Latin1_General_CP1_CI_AS			AS SUBJECT_CODE_4
		,JAE_SUBJECT_CD_5  COLLATE SQL_Latin1_General_CP1_CI_AS			AS SUBJECT_CODE_5
		,JAE_SUBJECT_CD_6  COLLATE SQL_Latin1_General_CP1_CI_AS			AS SUBJECT_CODE_6
		,JAE_SUBJECT_CD_7  COLLATE SQL_Latin1_General_CP1_CI_AS			AS SUBJECT_CODE_7
		,JAE_SUBJECT_CD_8  COLLATE SQL_Latin1_General_CP1_CI_AS			AS SUBJECT_CODE_8
		,JAE_SUBJECT_CD_9  COLLATE SQL_Latin1_General_CP1_CI_AS			AS SUBJECT_CODE_9
		,JAE_GRADE_10 COLLATE SQL_Latin1_General_CP1_CI_AS				AS GRADE_10
		,JAE_GRADE_11 COLLATE SQL_Latin1_General_CP1_CI_AS				AS GRADE_11
		,JAE_GRADE_12 COLLATE SQL_Latin1_General_CP1_CI_AS				AS GRADE_12
		,JAE_GRADE_1  COLLATE SQL_Latin1_General_CP1_CI_AS				AS GRADE_1
		,JAE_GRADE_2  COLLATE SQL_Latin1_General_CP1_CI_AS				AS GRADE_2
		,JAE_GRADE_3  COLLATE SQL_Latin1_General_CP1_CI_AS				AS GRADE_3
		,JAE_GRADE_4  COLLATE SQL_Latin1_General_CP1_CI_AS				AS GRADE_4
		,JAE_GRADE_5  COLLATE SQL_Latin1_General_CP1_CI_AS				AS GRADE_5
		,JAE_GRADE_6  COLLATE SQL_Latin1_General_CP1_CI_AS				AS GRADE_6
		,JAE_GRADE_7  COLLATE SQL_Latin1_General_CP1_CI_AS				AS GRADE_7
		,JAE_GRADE_8  COLLATE SQL_Latin1_General_CP1_CI_AS				AS GRADE_8
		,JAE_GRADE_9  COLLATE SQL_Latin1_General_CP1_CI_AS				AS GRADE_9
		,CONVERT(VARCHAR(4),YEAR_EXAM COLLATE SQL_Latin1_General_CP1_CI_AS) AS ADM_EXE_YEAR_EXAM

		FROM RPDW_PRD.[dbo].[DW_EXT_JAE]  WITH (NOLOCK)  -- SOURCE DB: RPDW_STG
		
		UNION ALL

		-- EXT_PFP --latin1
		SELECT 
		UIN COLLATE SQL_Latin1_General_CP1_CI_AS						AS UIN
		,MASKED_NATIONAL_ID	COLLATE SQL_Latin1_General_CP1_CI_AS		AS MASKED_NATIONAL_ID	
		,[AY_YEAR] COLLATE SQL_Latin1_General_CP1_CI_AS					AS ACAD_YEAR
		,[AY_SEM]  COLLATE SQL_Latin1_General_CP1_CI_AS					AS SEMESTER
		,'PFP'	   COLLATE SQL_Latin1_General_CP1_CI_AS					AS ADMISSION_EXERCISE
		,[SECONDARY SCHOOL] COLLATE SQL_Latin1_General_CP1_CI_AS		AS SEC_SCHOOL_CODE
		,[FINAL RAW SCORE] COLLATE SQL_Latin1_General_CP1_CI_AS			AS RAW_AGG
		,[FINAL NET SCORE] COLLATE SQL_Latin1_General_CP1_CI_AS			AS NET_AGG
		,'' COLLATE SQL_Latin1_General_CP1_CI_AS AS SUBJECT_CODE_10
		,'' COLLATE SQL_Latin1_General_CP1_CI_AS AS SUBJECT_CODE_11
		,'' COLLATE SQL_Latin1_General_CP1_CI_AS AS SUBJECT_CODE_12
		,'' COLLATE SQL_Latin1_General_CP1_CI_AS AS SUBJECT_CODE_1
		,'' COLLATE SQL_Latin1_General_CP1_CI_AS AS SUBJECT_CODE_2
		,'' COLLATE SQL_Latin1_General_CP1_CI_AS AS SUBJECT_CODE_3
		,'' COLLATE SQL_Latin1_General_CP1_CI_AS AS SUBJECT_CODE_4
		,'' COLLATE SQL_Latin1_General_CP1_CI_AS AS SUBJECT_CODE_5
		,'' COLLATE SQL_Latin1_General_CP1_CI_AS AS SUBJECT_CODE_6
		,'' COLLATE SQL_Latin1_General_CP1_CI_AS AS SUBJECT_CODE_7
		,'' COLLATE SQL_Latin1_General_CP1_CI_AS AS SUBJECT_CODE_8
		,'' COLLATE SQL_Latin1_General_CP1_CI_AS AS SUBJECT_CODE_9
		,'' COLLATE SQL_Latin1_General_CP1_CI_AS AS GRADE_10
		,'' COLLATE SQL_Latin1_General_CP1_CI_AS AS GRADE_11
		,'' COLLATE SQL_Latin1_General_CP1_CI_AS AS GRADE_12
		,'' COLLATE SQL_Latin1_General_CP1_CI_AS AS GRADE_1
		,'' COLLATE SQL_Latin1_General_CP1_CI_AS AS GRADE_2
		,'' COLLATE SQL_Latin1_General_CP1_CI_AS AS GRADE_3
		,'' COLLATE SQL_Latin1_General_CP1_CI_AS AS GRADE_4
		,'' COLLATE SQL_Latin1_General_CP1_CI_AS AS GRADE_5
		,'' COLLATE SQL_Latin1_General_CP1_CI_AS AS GRADE_6
		,'' COLLATE SQL_Latin1_General_CP1_CI_AS AS GRADE_7
		,'' COLLATE SQL_Latin1_General_CP1_CI_AS AS GRADE_8
		,'' COLLATE SQL_Latin1_General_CP1_CI_AS AS GRADE_9
		,CONVERT(VARCHAR(4),[EXAM YEAR] COLLATE SQL_Latin1_General_CP1_CI_AS) AS ADM_EXE_YEAR_EXAM		

		FROM RPDW_PRD.dbo.[DW_EXT_PFP]  WITH (NOLOCK)  -- SOURCE DB: RPDW_STG

		UNION ALL

		-- EXT_JPSAE --latin1
		SELECT 
		[NRIC FIN] COLLATE SQL_Latin1_General_CP1_CI_AS					AS UIN
		,MASKED_NATIONAL_ID COLLATE SQL_Latin1_General_CP1_CI_AS		AS MASKED_NATIONAL_ID

		,FILE_NAME_ACADEMIC_YEAR COLLATE SQL_Latin1_General_CP1_CI_AS   AS ACAD_YEAR   -- COMMENTED IN STG/UAT ONLY
		,FILE_NAME_SEMESTER COLLATE SQL_Latin1_General_CP1_CI_AS		AS SEMESTER    -- COMMENTED IN STG/UAT ONLY
		
	    --,''  COLLATE SQL_Latin1_General_CP1_CI_AS       AS ACAD_YEAR    
		--,''  COLLATE SQL_Latin1_General_CP1_CI_AS		AS SEMESTER  
		
		,'JSE' COLLATE SQL_Latin1_General_CP1_CI_AS						AS ADMISSION_EXERCISE
		,[Sec School] COLLATE SQL_Latin1_General_CP1_CI_AS				AS SEC_SCHOOL_CODE
		,[POSTED AGGREGATE] COLLATE SQL_Latin1_General_CP1_CI_AS		AS RAW_AGG
		,[NET POSTED AGGREGATE] COLLATE SQL_Latin1_General_CP1_CI_AS	AS NET_AGG
		,[SUBJECT CODE_10] COLLATE SQL_Latin1_General_CP1_CI_AS AS SUBJECT_CODE_10
		,[SUBJECT CODE_11] COLLATE SQL_Latin1_General_CP1_CI_AS AS SUBJECT_CODE_11
		,[SUBJECT CODE_12] COLLATE SQL_Latin1_General_CP1_CI_AS AS SUBJECT_CODE_12
		,[SUBJECT CODE_1]  COLLATE SQL_Latin1_General_CP1_CI_AS AS SUBJECT_CODE_1
		,[SUBJECT CODE_2]  COLLATE SQL_Latin1_General_CP1_CI_AS AS SUBJECT_CODE_2
		,[SUBJECT CODE_3]  COLLATE SQL_Latin1_General_CP1_CI_AS AS SUBJECT_CODE_3
		,[SUBJECT CODE_4]  COLLATE SQL_Latin1_General_CP1_CI_AS AS SUBJECT_CODE_4
		,[SUBJECT CODE_5]  COLLATE SQL_Latin1_General_CP1_CI_AS AS SUBJECT_CODE_5
		,[SUBJECT CODE_6]  COLLATE SQL_Latin1_General_CP1_CI_AS AS SUBJECT_CODE_6
		,[SUBJECT CODE_7]  COLLATE SQL_Latin1_General_CP1_CI_AS AS SUBJECT_CODE_7
		,[SUBJECT CODE_8]  COLLATE SQL_Latin1_General_CP1_CI_AS AS SUBJECT_CODE_8
		,[SUBJECT CODE_9]  COLLATE SQL_Latin1_General_CP1_CI_AS AS SUBJECT_CODE_9
		,[ SUBJECT GRADE_10] COLLATE SQL_Latin1_General_CP1_CI_AS AS GRADE_10
		,[ SUBJECT GRADE_11] COLLATE SQL_Latin1_General_CP1_CI_AS AS GRADE_11
		,[ SUBJECT GRADE_12] COLLATE SQL_Latin1_General_CP1_CI_AS AS GRADE_12
		,[ SUBJECT GRADE_1]  COLLATE SQL_Latin1_General_CP1_CI_AS AS GRADE_1
		,[ SUBJECT GRADE_2]  COLLATE SQL_Latin1_General_CP1_CI_AS AS GRADE_2
		,[ SUBJECT GRADE_3]  COLLATE SQL_Latin1_General_CP1_CI_AS AS GRADE_3
		,[ SUBJECT GRADE_4]  COLLATE SQL_Latin1_General_CP1_CI_AS AS GRADE_4
		,[ SUBJECT GRADE_5]  COLLATE SQL_Latin1_General_CP1_CI_AS AS GRADE_5
		,[ SUBJECT GRADE_6]  COLLATE SQL_Latin1_General_CP1_CI_AS AS GRADE_6
		,[ SUBJECT GRADE_7]  COLLATE SQL_Latin1_General_CP1_CI_AS AS GRADE_7
		,[ SUBJECT GRADE_8]  COLLATE SQL_Latin1_General_CP1_CI_AS AS GRADE_8
		,[ SUBJECT GRADE_9]  COLLATE SQL_Latin1_General_CP1_CI_AS AS GRADE_9
		,CONVERT(VARCHAR(4),CASE WHEN [Year Taken 1] &gt; [Year Taken 2] THEN [Year Taken 1] 
			                      WHEN [Year Taken 2] &gt; [Year Taken 1] THEN [Year Taken 2]
			                      WHEN [Year Taken 1] = [Year Taken 2] THEN [Year Taken 1]
		                     END COLLATE SQL_Latin1_General_CP1_CI_AS)
        AS ADM_EXE_YEAR_EXAM

		FROM RPDW_PRD.dbo.[DW_EXT_JPSAE] WITH (NOLOCK)   -- SOURCE DB: RPDW_STG
		
)  SELECT * 
   INTO ##TMP_OTHER_ADM_EXE
   FROM TMP_OTHER_ADM_EXE
   OPTION (MAXDOP 1)
;

  
--
-- 2) EXT ADMISSION EXERCISE 
-- 
WITH TMP_EXT_ADM_EXE AS (
  SELECT * FROM ##TMP_DW_EXT_DPAEAE_JAE WITH (NOLOCK)
  UNION ALL
  SELECT * FROM ##TMP_OTHER_ADM_EXE WITH (NOLOCK)
) SELECT * 
  INTO ##TMP_TBL2
  FROM TMP_EXT_ADM_EXE
  OPTION (MAXDOP 1)
;
  
--
-- 3) TEST YEAR DATE
-- 
;WITH TMP_WRK_POLY_YEAR_TEST_DATE AS(
 SELECT 
  a.Applicant_ID  
 ,a.Test_ID
 ,a.Test_Date
 ,a.Year_Taken_ITE
 ,b.Entry_Qual_Type
	,a.Acad_Gpa   
	,a.Adjust_Gpa 
	,CASE WHEN a.Test_ID IN ('MY SPM V','MY UECV','OTH INT QLF','OTHERS IB','OTHR INTL','SG IB','SG IP') THEN '' ELSE a.SUBJECT_10 END AS SUBJECT_10
	,CASE WHEN a.Test_ID IN ('MY SPM V','MY UECV','OTH INT QLF','OTHERS IB','OTHR INTL','SG IB','SG IP') THEN '' ELSE a.SUBJECT_1 END AS SUBJECT_1
	,CASE WHEN a.Test_ID IN ('MY SPM V','MY UECV','OTH INT QLF','OTHERS IB','OTHR INTL','SG IB','SG IP') THEN '' ELSE a.SUBJECT_2 END AS SUBJECT_2
	,CASE WHEN a.Test_ID IN ('MY SPM V','MY UECV','OTH INT QLF','OTHERS IB','OTHR INTL','SG IB','SG IP') THEN '' ELSE a.SUBJECT_3 END AS SUBJECT_3
	,CASE WHEN a.Test_ID IN ('MY SPM V','MY UECV','OTH INT QLF','OTHERS IB','OTHR INTL','SG IB','SG IP') THEN '' ELSE a.SUBJECT_4 END AS SUBJECT_4
	,CASE WHEN a.Test_ID IN ('MY SPM V','MY UECV','OTH INT QLF','OTHERS IB','OTHR INTL','SG IB','SG IP') THEN '' ELSE a.SUBJECT_5 END AS SUBJECT_5
	,CASE WHEN a.Test_ID IN ('MY SPM V','MY UECV','OTH INT QLF','OTHERS IB','OTHR INTL','SG IB','SG IP') THEN '' ELSE a.SUBJECT_6 END AS SUBJECT_6
	,CASE WHEN a.Test_ID IN ('MY SPM V','MY UECV','OTH INT QLF','OTHERS IB','OTHR INTL','SG IB','SG IP') THEN '' ELSE a.SUBJECT_7 END AS SUBJECT_7
	,CASE WHEN a.Test_ID IN ('MY SPM V','MY UECV','OTH INT QLF','OTHERS IB','OTHR INTL','SG IB','SG IP') THEN '' ELSE a.SUBJECT_8 END AS SUBJECT_8
	,CASE WHEN a.Test_ID IN ('MY SPM V','MY UECV','OTH INT QLF','OTHERS IB','OTHR INTL','SG IB','SG IP') THEN '' ELSE a.SUBJECT_9 END AS SUBJECT_9
	,a.GRADE_10    
	,a.GRADE_1
	,a.GRADE_2
	,a.GRADE_3
	,a.GRADE_4
	,a.GRADE_5
	,a.GRADE_6
	,a.GRADE_7
	,a.GRADE_8
	,a.GRADE_9

 ,CASE WHEN b.Entry_Qual_Type IN ('HINITEC','NITEC') THEN CONVERT(VARCHAR(4),a.Year_Taken_ITE) 
       ELSE CONVERT(VARCHAR(4),YEAR(a.Test_Date))
	   END AS TEST_RESULTS_YEAR_EXAM
 ,ROW_NUMBER() OVER (PARTITION BY  Applicant_ID ORDER BY Test_Date DESC) as rec_cnt_by_pk

 FROM RPDW_PRD.[dbo].[DW_APPLICANT_TEST_RESULTS] a  WITH (NOLOCK) 
 LEFT JOIN RPDW_PRD.[dbo].[DW_EXT_ENTRY_QUAL_TYPE] b  WITH (NOLOCK) 
 ON a.Test_ID = b.Entry_Qual
 
) SELECT * 
  INTO ##TMP_TBL3
  FROM TMP_WRK_POLY_YEAR_TEST_DATE where rec_cnt_by_pk = 1
  OPTION (MAXDOP 1)
;
  
------------------------
-- CREATE Poly_Applicant
------------------------
 
;WITH WRK_POLY_EXT_ADM_WITH_STUDENT_DTL_MATCH AS (
SELECT
	 a.Academic_Year
	,a.Admit_Term
	,a.App_Number
	,a.Semester
	,a.Admit_Type
	,a.Applicant_Id
	,a.Primary_National_ID
	,a.Entry_Qual
	,b.ADMISSION_EXERCISE
	,b.SEC_SCHOOL_CODE
	,b.RAW_AGG
	,b.NET_AGG
    ,b.MASKED_NATIONAL_ID
	,b.UIN 
	,b.ACAD_YEAR
	,b.SUBJECT_CODE_10
	,b.SUBJECT_CODE_11
	,b.SUBJECT_CODE_12
	,b.SUBJECT_CODE_1
	,b.SUBJECT_CODE_2
	,b.SUBJECT_CODE_3
	,b.SUBJECT_CODE_4
	,b.SUBJECT_CODE_5
	,b.SUBJECT_CODE_6
	,b.SUBJECT_CODE_7
	,b.SUBJECT_CODE_8
	,b.SUBJECT_CODE_9
	,b.GRADE_10
	,b.GRADE_11
	,b.GRADE_12
	,b.GRADE_1
	,b.GRADE_2
	,b.GRADE_3
	,b.GRADE_4
	,b.GRADE_5
	,b.GRADE_6
	,b.GRADE_7
	,b.GRADE_8
	,b.GRADE_9
	,b.ADM_EXE_YEAR_EXAM
	,CASE WHEN (ISNULL(b.ACAD_YEAR,N'')='' AND ISNULL(b.SEMESTER,N'')='' AND ISNULL(b.ADMISSION_EXERCISE,N'')='' ) THEN 'N' ELSE 'Y' END AS TAG_ADMISSION_EXE_MATCH
	,c.Acad_Gpa
	,c.Adjust_Gpa
	,c.SUBJECT_10
	,c.SUBJECT_1
	,c.SUBJECT_2
	,c.SUBJECT_3
	,c.SUBJECT_4
	,c.SUBJECT_5
	,c.SUBJECT_6
	,c.SUBJECT_7
	,c.SUBJECT_8
	,c.SUBJECT_9
	,c.GRADE_10 AS [c.grade_10]
	,c.GRADE_1  AS [c.grade_1]
	,c.GRADE_2  AS [c.grade_2]
	,c.GRADE_3  AS [c.grade_3]
	,c.GRADE_4  AS [c.grade_4]
	,c.GRADE_5  AS [c.grade_5]
	,c.GRADE_6  AS [c.grade_6]
	,c.GRADE_7  AS [c.grade_7]
	,c.GRADE_8  AS [c.grade_8]
	,c.GRADE_9  AS [c.grade_9]
	,c.TEST_RESULTS_YEAR_EXAM
	,CASE WHEN ISNULL(c.Applicant_Id,N'')='' AND ISNULL(c.Test_ID,N'')='' THEN 'N' ELSE 'Y' END AS TAG_APPLNT_TEST_RESULT_MATCH 

FROM ##TMP_TBL1 a WITH (NOLOCK)

  -- JOIN1: DW_APPLICANT_DETAILS AS BASE,
  -- LEFT JOIN WITH DW_APPLICANT_TEST_RESULTS TO GET THE YEAR_TEST_DATE
  
LEFT JOIN ##TMP_TBL2 b WITH (NOLOCK)
ON  a.Masked_Primary_National_ID = b.MASKED_NATIONAL_ID 
and a.Action_Year COLLATE SQL_Latin1_General_CP1_CI_AS = b.ACAD_YEAR COLLATE SQL_Latin1_General_CP1_CI_AS 
and a.Admit_Type COLLATE SQL_Latin1_General_CP1_CI_AS = LEFT(b.ADMISSION_EXERCISE,3) COLLATE SQL_Latin1_General_CP1_CI_AS

  -- JOIN2: UNMATCH FROM JOIN1 
  -- LEFT JOIN WRK_POLY_EXT_ADMISSION_EXE and DW_APPLICANT_TEST_RESULTS TO EXTRACT THE SUBJECT1-10, GRADE1-10 and YEAREXAM FOR THOSE
  -- UNNMATCHED FROM DW_EXT_ADMISSION_EXE

LEFT JOIN ##TMP_TBL3 c WITH (NOLOCK)
ON  a.Applicant_Id = c.Applicant_Id
AND a.Entry_Qual = c.Test_ID 
AND (ISNULL(b.ACAD_YEAR,N'')='' AND ISNULL(b.SEMESTER,N'')='' AND ISNULL(b.ADMISSION_EXERCISE,N'')='' )

) SELECT * 
  INTO ##TMP_TBL4
  FROM WRK_POLY_EXT_ADM_WITH_STUDENT_DTL_MATCH
  OPTION (MAXDOP 1)
;
 
-- Begin SET
SET @query=CONCAT(
    N'SELECT 
	 Applicant_Id         as [EMPLID]       
    ,Academic_Year        as [Acad_Year]
	,Admit_Type           as [Admission_Exercise]
	,Admit_Term
	,App_Number           as [Application_Number]
	,SEC_SCHOOL_CODE      as [Sec_School_Code]
	,CASE WHEN TAG_ADMISSION_EXE_MATCH = ''Y'' THEN RAW_AGG ELSE CAST (Acad_Gpa AS VARCHAR(6)) END as [Raw_Agg] 
	,CASE WHEN TAG_ADMISSION_EXE_MATCH = ''Y'' THEN NET_AGG ELSE CAST (Adjust_Gpa AS VARCHAR(6)) END as [Net_Agg] 
	,CASE WHEN TAG_ADMISSION_EXE_MATCH = ''Y'' THEN SUBJECT_CODE_10 ELSE SUBJECT_10 END as [Subject_Code_10]
	,SUBJECT_CODE_11 as [Subject_Code_11]
	,SUBJECT_CODE_12 as [Subject_Code_12]
	,CASE WHEN TAG_ADMISSION_EXE_MATCH = ''Y'' THEN SUBJECT_CODE_1 ELSE SUBJECT_1 END as [Subject_Code_1]
	,CASE WHEN TAG_ADMISSION_EXE_MATCH = ''Y'' THEN SUBJECT_CODE_2 ELSE SUBJECT_2 END as [Subject_Code_2]
	,CASE WHEN TAG_ADMISSION_EXE_MATCH = ''Y'' THEN SUBJECT_CODE_3 ELSE SUBJECT_3 END as [Subject_Code_3]
	,CASE WHEN TAG_ADMISSION_EXE_MATCH = ''Y'' THEN SUBJECT_CODE_4 ELSE SUBJECT_4 END as [Subject_Code_4]
	,CASE WHEN TAG_ADMISSION_EXE_MATCH = ''Y'' THEN SUBJECT_CODE_5 ELSE SUBJECT_5 END as [Subject_Code_5]
	,CASE WHEN TAG_ADMISSION_EXE_MATCH = ''Y'' THEN SUBJECT_CODE_6 ELSE SUBJECT_6 END as [Subject_Code_6]
	,CASE WHEN TAG_ADMISSION_EXE_MATCH = ''Y'' THEN SUBJECT_CODE_7 ELSE SUBJECT_7 END as [Subject_Code_7]	
	,CASE WHEN TAG_ADMISSION_EXE_MATCH = ''Y'' THEN SUBJECT_CODE_8 ELSE SUBJECT_8 END as [Subject_Code_8]
	,CASE WHEN TAG_ADMISSION_EXE_MATCH = ''Y'' THEN SUBJECT_CODE_9 ELSE SUBJECT_9 END as [Subject_Code_9]
	,CASE WHEN TAG_ADMISSION_EXE_MATCH = ''Y'' THEN GRADE_10 ELSE [c.grade_10] END as [Grade_10]
	,GRADE_11 as [Grade_11]
	,GRADE_12 as [Grade_12]
	,CASE WHEN TAG_ADMISSION_EXE_MATCH = ''Y'' THEN GRADE_1 ELSE [c.grade_1] END as [Grade_1]
	,CASE WHEN TAG_ADMISSION_EXE_MATCH = ''Y'' THEN GRADE_2 ELSE [c.grade_2] END as [Grade_2]
	,CASE WHEN TAG_ADMISSION_EXE_MATCH = ''Y'' THEN GRADE_3 ELSE [c.grade_3] END as [Grade_3]
	,CASE WHEN TAG_ADMISSION_EXE_MATCH = ''Y'' THEN GRADE_4 ELSE [c.grade_4] END as [Grade_4]
	,CASE WHEN TAG_ADMISSION_EXE_MATCH = ''Y'' THEN GRADE_5 ELSE [c.grade_5] END as [Grade_5]
	,CASE WHEN TAG_ADMISSION_EXE_MATCH = ''Y'' THEN GRADE_6 ELSE [c.grade_6] END as [Grade_6]
	,CASE WHEN TAG_ADMISSION_EXE_MATCH = ''Y'' THEN GRADE_7 ELSE [c.grade_7] END as [Grade_7]
	,CASE WHEN TAG_ADMISSION_EXE_MATCH = ''Y'' THEN GRADE_8 ELSE [c.grade_8] END as [Grade_8]
	,CASE WHEN TAG_ADMISSION_EXE_MATCH = ''Y'' THEN GRADE_9 ELSE [c.grade_9] END as [Grade_9]
	,CASE WHEN TAG_ADMISSION_EXE_MATCH = ''Y'' THEN ADM_EXE_YEAR_EXAM ELSE TEST_RESULTS_YEAR_EXAM END as [yearexam]
	,ROW_NUMBER() OVER 
	(PARTITION BY Applicant_Id, Academic_Year, Admit_Type 
	 ORDER BY Applicant_Id, Academic_Year, Admit_Type) as rec_cnt_by_pk -- ADDED DURING TESTING AS THERE ARE DUP BY KEY
 INTO ##TMP_Poly_Applicant 
 FROM ##TMP_TBL4 WITH (NOLOCK)
 WHERE 1=1
 ',@condition	 
	 
); -- End Set	 
 
  PRINT (@query);
  SET @all_queries=CONCAT(N'',@all_queries,@query);  
  EXEC (@query);	 



 
  INSERT INTO RPDW_USR_PRD.[dbo].DW_ENT_POLY_APPLICANT               
      (  
	   [EMPLID]
      ,[Acad_Year]
      ,[Admission_Exercise]
      ,[Admit_Term]
      ,[Application_Number]
      ,[Sec_School_Code]
      ,[Raw_Agg]
      ,[Net_Agg]
      ,[Subject_Code_10]
      ,[Subject_Code_11]
      ,[Subject_Code_12]
      ,[Subject_Code_1]
      ,[Subject_Code_2]
      ,[Subject_Code_3]
      ,[Subject_Code_4]
      ,[Subject_Code_5]
      ,[Subject_Code_6]
      ,[Subject_Code_7]
      ,[Subject_Code_8]
      ,[Subject_Code_9]
      ,[Grade_10]
      ,[Grade_11]
      ,[Grade_12]
      ,[Grade_1]
      ,[Grade_2]
      ,[Grade_3]
      ,[Grade_4]
      ,[Grade_5]
      ,[Grade_6]
      ,[Grade_7]
      ,[Grade_8]
      ,[Grade_9]
      ,[yearexam]
      ,[CREATED_ON]
      ,[MODIFIED_ON]
	   ) 
	SELECT 
	   [EMPLID]
      ,[Acad_Year]
      ,[Admission_Exercise]
      ,[Admit_Term]
      ,[Application_Number]
      ,[Sec_School_Code]
      ,[Raw_Agg]
      ,[Net_Agg]
      ,[Subject_Code_10]
      ,[Subject_Code_11]
      ,[Subject_Code_12]
      ,[Subject_Code_1]
      ,[Subject_Code_2]
      ,[Subject_Code_3]
      ,[Subject_Code_4]
      ,[Subject_Code_5]
      ,[Subject_Code_6]
      ,[Subject_Code_7]
      ,[Subject_Code_8]
      ,[Subject_Code_9]
      ,[Grade_10]
      ,[Grade_11]
      ,[Grade_12]
      ,[Grade_1]
      ,[Grade_2]
      ,[Grade_3]
      ,[Grade_4]
      ,[Grade_5]
      ,[Grade_6]
      ,[Grade_7]
      ,[Grade_8]
      ,[Grade_9]
      ,[yearexam]
	  ,getdate()
	  ,getdate()
	FROM ##TMP_Poly_Applicant WITH (NOLOCK)
	WHERE rec_cnt_by_pk = 1
	OPTION (MAXDOP 1)
;


-- Check Source Table Count
SELECT @source_cnt=COUNT(*) FROM ##TMP_Poly_Applicant WITH (NOLOCK) WHERE rec_cnt_by_pk = 1;
	
-- Check Tgt Table Count
SELECT @target_cnt=COUNT(*) FROM RPDW_USR_PRD.[dbo].DW_ENT_POLY_APPLICANT;
    
-- Update Counts
UPDATE RPDW_USR_PRD.[dbo].[ETL_JOB_STATUS] 
   SET [SRC_CNT]=@source_cnt,
       [TGT_CNT]=@target_cnt,
	   [REMARKS]=@all_queries,
	   [FILENAME]=@outputfilename
   WHERE [JOB_STATUS_ID]=@jobstatusid;	
    
    

--------------------------------------
COMMIT TRANSACTION
END TRY

BEGIN CATCH
  ROLLBACK TRANSACTION

  INSERT INTO RPDW_USR_PRD.[dbo].[ETL_ERROR_LOG](JOB_STATUS_ID,ERROR_RECORD,created_on)
  SELECT   
         CAST(@jobstatusid as int) as JOB_STATUS_ID
        ,ERROR_MESSAGE() AS ErrorMessage
		,getdate()  as created_on

-- Update SQL QUERIES EXECUTED
UPDATE RPDW_USR_PRD.[dbo].[ETL_JOB_STATUS] 
   SET [REMARKS]=@all_queries
   WHERE [JOB_STATUS_ID]=@jobstatusid;	
   
END CATCH 
GO
</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{6B449B44-6A74-4E0E-9888-34CF54295A57}"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="STAGE">
      <DTS:VariableValue
        DTS:DataType="8">DW</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{31ADBDF0-4754-457A-AE29-25266FCD2269}"
      DTS:EvaluateAsExpression="True"
      DTS:Expression="@[User::Job_name]"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="TgtTableName">
      <DTS:VariableValue
        DTS:DataType="8">DW_ENT_POLY_APPLICANT</DTS:VariableValue>
    </DTS:Variable>
  </DTS:Variables>
  <DTS:Executables>
    <DTS:Executable
      DTS:refId="Package\DFT_ExportDMtoTXT"
      DTS:CreationName="Microsoft.Pipeline"
      DTS:Description="Data Flow Task"
      DTS:DTSID="{E743C17B-644D-41DA-AA6C-90E96C10536B}"
      DTS:ExecutableType="Microsoft.Pipeline"
      DTS:LocaleID="-1"
      DTS:ObjectName="DFT_ExportDMtoTXT"
      DTS:TaskContact="Performs high-performance data extraction, transformation and loading;Microsoft Corporation; Microsoft SQL Server; (C) Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
      <DTS:Variables />
      <DTS:ObjectData>
        <pipeline
          version="1">
          <components>
            <component
              refId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput"
              componentClassID="Microsoft.FlatFileDestination"
              contactInfo="Flat File Destination;Microsoft Corporation; Microsoft SQL Server; (C) Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;1"
              description="Flat File Destination"
              localeId="1033"
              name="FF_DST_TextOutput">
              <properties>
                <property
                  dataType="System.Boolean"
                  description="Specifies whether the data will overwrite or append to the destination file."
                  name="Overwrite">true</property>
                <property
                  dataType="System.Null"
                  description="Specifies the text to write to the destination file before any data is written."
                  expressionType="Notify"
                  name="Header" />
                <property
                  dataType="System.Boolean"
                  description="When text qualifier is enabled, specifies whether the text qualifier in the data written to the destination file will be escaped or not."
                  name="EscapeQualifier">false</property>
              </properties>
              <connections>
                <connection
                  refId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Connections[FlatFileConnection]"
                  connectionManagerID="Package.ConnectionManagers[OutputTextFile_Conn]"
                  connectionManagerRefId="Package.ConnectionManagers[OutputTextFile_Conn]"
                  name="FlatFileConnection" />
              </connections>
              <inputs>
                <input
                  refId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input]"
                  hasSideEffects="true"
                  name="Flat File Destination Input">
                  <inputColumns>
                    <inputColumn
                      refId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].Columns[Admission_Exercise]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="100"
                      cachedName="Admission_Exercise"
                      externalMetadataColumnId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].ExternalColumns[Admission_Exercise]"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[Admission_Exercise]" />
                    <inputColumn
                      refId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].Columns[Admit_Term]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="4"
                      cachedName="Admit_Term"
                      externalMetadataColumnId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].ExternalColumns[Admit_Term]"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[Admit_Term]" />
                    <inputColumn
                      refId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].Columns[EMPLID]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="11"
                      cachedName="EMPLID"
                      externalMetadataColumnId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].ExternalColumns[EMPLID]"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[EMPLID]" />
                    <inputColumn
                      refId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].Columns[Acad_Year]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="6"
                      cachedName="Acad_Year"
                      externalMetadataColumnId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].ExternalColumns[Acad_Year]"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[Acad_Year]" />
                    <inputColumn
                      refId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].Columns[Application_Number]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="8"
                      cachedName="Application_Number"
                      externalMetadataColumnId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].ExternalColumns[Application_Number]"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[Application_Number]" />
                    <inputColumn
                      refId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].Columns[Sec_School_Code]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="10"
                      cachedName="Sec_School_Code"
                      externalMetadataColumnId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].ExternalColumns[Sec_School_Code]"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[Sec_School_Code]" />
                    <inputColumn
                      refId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].Columns[Raw_Agg]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="6"
                      cachedName="Raw_Agg"
                      externalMetadataColumnId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].ExternalColumns[Raw_Agg]"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[Raw_Agg]" />
                    <inputColumn
                      refId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].Columns[Net_Agg]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="6"
                      cachedName="Net_Agg"
                      externalMetadataColumnId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].ExternalColumns[Net_Agg]"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[Net_Agg]" />
                    <inputColumn
                      refId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].Columns[Subject_Code_10]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="10"
                      cachedName="Subject_Code_10"
                      externalMetadataColumnId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].ExternalColumns[Subject_Code_10]"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[Subject_Code_10]" />
                    <inputColumn
                      refId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].Columns[Subject_Code_11]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="10"
                      cachedName="Subject_Code_11"
                      externalMetadataColumnId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].ExternalColumns[Subject_Code_11]"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[Subject_Code_11]" />
                    <inputColumn
                      refId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].Columns[Subject_Code_12]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="10"
                      cachedName="Subject_Code_12"
                      externalMetadataColumnId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].ExternalColumns[Subject_Code_12]"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[Subject_Code_12]" />
                    <inputColumn
                      refId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].Columns[Subject_Code_1]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="10"
                      cachedName="Subject_Code_1"
                      externalMetadataColumnId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].ExternalColumns[Subject_Code_1]"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[Subject_Code_1]" />
                    <inputColumn
                      refId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].Columns[Subject_Code_2]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="10"
                      cachedName="Subject_Code_2"
                      externalMetadataColumnId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].ExternalColumns[Subject_Code_2]"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[Subject_Code_2]" />
                    <inputColumn
                      refId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].Columns[Subject_Code_3]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="10"
                      cachedName="Subject_Code_3"
                      externalMetadataColumnId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].ExternalColumns[Subject_Code_3]"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[Subject_Code_3]" />
                    <inputColumn
                      refId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].Columns[Subject_Code_4]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="10"
                      cachedName="Subject_Code_4"
                      externalMetadataColumnId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].ExternalColumns[Subject_Code_4]"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[Subject_Code_4]" />
                    <inputColumn
                      refId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].Columns[Subject_Code_5]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="10"
                      cachedName="Subject_Code_5"
                      externalMetadataColumnId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].ExternalColumns[Subject_Code_5]"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[Subject_Code_5]" />
                    <inputColumn
                      refId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].Columns[Subject_Code_6]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="10"
                      cachedName="Subject_Code_6"
                      externalMetadataColumnId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].ExternalColumns[Subject_Code_6]"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[Subject_Code_6]" />
                    <inputColumn
                      refId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].Columns[Subject_Code_7]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="10"
                      cachedName="Subject_Code_7"
                      externalMetadataColumnId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].ExternalColumns[Subject_Code_7]"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[Subject_Code_7]" />
                    <inputColumn
                      refId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].Columns[Subject_Code_8]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="10"
                      cachedName="Subject_Code_8"
                      externalMetadataColumnId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].ExternalColumns[Subject_Code_8]"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[Subject_Code_8]" />
                    <inputColumn
                      refId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].Columns[Subject_Code_9]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="10"
                      cachedName="Subject_Code_9"
                      externalMetadataColumnId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].ExternalColumns[Subject_Code_9]"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[Subject_Code_9]" />
                    <inputColumn
                      refId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].Columns[Grade_10]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="4"
                      cachedName="Grade_10"
                      externalMetadataColumnId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].ExternalColumns[Grade_10]"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[Grade_10]" />
                    <inputColumn
                      refId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].Columns[Grade_11]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="4"
                      cachedName="Grade_11"
                      externalMetadataColumnId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].ExternalColumns[Grade_11]"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[Grade_11]" />
                    <inputColumn
                      refId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].Columns[Grade_12]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="4"
                      cachedName="Grade_12"
                      externalMetadataColumnId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].ExternalColumns[Grade_12]"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[Grade_12]" />
                    <inputColumn
                      refId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].Columns[Grade_1]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="4"
                      cachedName="Grade_1"
                      externalMetadataColumnId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].ExternalColumns[Grade_1]"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[Grade_1]" />
                    <inputColumn
                      refId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].Columns[Grade_2]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="4"
                      cachedName="Grade_2"
                      externalMetadataColumnId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].ExternalColumns[Grade_2]"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[Grade_2]" />
                    <inputColumn
                      refId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].Columns[Grade_3]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="4"
                      cachedName="Grade_3"
                      externalMetadataColumnId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].ExternalColumns[Grade_3]"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[Grade_3]" />
                    <inputColumn
                      refId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].Columns[Grade_4]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="4"
                      cachedName="Grade_4"
                      externalMetadataColumnId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].ExternalColumns[Grade_4]"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[Grade_4]" />
                    <inputColumn
                      refId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].Columns[Grade_5]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="4"
                      cachedName="Grade_5"
                      externalMetadataColumnId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].ExternalColumns[Grade_5]"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[Grade_5]" />
                    <inputColumn
                      refId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].Columns[Grade_6]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="4"
                      cachedName="Grade_6"
                      externalMetadataColumnId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].ExternalColumns[Grade_6]"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[Grade_6]" />
                    <inputColumn
                      refId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].Columns[Grade_7]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="4"
                      cachedName="Grade_7"
                      externalMetadataColumnId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].ExternalColumns[Grade_7]"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[Grade_7]" />
                    <inputColumn
                      refId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].Columns[Grade_8]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="4"
                      cachedName="Grade_8"
                      externalMetadataColumnId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].ExternalColumns[Grade_8]"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[Grade_8]" />
                    <inputColumn
                      refId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].Columns[Grade_9]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="4"
                      cachedName="Grade_9"
                      externalMetadataColumnId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].ExternalColumns[Grade_9]"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[Grade_9]" />
                    <inputColumn
                      refId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].Columns[yearexam]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="4"
                      cachedName="yearexam"
                      externalMetadataColumnId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].ExternalColumns[yearexam]"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[yearexam]" />
                  </inputColumns>
                  <externalMetadataColumns
                    isUsed="True">
                    <externalMetadataColumn
                      refId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].ExternalColumns[Admission_Exercise]"
                      codePage="1252"
                      dataType="str"
                      length="100"
                      name="Admission_Exercise" />
                    <externalMetadataColumn
                      refId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].ExternalColumns[Admit_Term]"
                      codePage="1252"
                      dataType="str"
                      length="4"
                      name="Admit_Term" />
                    <externalMetadataColumn
                      refId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].ExternalColumns[EMPLID]"
                      codePage="1252"
                      dataType="str"
                      length="11"
                      name="EMPLID" />
                    <externalMetadataColumn
                      refId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].ExternalColumns[Acad_Year]"
                      codePage="1252"
                      dataType="str"
                      length="6"
                      name="Acad_Year" />
                    <externalMetadataColumn
                      refId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].ExternalColumns[Application_Number]"
                      codePage="1252"
                      dataType="str"
                      length="8"
                      name="Application_Number" />
                    <externalMetadataColumn
                      refId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].ExternalColumns[Sec_School_Code]"
                      codePage="1252"
                      dataType="str"
                      length="10"
                      name="Sec_School_Code" />
                    <externalMetadataColumn
                      refId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].ExternalColumns[Raw_Agg]"
                      codePage="1252"
                      dataType="str"
                      length="6"
                      name="Raw_Agg" />
                    <externalMetadataColumn
                      refId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].ExternalColumns[Net_Agg]"
                      codePage="1252"
                      dataType="str"
                      length="6"
                      name="Net_Agg" />
                    <externalMetadataColumn
                      refId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].ExternalColumns[Subject_Code_10]"
                      codePage="1252"
                      dataType="str"
                      length="4"
                      name="Subject_Code_10" />
                    <externalMetadataColumn
                      refId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].ExternalColumns[Subject_Code_11]"
                      codePage="1252"
                      dataType="str"
                      length="4"
                      name="Subject_Code_11" />
                    <externalMetadataColumn
                      refId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].ExternalColumns[Subject_Code_12]"
                      codePage="1252"
                      dataType="str"
                      length="4"
                      name="Subject_Code_12" />
                    <externalMetadataColumn
                      refId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].ExternalColumns[Subject_Code_1]"
                      codePage="1252"
                      dataType="str"
                      length="4"
                      name="Subject_Code_1" />
                    <externalMetadataColumn
                      refId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].ExternalColumns[Subject_Code_2]"
                      codePage="1252"
                      dataType="str"
                      length="4"
                      name="Subject_Code_2" />
                    <externalMetadataColumn
                      refId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].ExternalColumns[Subject_Code_3]"
                      codePage="1252"
                      dataType="str"
                      length="4"
                      name="Subject_Code_3" />
                    <externalMetadataColumn
                      refId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].ExternalColumns[Subject_Code_4]"
                      codePage="1252"
                      dataType="str"
                      length="4"
                      name="Subject_Code_4" />
                    <externalMetadataColumn
                      refId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].ExternalColumns[Subject_Code_5]"
                      codePage="1252"
                      dataType="str"
                      length="4"
                      name="Subject_Code_5" />
                    <externalMetadataColumn
                      refId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].ExternalColumns[Subject_Code_6]"
                      codePage="1252"
                      dataType="str"
                      length="4"
                      name="Subject_Code_6" />
                    <externalMetadataColumn
                      refId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].ExternalColumns[Subject_Code_7]"
                      codePage="1252"
                      dataType="str"
                      length="4"
                      name="Subject_Code_7" />
                    <externalMetadataColumn
                      refId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].ExternalColumns[Subject_Code_8]"
                      codePage="1252"
                      dataType="str"
                      length="4"
                      name="Subject_Code_8" />
                    <externalMetadataColumn
                      refId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].ExternalColumns[Subject_Code_9]"
                      codePage="1252"
                      dataType="str"
                      length="4"
                      name="Subject_Code_9" />
                    <externalMetadataColumn
                      refId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].ExternalColumns[Grade_10]"
                      codePage="1252"
                      dataType="str"
                      length="1"
                      name="Grade_10" />
                    <externalMetadataColumn
                      refId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].ExternalColumns[Grade_11]"
                      codePage="1252"
                      dataType="str"
                      length="1"
                      name="Grade_11" />
                    <externalMetadataColumn
                      refId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].ExternalColumns[Grade_12]"
                      codePage="1252"
                      dataType="str"
                      length="1"
                      name="Grade_12" />
                    <externalMetadataColumn
                      refId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].ExternalColumns[Grade_1]"
                      codePage="1252"
                      dataType="str"
                      length="1"
                      name="Grade_1" />
                    <externalMetadataColumn
                      refId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].ExternalColumns[Grade_2]"
                      codePage="1252"
                      dataType="str"
                      length="1"
                      name="Grade_2" />
                    <externalMetadataColumn
                      refId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].ExternalColumns[Grade_3]"
                      codePage="1252"
                      dataType="str"
                      length="1"
                      name="Grade_3" />
                    <externalMetadataColumn
                      refId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].ExternalColumns[Grade_4]"
                      codePage="1252"
                      dataType="str"
                      length="1"
                      name="Grade_4" />
                    <externalMetadataColumn
                      refId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].ExternalColumns[Grade_5]"
                      codePage="1252"
                      dataType="str"
                      length="1"
                      name="Grade_5" />
                    <externalMetadataColumn
                      refId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].ExternalColumns[Grade_6]"
                      codePage="1252"
                      dataType="str"
                      length="1"
                      name="Grade_6" />
                    <externalMetadataColumn
                      refId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].ExternalColumns[Grade_7]"
                      codePage="1252"
                      dataType="str"
                      length="1"
                      name="Grade_7" />
                    <externalMetadataColumn
                      refId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].ExternalColumns[Grade_8]"
                      codePage="1252"
                      dataType="str"
                      length="1"
                      name="Grade_8" />
                    <externalMetadataColumn
                      refId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].ExternalColumns[Grade_9]"
                      codePage="1252"
                      dataType="str"
                      length="1"
                      name="Grade_9" />
                    <externalMetadataColumn
                      refId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].ExternalColumns[yearexam]"
                      codePage="1252"
                      dataType="str"
                      length="4"
                      name="yearexam" />
                  </externalMetadataColumns>
                </input>
              </inputs>
            </component>
            <component
              refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM"
              componentClassID="Microsoft.OLEDBSource"
              contactInfo="OLE DB Source;Microsoft Corporation; Microsoft SQL Server; (C) Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;7"
              description="OLE DB Source"
              name="OLE_SRC_ReadDM"
              usesDispositions="true"
              version="7">
              <properties>
                <property
                  dataType="System.Int32"
                  description="The number of seconds before a command times out.  A value of 0 indicates an infinite time-out."
                  name="CommandTimeout">0</property>
                <property
                  dataType="System.String"
                  description="Specifies the name of the database object used to open a rowset."
                  name="OpenRowset"></property>
                <property
                  dataType="System.String"
                  description="Specifies the variable that contains the name of the database object used to open a rowset."
                  name="OpenRowsetVariable"></property>
                <property
                  dataType="System.String"
                  description="The SQL command to be executed."
                  name="SqlCommand"
                  UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor, Microsoft.DataTransformationServices.Controls, Version=15.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91">SELECT * FROM dbo.DW_ENT_POLY_APPLICANT</property>
                <property
                  dataType="System.String"
                  description="The variable that contains the SQL command to be executed."
                  name="SqlCommandVariable"></property>
                <property
                  dataType="System.Int32"
                  description="Specifies the column code page to use when code page information is unavailable from the data source."
                  name="DefaultCodePage">1252</property>
                <property
                  dataType="System.Boolean"
                  description="Forces the use of the DefaultCodePage property value when describing character data."
                  name="AlwaysUseDefaultCodePage">false</property>
                <property
                  dataType="System.Int32"
                  description="Specifies the mode used to access the database."
                  name="AccessMode"
                  typeConverter="AccessMode">2</property>
                <property
                  dataType="System.String"
                  description="The mappings between the parameters in the SQL command and variables."
                  name="ParameterMapping"></property>
              </properties>
              <connections>
                <connection
                  refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Connections[OleDbConnection]"
                  connectionManagerID="{4E74D30E-4295-488F-A407-AD1DC4921EC7}:external"
                  connectionManagerRefId="Project.ConnectionManagers[RPDW_USR_Conn]"
                  description="The OLE DB runtime connection used to access the database."
                  name="OleDbConnection" />
              </connections>
              <outputs>
                <output
                  refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output]"
                  name="OLE DB Source Output">
                  <outputColumns>
                    <outputColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[EMPLID]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].ExternalColumns[EMPLID]"
                      length="11"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[EMPLID]"
                      name="EMPLID"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[Acad_Year]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].ExternalColumns[Acad_Year]"
                      length="6"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[Acad_Year]"
                      name="Acad_Year"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[Admission_Exercise]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].ExternalColumns[Admission_Exercise]"
                      length="100"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[Admission_Exercise]"
                      name="Admission_Exercise"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[Admit_Term]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].ExternalColumns[Admit_Term]"
                      length="4"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[Admit_Term]"
                      name="Admit_Term"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[Application_Number]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].ExternalColumns[Application_Number]"
                      length="8"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[Application_Number]"
                      name="Application_Number"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[Sec_School_Code]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].ExternalColumns[Sec_School_Code]"
                      length="10"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[Sec_School_Code]"
                      name="Sec_School_Code"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[Raw_Agg]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].ExternalColumns[Raw_Agg]"
                      length="6"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[Raw_Agg]"
                      name="Raw_Agg"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[Net_Agg]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].ExternalColumns[Net_Agg]"
                      length="6"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[Net_Agg]"
                      name="Net_Agg"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[Subject_Code_10]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].ExternalColumns[Subject_Code_10]"
                      length="10"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[Subject_Code_10]"
                      name="Subject_Code_10"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[Subject_Code_11]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].ExternalColumns[Subject_Code_11]"
                      length="10"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[Subject_Code_11]"
                      name="Subject_Code_11"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[Subject_Code_12]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].ExternalColumns[Subject_Code_12]"
                      length="10"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[Subject_Code_12]"
                      name="Subject_Code_12"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[Subject_Code_1]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].ExternalColumns[Subject_Code_1]"
                      length="10"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[Subject_Code_1]"
                      name="Subject_Code_1"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[Subject_Code_2]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].ExternalColumns[Subject_Code_2]"
                      length="10"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[Subject_Code_2]"
                      name="Subject_Code_2"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[Subject_Code_3]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].ExternalColumns[Subject_Code_3]"
                      length="10"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[Subject_Code_3]"
                      name="Subject_Code_3"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[Subject_Code_4]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].ExternalColumns[Subject_Code_4]"
                      length="10"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[Subject_Code_4]"
                      name="Subject_Code_4"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[Subject_Code_5]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].ExternalColumns[Subject_Code_5]"
                      length="10"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[Subject_Code_5]"
                      name="Subject_Code_5"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[Subject_Code_6]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].ExternalColumns[Subject_Code_6]"
                      length="10"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[Subject_Code_6]"
                      name="Subject_Code_6"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[Subject_Code_7]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].ExternalColumns[Subject_Code_7]"
                      length="10"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[Subject_Code_7]"
                      name="Subject_Code_7"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[Subject_Code_8]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].ExternalColumns[Subject_Code_8]"
                      length="10"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[Subject_Code_8]"
                      name="Subject_Code_8"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[Subject_Code_9]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].ExternalColumns[Subject_Code_9]"
                      length="10"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[Subject_Code_9]"
                      name="Subject_Code_9"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[Grade_10]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].ExternalColumns[Grade_10]"
                      length="4"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[Grade_10]"
                      name="Grade_10"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[Grade_11]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].ExternalColumns[Grade_11]"
                      length="4"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[Grade_11]"
                      name="Grade_11"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[Grade_12]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].ExternalColumns[Grade_12]"
                      length="4"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[Grade_12]"
                      name="Grade_12"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[Grade_1]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].ExternalColumns[Grade_1]"
                      length="4"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[Grade_1]"
                      name="Grade_1"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[Grade_2]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].ExternalColumns[Grade_2]"
                      length="4"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[Grade_2]"
                      name="Grade_2"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[Grade_3]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].ExternalColumns[Grade_3]"
                      length="4"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[Grade_3]"
                      name="Grade_3"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[Grade_4]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].ExternalColumns[Grade_4]"
                      length="4"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[Grade_4]"
                      name="Grade_4"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[Grade_5]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].ExternalColumns[Grade_5]"
                      length="4"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[Grade_5]"
                      name="Grade_5"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[Grade_6]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].ExternalColumns[Grade_6]"
                      length="4"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[Grade_6]"
                      name="Grade_6"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[Grade_7]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].ExternalColumns[Grade_7]"
                      length="4"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[Grade_7]"
                      name="Grade_7"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[Grade_8]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].ExternalColumns[Grade_8]"
                      length="4"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[Grade_8]"
                      name="Grade_8"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[Grade_9]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].ExternalColumns[Grade_9]"
                      length="4"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[Grade_9]"
                      name="Grade_9"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[yearexam]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].ExternalColumns[yearexam]"
                      length="4"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[yearexam]"
                      name="yearexam"
                      truncationRowDisposition="FailComponent" />
                  </outputColumns>
                  <externalMetadataColumns
                    isUsed="True">
                    <externalMetadataColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].ExternalColumns[CREATED_ON]"
                      dataType="dbTimeStamp"
                      name="CREATED_ON" />
                    <externalMetadataColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].ExternalColumns[MODIFIED_ON]"
                      dataType="dbTimeStamp"
                      name="MODIFIED_ON" />
                    <externalMetadataColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].ExternalColumns[Admission_Exercise]"
                      codePage="1252"
                      dataType="str"
                      length="100"
                      name="Admission_Exercise" />
                    <externalMetadataColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].ExternalColumns[Admit_Term]"
                      codePage="1252"
                      dataType="str"
                      length="4"
                      name="Admit_Term" />
                    <externalMetadataColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].ExternalColumns[EMPLID]"
                      codePage="1252"
                      dataType="str"
                      length="11"
                      name="EMPLID" />
                    <externalMetadataColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].ExternalColumns[Acad_Year]"
                      codePage="1252"
                      dataType="str"
                      length="6"
                      name="Acad_Year" />
                    <externalMetadataColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].ExternalColumns[Application_Number]"
                      codePage="1252"
                      dataType="str"
                      length="8"
                      name="Application_Number" />
                    <externalMetadataColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].ExternalColumns[Sec_School_Code]"
                      codePage="1252"
                      dataType="str"
                      length="10"
                      name="Sec_School_Code" />
                    <externalMetadataColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].ExternalColumns[Raw_Agg]"
                      codePage="1252"
                      dataType="str"
                      length="6"
                      name="Raw_Agg" />
                    <externalMetadataColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].ExternalColumns[Net_Agg]"
                      codePage="1252"
                      dataType="str"
                      length="6"
                      name="Net_Agg" />
                    <externalMetadataColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].ExternalColumns[Subject_Code_10]"
                      codePage="1252"
                      dataType="str"
                      length="10"
                      name="Subject_Code_10" />
                    <externalMetadataColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].ExternalColumns[Subject_Code_11]"
                      codePage="1252"
                      dataType="str"
                      length="10"
                      name="Subject_Code_11" />
                    <externalMetadataColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].ExternalColumns[Subject_Code_12]"
                      codePage="1252"
                      dataType="str"
                      length="10"
                      name="Subject_Code_12" />
                    <externalMetadataColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].ExternalColumns[Subject_Code_1]"
                      codePage="1252"
                      dataType="str"
                      length="10"
                      name="Subject_Code_1" />
                    <externalMetadataColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].ExternalColumns[Subject_Code_2]"
                      codePage="1252"
                      dataType="str"
                      length="10"
                      name="Subject_Code_2" />
                    <externalMetadataColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].ExternalColumns[Subject_Code_3]"
                      codePage="1252"
                      dataType="str"
                      length="10"
                      name="Subject_Code_3" />
                    <externalMetadataColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].ExternalColumns[Subject_Code_4]"
                      codePage="1252"
                      dataType="str"
                      length="10"
                      name="Subject_Code_4" />
                    <externalMetadataColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].ExternalColumns[Subject_Code_5]"
                      codePage="1252"
                      dataType="str"
                      length="10"
                      name="Subject_Code_5" />
                    <externalMetadataColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].ExternalColumns[Subject_Code_6]"
                      codePage="1252"
                      dataType="str"
                      length="10"
                      name="Subject_Code_6" />
                    <externalMetadataColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].ExternalColumns[Subject_Code_7]"
                      codePage="1252"
                      dataType="str"
                      length="10"
                      name="Subject_Code_7" />
                    <externalMetadataColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].ExternalColumns[Subject_Code_8]"
                      codePage="1252"
                      dataType="str"
                      length="10"
                      name="Subject_Code_8" />
                    <externalMetadataColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].ExternalColumns[Subject_Code_9]"
                      codePage="1252"
                      dataType="str"
                      length="10"
                      name="Subject_Code_9" />
                    <externalMetadataColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].ExternalColumns[Grade_10]"
                      codePage="1252"
                      dataType="str"
                      length="4"
                      name="Grade_10" />
                    <externalMetadataColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].ExternalColumns[Grade_11]"
                      codePage="1252"
                      dataType="str"
                      length="4"
                      name="Grade_11" />
                    <externalMetadataColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].ExternalColumns[Grade_12]"
                      codePage="1252"
                      dataType="str"
                      length="4"
                      name="Grade_12" />
                    <externalMetadataColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].ExternalColumns[Grade_1]"
                      codePage="1252"
                      dataType="str"
                      length="4"
                      name="Grade_1" />
                    <externalMetadataColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].ExternalColumns[Grade_2]"
                      codePage="1252"
                      dataType="str"
                      length="4"
                      name="Grade_2" />
                    <externalMetadataColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].ExternalColumns[Grade_3]"
                      codePage="1252"
                      dataType="str"
                      length="4"
                      name="Grade_3" />
                    <externalMetadataColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].ExternalColumns[Grade_4]"
                      codePage="1252"
                      dataType="str"
                      length="4"
                      name="Grade_4" />
                    <externalMetadataColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].ExternalColumns[Grade_5]"
                      codePage="1252"
                      dataType="str"
                      length="4"
                      name="Grade_5" />
                    <externalMetadataColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].ExternalColumns[Grade_6]"
                      codePage="1252"
                      dataType="str"
                      length="4"
                      name="Grade_6" />
                    <externalMetadataColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].ExternalColumns[Grade_7]"
                      codePage="1252"
                      dataType="str"
                      length="4"
                      name="Grade_7" />
                    <externalMetadataColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].ExternalColumns[Grade_8]"
                      codePage="1252"
                      dataType="str"
                      length="4"
                      name="Grade_8" />
                    <externalMetadataColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].ExternalColumns[Grade_9]"
                      codePage="1252"
                      dataType="str"
                      length="4"
                      name="Grade_9" />
                    <externalMetadataColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].ExternalColumns[yearexam]"
                      codePage="1252"
                      dataType="str"
                      length="4"
                      name="yearexam" />
                  </externalMetadataColumns>
                </output>
                <output
                  refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Error Output]"
                  isErrorOut="true"
                  name="OLE DB Source Error Output">
                  <outputColumns>
                    <outputColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Error Output].Columns[ErrorCode]"
                      dataType="i4"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Error Output].Columns[ErrorCode]"
                      name="ErrorCode"
                      specialFlags="1" />
                    <outputColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Error Output].Columns[ErrorColumn]"
                      dataType="i4"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Error Output].Columns[ErrorColumn]"
                      name="ErrorColumn"
                      specialFlags="2" />
                    <outputColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Error Output].Columns[EMPLID]"
                      codePage="1252"
                      dataType="str"
                      length="11"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Error Output].Columns[EMPLID]"
                      name="EMPLID" />
                    <outputColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Error Output].Columns[Acad_Year]"
                      codePage="1252"
                      dataType="str"
                      length="6"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Error Output].Columns[Acad_Year]"
                      name="Acad_Year" />
                    <outputColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Error Output].Columns[Admission_Exercise]"
                      codePage="1252"
                      dataType="str"
                      length="100"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Error Output].Columns[Admission_Exercise]"
                      name="Admission_Exercise" />
                    <outputColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Error Output].Columns[Admit_Term]"
                      codePage="1252"
                      dataType="str"
                      length="4"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Error Output].Columns[Admit_Term]"
                      name="Admit_Term" />
                    <outputColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Error Output].Columns[Application_Number]"
                      codePage="1252"
                      dataType="str"
                      length="8"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Error Output].Columns[Application_Number]"
                      name="Application_Number" />
                    <outputColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Error Output].Columns[Sec_School_Code]"
                      codePage="1252"
                      dataType="str"
                      length="10"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Error Output].Columns[Sec_School_Code]"
                      name="Sec_School_Code" />
                    <outputColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Error Output].Columns[Raw_Agg]"
                      codePage="1252"
                      dataType="str"
                      length="6"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Error Output].Columns[Raw_Agg]"
                      name="Raw_Agg" />
                    <outputColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Error Output].Columns[Net_Agg]"
                      codePage="1252"
                      dataType="str"
                      length="6"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Error Output].Columns[Net_Agg]"
                      name="Net_Agg" />
                    <outputColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Error Output].Columns[Subject_Code_10]"
                      codePage="1252"
                      dataType="str"
                      length="10"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Error Output].Columns[Subject_Code_10]"
                      name="Subject_Code_10" />
                    <outputColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Error Output].Columns[Subject_Code_11]"
                      codePage="1252"
                      dataType="str"
                      length="10"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Error Output].Columns[Subject_Code_11]"
                      name="Subject_Code_11" />
                    <outputColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Error Output].Columns[Subject_Code_12]"
                      codePage="1252"
                      dataType="str"
                      length="10"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Error Output].Columns[Subject_Code_12]"
                      name="Subject_Code_12" />
                    <outputColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Error Output].Columns[Subject_Code_1]"
                      codePage="1252"
                      dataType="str"
                      length="10"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Error Output].Columns[Subject_Code_1]"
                      name="Subject_Code_1" />
                    <outputColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Error Output].Columns[Subject_Code_2]"
                      codePage="1252"
                      dataType="str"
                      length="10"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Error Output].Columns[Subject_Code_2]"
                      name="Subject_Code_2" />
                    <outputColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Error Output].Columns[Subject_Code_3]"
                      codePage="1252"
                      dataType="str"
                      length="10"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Error Output].Columns[Subject_Code_3]"
                      name="Subject_Code_3" />
                    <outputColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Error Output].Columns[Subject_Code_4]"
                      codePage="1252"
                      dataType="str"
                      length="10"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Error Output].Columns[Subject_Code_4]"
                      name="Subject_Code_4" />
                    <outputColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Error Output].Columns[Subject_Code_5]"
                      codePage="1252"
                      dataType="str"
                      length="10"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Error Output].Columns[Subject_Code_5]"
                      name="Subject_Code_5" />
                    <outputColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Error Output].Columns[Subject_Code_6]"
                      codePage="1252"
                      dataType="str"
                      length="10"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Error Output].Columns[Subject_Code_6]"
                      name="Subject_Code_6" />
                    <outputColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Error Output].Columns[Subject_Code_7]"
                      codePage="1252"
                      dataType="str"
                      length="10"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Error Output].Columns[Subject_Code_7]"
                      name="Subject_Code_7" />
                    <outputColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Error Output].Columns[Subject_Code_8]"
                      codePage="1252"
                      dataType="str"
                      length="10"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Error Output].Columns[Subject_Code_8]"
                      name="Subject_Code_8" />
                    <outputColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Error Output].Columns[Subject_Code_9]"
                      codePage="1252"
                      dataType="str"
                      length="10"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Error Output].Columns[Subject_Code_9]"
                      name="Subject_Code_9" />
                    <outputColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Error Output].Columns[Grade_10]"
                      codePage="1252"
                      dataType="str"
                      length="4"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Error Output].Columns[Grade_10]"
                      name="Grade_10" />
                    <outputColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Error Output].Columns[Grade_11]"
                      codePage="1252"
                      dataType="str"
                      length="4"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Error Output].Columns[Grade_11]"
                      name="Grade_11" />
                    <outputColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Error Output].Columns[Grade_12]"
                      codePage="1252"
                      dataType="str"
                      length="4"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Error Output].Columns[Grade_12]"
                      name="Grade_12" />
                    <outputColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Error Output].Columns[Grade_1]"
                      codePage="1252"
                      dataType="str"
                      length="4"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Error Output].Columns[Grade_1]"
                      name="Grade_1" />
                    <outputColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Error Output].Columns[Grade_2]"
                      codePage="1252"
                      dataType="str"
                      length="4"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Error Output].Columns[Grade_2]"
                      name="Grade_2" />
                    <outputColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Error Output].Columns[Grade_3]"
                      codePage="1252"
                      dataType="str"
                      length="4"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Error Output].Columns[Grade_3]"
                      name="Grade_3" />
                    <outputColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Error Output].Columns[Grade_4]"
                      codePage="1252"
                      dataType="str"
                      length="4"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Error Output].Columns[Grade_4]"
                      name="Grade_4" />
                    <outputColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Error Output].Columns[Grade_5]"
                      codePage="1252"
                      dataType="str"
                      length="4"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Error Output].Columns[Grade_5]"
                      name="Grade_5" />
                    <outputColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Error Output].Columns[Grade_6]"
                      codePage="1252"
                      dataType="str"
                      length="4"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Error Output].Columns[Grade_6]"
                      name="Grade_6" />
                    <outputColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Error Output].Columns[Grade_7]"
                      codePage="1252"
                      dataType="str"
                      length="4"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Error Output].Columns[Grade_7]"
                      name="Grade_7" />
                    <outputColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Error Output].Columns[Grade_8]"
                      codePage="1252"
                      dataType="str"
                      length="4"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Error Output].Columns[Grade_8]"
                      name="Grade_8" />
                    <outputColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Error Output].Columns[Grade_9]"
                      codePage="1252"
                      dataType="str"
                      length="4"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Error Output].Columns[Grade_9]"
                      name="Grade_9" />
                    <outputColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Error Output].Columns[yearexam]"
                      codePage="1252"
                      dataType="str"
                      length="4"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Error Output].Columns[yearexam]"
                      name="yearexam" />
                  </outputColumns>
                  <externalMetadataColumns />
                </output>
              </outputs>
            </component>
          </components>
          <paths>
            <path
              refId="Package\DFT_ExportDMtoTXT.Paths[OLE DB Source Output]"
              endId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input]"
              name="OLE DB Source Output"
              startId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output]" />
          </paths>
        </pipeline>
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\ESQL_CreateETLJobLog"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{5A5C0F8C-2338-423E-AFED-E2A7F0A8E879}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="ESQL_CreateETLJobLog"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{4E74D30E-4295-488F-A407-AD1DC4921EC7}"
          SQLTask:SqlStatementSource="Exec [dbo].[usp_InsertETLJobLog] ?, ?, ?, ?" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
          <SQLTask:ParameterBinding
            SQLTask:ParameterName="0"
            SQLTask:DtsVariableName="User::Job_name"
            SQLTask:ParameterDirection="Input"
            SQLTask:DataType="129"
            SQLTask:ParameterSize="-1" />
          <SQLTask:ParameterBinding
            SQLTask:ParameterName="1"
            SQLTask:DtsVariableName="User::STAGE"
            SQLTask:ParameterDirection="Input"
            SQLTask:DataType="129"
            SQLTask:ParameterSize="-1" />
          <SQLTask:ParameterBinding
            SQLTask:ParameterName="2"
            SQLTask:DtsVariableName="User::SourceTable"
            SQLTask:ParameterDirection="Input"
            SQLTask:DataType="129"
            SQLTask:ParameterSize="-1" />
          <SQLTask:ParameterBinding
            SQLTask:ParameterName="3"
            SQLTask:DtsVariableName="User::TgtTableName"
            SQLTask:ParameterDirection="Input"
            SQLTask:DataType="129"
            SQLTask:ParameterSize="-1" />
        </SQLTask:SqlTaskData>
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\ESQL_GetProcessDate"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{B0541057-B23C-4F72-AA91-ECF9DCF38F05}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="ESQL_GetProcessDate"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{4E74D30E-4295-488F-A407-AD1DC4921EC7}"
          SQLTask:SqlStatementSource="Select getdate()"
          SQLTask:ResultType="ResultSetType_SingleRow" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
          <SQLTask:ResultBinding
            SQLTask:ResultName="0"
            SQLTask:DtsVariableName="User::Process_date" />
          <SQLTask:ParameterBinding
            SQLTask:ParameterName="0"
            SQLTask:DtsVariableName="User::Process_date"
            SQLTask:ParameterDirection="Input"
            SQLTask:DataType="135"
            SQLTask:ParameterSize="-1" />
        </SQLTask:SqlTaskData>
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\ESQL_Get_JOB_STATUS_ID"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{E9649C92-679D-4154-9F18-629D0FACCA60}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="ESQL_Get_JOB_STATUS_ID"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{4E74D30E-4295-488F-A407-AD1DC4921EC7}"
          SQLTask:SqlStatementSource="SELECT max([JOB_STATUS_ID])&#xA;FROM [dbo].[ETL_JOB_STATUS] where [JOB_NAME]=? &#xA;and convert(varchar(8),CREATED_ON,112)=convert(varchar(8) ,getdate(),112)"
          SQLTask:ResultType="ResultSetType_SingleRow" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
          <SQLTask:ResultBinding
            SQLTask:ResultName="0"
            SQLTask:DtsVariableName="User::JOB_STATUS_ID" />
          <SQLTask:ParameterBinding
            SQLTask:ParameterName="0"
            SQLTask:DtsVariableName="User::Job_name"
            SQLTask:ParameterDirection="Input"
            SQLTask:DataType="129"
            SQLTask:ParameterSize="-1" />
        </SQLTask:SqlTaskData>
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\ESQL_LoadIntoDM"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{2750E2B5-574A-4E2D-81D8-3DEC8D39A048}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="ESQL_LoadIntoDM"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{4E74D30E-4295-488F-A407-AD1DC4921EC7}"
          SQLTask:SqlStmtSourceType="Variable"
          SQLTask:SqlStatementSource="User::SQL_DM_Load" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\ESQL_UpdateJobStatus"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{3240A2F9-CACA-4061-BCAA-80153B50B326}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="ESQL_UpdateJobStatus"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{4E74D30E-4295-488F-A407-AD1DC4921EC7}"
          SQLTask:SqlStatementSource="DECLARE&#xA;@jobstatusid INT&#xA;;&#xA;&#xA;select @jobstatusid=?;&#xA;&#xA;IF exists(select * from dbo.ETL_ERROR_LOG where [JOB_STATUS_ID]=@jobstatusid)&#xA;BEGIN&#xA;Update [dbo].[ETL_JOB_STATUS]&#xA;SET [PROCESSED_ON] =getdate(),&#xA;[JOB_STATUS]='Fail'&#xA;where [JOB_STATUS_ID]=@jobstatusid&#xA;END&#xA;ELSE&#xA;BEGIN&#xA;Update [dbo].[ETL_JOB_STATUS]&#xA;SET [PROCESSED_ON] =getdate(),&#xA;[JOB_STATUS]='Success'&#xA;where [JOB_STATUS_ID]=@jobstatusid&#xA;END&#xA;;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
          <SQLTask:ParameterBinding
            SQLTask:ParameterName="0"
            SQLTask:DtsVariableName="User::JOB_STATUS_ID"
            SQLTask:ParameterDirection="Input"
            SQLTask:DataType="131"
            SQLTask:ParameterSize="-1" />
        </SQLTask:SqlTaskData>
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\ESQL_ValidateCurrentJobStatus"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{AA3ADA71-EBBA-4D1C-8C02-C6A0E7A0EB16}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="ESQL_ValidateCurrentJobStatus"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{4E74D30E-4295-488F-A407-AD1DC4921EC7}"
          SQLTask:SqlStatementSource="SELECT CASE WHEN JOB_STATUS='Success' then 0 ELSE 1 END AS  JOB_STATUS&#xA;&#xA;from [dbo].[ETL_JOB_STATUS]&#xA;  where JOB_STATUS_ID = ?"
          SQLTask:ResultType="ResultSetType_SingleRow" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
          <SQLTask:ResultBinding
            SQLTask:ResultName="JOB_STATUS"
            SQLTask:DtsVariableName="User::Job_Status" />
          <SQLTask:ParameterBinding
            SQLTask:ParameterName="0"
            SQLTask:DtsVariableName="User::JOB_STATUS_ID"
            SQLTask:ParameterDirection="Input"
            SQLTask:DataType="131"
            SQLTask:ParameterSize="-1" />
        </SQLTask:SqlTaskData>
      </DTS:ObjectData>
    </DTS:Executable>
  </DTS:Executables>
  <DTS:PrecedenceConstraints>
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint]"
      DTS:CreationName=""
      DTS:DTSID="{6FE7447B-63AA-4CA5-8379-15D0FD2DD44A}"
      DTS:From="Package\ESQL_GetProcessDate"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint"
      DTS:To="Package\ESQL_LoadIntoDM" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 1]"
      DTS:CreationName=""
      DTS:DTSID="{04036041-A328-4ADB-B686-68B71EDA6645}"
      DTS:From="Package\ESQL_LoadIntoDM"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 1"
      DTS:To="Package\ESQL_UpdateJobStatus" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 2]"
      DTS:CreationName=""
      DTS:DTSID="{DF275737-62F9-4963-8454-A232E256443B}"
      DTS:From="Package\ESQL_CreateETLJobLog"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 2"
      DTS:To="Package\ESQL_Get_JOB_STATUS_ID" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 3]"
      DTS:CreationName=""
      DTS:DTSID="{8C1F319C-67BE-4BE3-B8C6-421A79417AB6}"
      DTS:From="Package\ESQL_Get_JOB_STATUS_ID"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 3"
      DTS:To="Package\ESQL_GetProcessDate" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 4]"
      DTS:CreationName=""
      DTS:DTSID="{8C19CDF7-30A0-4DB8-8F88-6E0F9A2918DC}"
      DTS:From="Package\ESQL_UpdateJobStatus"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 4"
      DTS:To="Package\ESQL_ValidateCurrentJobStatus" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 5]"
      DTS:CreationName=""
      DTS:DTSID="{854F153E-F0FE-425C-BAB9-B4DCE081A0A8}"
      DTS:EvalOp="1"
      DTS:Expression="@[User::Job_Status]==0"
      DTS:From="Package\ESQL_ValidateCurrentJobStatus"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 5"
      DTS:To="Package\DFT_ExportDMtoTXT" />
  </DTS:PrecedenceConstraints>
  <DTS:EventHandlers>
    <DTS:EventHandler
      DTS:refId="Package.EventHandlers[OnError]"
      DTS:CreationName="OnError"
      DTS:DTSID="{BD5F90AA-4C0E-435D-8112-346A35256C5B}"
      DTS:EventID="0"
      DTS:EventName="OnError"
      DTS:LocaleID="-1">
      <DTS:Variables>
        <DTS:Variable
          DTS:CreationName=""
          DTS:Description="The propagate property of the event"
          DTS:DTSID="{780726CA-C16A-47AB-AC6F-B3D72B8C6ED8}"
          DTS:IncludeInDebugDump="6789"
          DTS:Namespace="System"
          DTS:ObjectName="Propagate">
          <DTS:VariableValue
            DTS:DataType="11">-1</DTS:VariableValue>
        </DTS:Variable>
      </DTS:Variables>
      <DTS:Executables>
        <DTS:Executable
          DTS:refId="Package.EventHandlers[OnError]\ETL_ERROR_LOG"
          DTS:CreationName="Microsoft.ExecuteSQLTask"
          DTS:Description="Execute SQL Task"
          DTS:DTSID="{5117B380-93D9-4A8B-A712-7B1083574952}"
          DTS:ExecutableType="Microsoft.ExecuteSQLTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="ETL_ERROR_LOG">
          <DTS:Variables />
          <DTS:ObjectData>
            <SQLTask:SqlTaskData
              SQLTask:Connection="{4E74D30E-4295-488F-A407-AD1DC4921EC7}"
              SQLTask:SqlStatementSource="[dbo].[usp_InsertETLErrorLog] ?, ?" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="0"
                SQLTask:DtsVariableName="User::JOB_STATUS_ID"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="131"
                SQLTask:ParameterSize="-1" />
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="1"
                SQLTask:DtsVariableName="System::ErrorDescription"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="130"
                SQLTask:ParameterSize="-1" />
            </SQLTask:SqlTaskData>
          </DTS:ObjectData>
        </DTS:Executable>
      </DTS:Executables>
    </DTS:EventHandler>
  </DTS:EventHandlers>
  <DTS:DesignTimeProperties><![CDATA[<?xml version="1.0"?>
<!--This CDATA section contains the layout information of the package. The section includes information such as (x,y) coordinates, width, and height.-->
<!--If you manually edit this section and make a mistake, you can delete it. -->
<!--The package will still be able to load normally but the previous layout information will be lost and the designer will automatically re-arrange the elements on the design surface.-->
<Objects
  Version="8">
  <!--Each node below will contain properties that do not affect runtime behavior.-->
  <Package
    design-time-name="Package">
    <LayoutInfo>
      <GraphLayout
        Capacity="16" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:mssgm="clr-namespace:Microsoft.SqlServer.Graph.Model;assembly=Microsoft.SqlServer.Graph">
        <NodeLayout
          Size="185,42"
          Id="Package\DFT_ExportDMtoTXT"
          TopLeft="40,232" />
        <NodeLayout
          Size="204,42"
          Id="Package\ESQL_CreateETLJobLog"
          TopLeft="21,28" />
        <NodeLayout
          Size="226,42"
          Id="Package\ESQL_Get_JOB_STATUS_ID"
          TopLeft="287,27" />
        <NodeLayout
          Size="195,42"
          Id="Package\ESQL_GetProcessDate"
          TopLeft="598,27" />
        <NodeLayout
          Size="174,42"
          Id="Package\ESQL_LoadIntoDM"
          TopLeft="602,129" />
        <NodeLayout
          Size="199,42"
          Id="Package\ESQL_UpdateJobStatus"
          TopLeft="302,129" />
        <NodeLayout
          Size="240,42"
          Id="Package\ESQL_ValidateCurrentJobStatus"
          TopLeft="11,126" />
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint]"
          TopLeft="692.25,69">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,60"
              Start="0,0"
              End="0,52.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,52.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 1]"
          TopLeft="602,150">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="-101,0"
              Start="0,0"
              End="-93.5,0">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="-93.5,0" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 2]"
          TopLeft="225,48.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="62,0"
              Start="0,0"
              End="54.5,0">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="54.5,0" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 3]"
          TopLeft="513,48">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="85,0"
              Start="0,0"
              End="77.5,0">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="77.5,0" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 4]"
          TopLeft="302,148.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="-51,0"
              Start="0,0"
              End="-43.5,0">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="-43.5,0" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 5]"
          TopLeft="131.75,168">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,64"
              Start="0,0"
              End="0,56.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,56.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <mssgm:EdgeLabel
              BoundingBox="-8,20.25,16,16"
              RelativePosition="Any" />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </Package>
  <DtsEventHandler
    design-time-name="Package.EventHandlers[OnError]">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph">
        <NodeLayout
          Size="174,42"
          Id="Package.EventHandlers[OnError]\ETL_ERROR_LOG"
          TopLeft="5.5,5.5" />
      </GraphLayout>
    </LayoutInfo>
  </DtsEventHandler>
  <TaskHost
    design-time-name="Package\DFT_ExportDMtoTXT">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:mssgm="clr-namespace:Microsoft.SqlServer.Graph.Model;assembly=Microsoft.SqlServer.Graph">
        <NodeLayout
          Size="180,42"
          Id="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM"
          TopLeft="183,63" />
        <NodeLayout
          Size="181,42"
          Id="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput"
          TopLeft="182,175" />
        <EdgeLayout
          Id="Package\DFT_ExportDMtoTXT.Paths[OLE DB Source Output]"
          TopLeft="272.75,105">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,70"
              Start="0,0"
              End="0,62.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,62.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <mssgm:EdgeLabel
              BoundingBox="0,0,0,0"
              RelativePosition="Any" />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </TaskHost>
  <PipelineComponentMetadata
    design-time-name="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM">
    <Properties>
      <Property>
        <Name>DataSourceViewID</Name>
      </Property>
    </Properties>
  </PipelineComponentMetadata>
</Objects>]]></DTS:DesignTimeProperties>
</DTS:Executable>