<?xml version="1.0"?>
<DTS:Executable xmlns:DTS="www.microsoft.com/SqlServer/Dts"
  DTS:refId="Package"
  DTS:CreationDate="1/30/2019 1:46:31 PM"
  DTS:CreationName="Microsoft.Package"
  DTS:CreatorComputerName="NCS-110119GM22"
  DTS:CreatorName="NCS\P0500388"
  DTS:DelayValidation="True"
  DTS:DTSID="{3C7AE54C-D288-4AEA-B6BC-F6CEE5BB825A}"
  DTS:ExecutableType="Microsoft.Package"
  DTS:LastModifiedProductVersion="15.0.0900.40"
  DTS:LocaleID="18441"
  DTS:ObjectName="DW_ENT_STUDENT_MODULE_RESULT"
  DTS:PackageType="5"
  DTS:VersionBuild="362"
  DTS:VersionGUID="{F478FF60-129F-46DB-B0A7-03FF77213830}">
  <DTS:Property
    DTS:Name="PackageFormatVersion">8</DTS:Property>
  <DTS:ConnectionManagers>
    <DTS:ConnectionManager
      DTS:refId="Package.ConnectionManagers[OutputTextFile_Conn]"
      DTS:CreationName="FLATFILE"
      DTS:DTSID="{23A32890-6C62-49DD-AF6E-99986884954D}"
      DTS:ObjectName="OutputTextFile_Conn">
      <DTS:PropertyExpression
        DTS:Name="ConnectionString">@[$Project::FTP_LocalPath_Weekly] + @[User::Filename]  +  RIGHT ((DT_STR,4,1252)YEAR(GETDATE()),4) + RIGHT ("0" + (DT_STR,2,1252)MONTH(GETDATE()),2) + RIGHT ("0" + (DT_STR,2,1252)DAY(GETDATE()),2) + ".txt"</DTS:PropertyExpression>
      <DTS:ObjectData>
        <DTS:ConnectionManager
          DTS:Format="Delimited"
          DTS:LocaleID="1033"
          DTS:HeaderRowDelimiter="_x000D__x000A_"
          DTS:ColumnNamesInFirstDataRow="True"
          DTS:RowDelimiter=""
          DTS:TextQualifier="_x003C_none_x003E_"
          DTS:CodePage="1252"
          DTS:ConnectionString="E:\RPDW_USR\AIE\AIE_PRD\DW\Weekly\DW_moduleresult_20210317.txt">
          <DTS:FlatFileColumns>
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x007C__x003B_"
              DTS:MaximumWidth="4"
              DTS:DataType="129"
              DTS:TextQualified="True"
              DTS:ObjectName="Qual_Type"
              DTS:DTSID="{711E2CEC-D952-4FE0-875F-73DC477E6126}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x007C__x003B_"
              DTS:MaximumWidth="11"
              DTS:DataType="129"
              DTS:TextQualified="True"
              DTS:ObjectName="Student_Id"
              DTS:DTSID="{075F0EF5-7373-4458-8AD2-27AAE16BAD58}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x007C__x003B_"
              DTS:MaximumWidth="4"
              DTS:DataType="129"
              DTS:TextQualified="True"
              DTS:ObjectName="TERM"
              DTS:DTSID="{D6D37382-3F08-4FCB-B108-196CE2E4D9D7}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x007C__x003B_"
              DTS:MaximumWidth="10"
              DTS:DataType="129"
              DTS:TextQualified="True"
              DTS:ObjectName="Module_Code"
              DTS:DTSID="{A01FD462-B231-4CB2-B118-0028615C84A0}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x007C__x003B_"
              DTS:DataType="131"
              DTS:DataPrecision="18"
              DTS:DataScale="6"
              DTS:TextQualified="True"
              DTS:ObjectName="Average_Ca_Score"
              DTS:DTSID="{52CCA941-DBB2-4A35-81B0-085E58139D74}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x007C__x003B_"
              DTS:DataType="131"
              DTS:DataPrecision="18"
              DTS:DataScale="6"
              DTS:TextQualified="True"
              DTS:ObjectName="Average_Sa_Score"
              DTS:DTSID="{DAE63E21-A1C2-4476-820A-DC47A798CF8E}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x007C__x003B_"
              DTS:MaximumWidth="3"
              DTS:DataType="129"
              DTS:TextQualified="True"
              DTS:ObjectName="Final_Grade"
              DTS:DTSID="{8980BC1D-534A-4DCD-B11A-7BF84B602F01}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x007C__x003B_"
              DTS:DataType="131"
              DTS:DataPrecision="18"
              DTS:DataScale="6"
              DTS:TextQualified="True"
              DTS:ObjectName="Final_Grade_Score"
              DTS:DTSID="{4092EAE6-25D6-4043-83BC-FD7E042C13B5}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x007C__x003B_"
              DTS:MaximumWidth="4"
              DTS:DataType="129"
              DTS:TextQualified="True"
              DTS:ObjectName="Module_status"
              DTS:DTSID="{0D55FD7F-8A6F-4873-B241-39080D5C273D}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x007C__x003B_"
              DTS:DataType="3"
              DTS:TextQualified="True"
              DTS:ObjectName="No.Of.Attempts"
              DTS:DTSID="{057712F0-0284-41A1-BBCB-FF605CD68B0A}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x007C__x003B_"
              DTS:DataType="131"
              DTS:DataPrecision="8"
              DTS:DataScale="6"
              DTS:TextQualified="True"
              DTS:ObjectName="Credit_Units"
              DTS:DTSID="{0326A10A-904F-4BCD-A385-3D5EA2F7C5B7}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x000D__x000A_"
              DTS:DataType="3"
              DTS:TextQualified="True"
              DTS:ObjectName="Semester"
              DTS:DTSID="{586BD00B-6028-4EFC-BAEE-183FEA4D6C38}"
              DTS:CreationName="" />
          </DTS:FlatFileColumns>
        </DTS:ConnectionManager>
      </DTS:ObjectData>
    </DTS:ConnectionManager>
  </DTS:ConnectionManagers>
  <DTS:Variables>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{82E48258-0B25-4AEC-9241-87C76D83ED1C}"
      DTS:IncludeInDebugDump="6789"
      DTS:Namespace="User"
      DTS:ObjectName="DepCursorCnt">
      <DTS:VariableValue
        DTS:DataType="3">0</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{7C5B29EB-E726-4679-9550-B7949290295B}"
      DTS:IncludeInDebugDump="6789"
      DTS:Namespace="User"
      DTS:ObjectName="DepFailCnt">
      <DTS:VariableValue
        DTS:DataType="3">0</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{E27AC02D-9BD0-4940-A1E9-1195C618F464}"
      DTS:IncludeInDebugDump="6789"
      DTS:Namespace="User"
      DTS:ObjectName="DepSuccessCnt">
      <DTS:VariableValue
        DTS:DataType="3">0</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{6849A05E-58D2-49F6-B743-89E0DBEE2FF1}"
      DTS:IncludeInDebugDump="6789"
      DTS:Namespace="User"
      DTS:ObjectName="Duplicate_Check">
      <DTS:VariableValue
        DTS:DataType="3">0</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{C8DBD4DC-73FD-46E4-B2C7-4224AC841A80}"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="DWSourceTable">
      <DTS:VariableValue
        DTS:DataType="8">DW</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{F36781CC-8C0D-4229-BA6E-3E14832C2F37}"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="Filename">
      <DTS:VariableValue
        DTS:DataType="8">DW_moduleresult_</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{CD997008-C4D0-404E-8B7E-9CE7D14B611A}"
      DTS:EvaluateAsExpression="True"
      DTS:Expression="@[System::PackageName]"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="Job_name">
      <DTS:VariableValue
        DTS:DataType="8">DW_ENT_STUDENT_MODULE_RESULT</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{2E9624C7-809E-4337-9156-FF3CAE960276}"
      DTS:IncludeInDebugDump="6789"
      DTS:Namespace="User"
      DTS:ObjectName="Job_Status">
      <DTS:VariableValue
        DTS:DataType="3">0</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{F25BCA23-526A-45CD-A5A1-7013D74A0018}"
      DTS:IncludeInDebugDump="6789"
      DTS:Namespace="User"
      DTS:ObjectName="JOB_STATUS_ID">
      <DTS:VariableValue
        DTS:DataType="3">0</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{9F41D54A-5D7C-426C-AE19-74839C9BCDFA}"
      DTS:IncludeInDebugDump="6789"
      DTS:Namespace="User"
      DTS:ObjectName="Mandatory_constraint_Check">
      <DTS:VariableValue
        DTS:DataType="3">0</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{41A169FA-61BF-4C37-8885-48FCCB404EC9}"
      DTS:IncludeInDebugDump="6789"
      DTS:Namespace="User"
      DTS:ObjectName="Process_date">
      <DTS:VariableValue
        DTS:DataType="7">2/1/2019 2:58:00 PM</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{2314354B-9949-4CD8-AC29-71E5EED7BDC6}"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="SourceTable">
      <DTS:VariableValue
        DTS:DataType="8">DW_STUDENT_MODULE_GRADES,DW_LEO_GRADE,DW_LEO_GRADE_FINAL</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{BF0E3F7E-4153-44DC-A63E-F7E5D394FF8B}"
      DTS:EvaluateAsExpression="True"
      DTS:Expression="&quot;&quot;"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="SQL_CheckDepndcy">
      <DTS:VariableValue
        DTS:DataType="8"
        xml:space="preserve"></DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{C3E5B3CA-A87A-420B-B572-8DEA468A7B83}"
      DTS:EvaluateAsExpression="True"
      DTS:Expression="&quot;BEGIN TRANSACTION&#xA;BEGIN TRY&#xA;------------&#xA;IF OBJECT_ID(N'tempdb..##TMP_Module_Result') IS NOT NULL&#xA;BEGIN&#xA;  DROP TABLE ##TMP_Module_Result&#xA;END&#xA;&#xA;IF OBJECT_ID(N'tempdb..##TMP_TBL1') IS NOT NULL&#xA;BEGIN&#xA;  DROP TABLE ##TMP_TBL1&#xA;END&#xA;&#xA;IF OBJECT_ID(N'tempdb..##TMP_TBL2') IS NOT NULL&#xA;BEGIN&#xA;  DROP TABLE ##TMP_TBL2&#xA;END&#xA;&#xA;IF OBJECT_ID(N'tempdb..##TMP_TBL3') IS NOT NULL&#xA;BEGIN&#xA;  DROP TABLE ##TMP_TBL3&#xA;END&#xA;&#xA;IF OBJECT_ID(N'tempdb..##TMP_TBL3') IS NOT NULL&#xA;BEGIN&#xA;  DROP TABLE ##TMP_TBL3&#xA;END&#xA;&#xA;IF OBJECT_ID(N'tempdb..##TMP_TBL4') IS NOT NULL&#xA;BEGIN&#xA;  DROP TABLE ##TMP_TBL4&#xA;END&#xA;&#xA;DECLARE @jobstatusid varchar(5)&#xA;,@condition varchar(100)&#xA;,@filter_criteria varchar(100)&#xA;,@QUAL_TYPE varchar(100)&#xA;,@query nvarchar(max)&#xA;,@job_name varchar(100)&#xA;,@source_cnt INT&#xA;,@target_cnt INT&#xA;,@all_queries varchar(4000)&#xA;,@outputfilename varchar(200)&#xA;,@date1 varchar(10)&#xA;;&#xA;&#xA;SET @source_cnt=0;&#xA;SET @target_cnt=0;&#xA;&#xA;&#xA;select @jobstatusid=&quot;+ (DT_STR, 5,1252) @[User::JOB_STATUS_ID] +&quot;;&#xA;select @date1=convert(varchar(10),GETDATE(),112);&#xA;select @outputfilename=CONCAT('&quot;+ @[User::Filename] +&quot;',@date1,'.txt');&#xA;&#xA;&#xA;SELECT @filter_criteria=FILTER_CRITERIA, @QUAL_TYPE=QUAL_TYPE_CRITERIA FROM &quot;+ @[$Project::RPDW_USR_Initial_Catalog] +&quot;.[dbo].[ETL_JOB_PARAMS]  &#xA;WHERE JOB_NAME='&quot;+ @[User::Job_name] +&quot;';&#xA;&#xA;IF  @filter_criteria='FULL-LOAD' &#xA;  BEGIN&#xA;     SET @condition=';';&#xA;  END&#xA;ELSE IF @filter_criteria&lt;&gt;'' OR ISNULL(@filter_criteria,N'')&lt;&gt;'' &#xA;    BEGIN&#xA;&#x9;    SET @condition=CONCAT('AND ',@filter_criteria,';');&#xA;    END&#xA;; &#xA;&#xA;TRUNCATE TABLE &quot;+ @[$Project::RPDW_USR_Initial_Catalog] +&quot;.[dbo].&quot;+ @[User::TgtTableName]+&quot;  &#xA;;&#xA;&#xA;--[A] Read DW_STUDENT_MODULE_GRADES from based on group a.Qual_Type ,a.Student_Id, a.Acad_Term, a.Module_Code&#xA;-- Begin SET&#xA;SET @query=CONCAT(&#xA;    N'WITH UNQ_STUDENT_MGRADES AS ( &#xA;&#x9;SELECT &#xA;&#x9;&#x9; a.Qual_Type&#xA;&#x9;&#x9;,a.Student_Id&#xA;&#x9;&#x9;,a.Acad_Term&#xA;&#x9;&#x9;,a.Module_Code&#xA;&#x9;&#x9;,a.Average_Ca_Score&#xA;&#x9;&#x9;,a.Average_Sa_Score&#xA;&#x9;&#x9;,a.Final_Grade&#xA;&#x9;&#x9;,a.Final_Grade_Score&#xA;&#x9;&#x9;,a.Module_Status&#xA;&#x9;&#x9;,a.No_Of_Attempts&#xA;&#x9;&#x9;,a.Credit_Units&#xA;&#x9;&#x9;,ROW_NUMBER() OVER (PARTITION BY a.Qual_Type ,a.Student_Id, a.Acad_Term, a.Module_Code&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;ORDER BY a.Qual_Type ,a.Student_Id, a.Acad_Term, a.Module_Code) as rec_cnt_by_pk&#xA;&#x9;&#xA;    FROM &quot;+ @[$Project::RPDW_Initial_Catalog] +&quot;.dbo.[DW_STUDENT_MODULE_GRADES] a&#xA;&#xA;    )SELECT Qual_Type&#xA;&#x9;&#x9;,Student_Id&#xA;&#x9;&#x9;,Acad_Term&#xA;&#x9;&#x9;,Module_Code&#xA;&#x9;&#x9;,Average_Ca_Score&#xA;&#x9;&#x9;,Average_Sa_Score&#xA;&#x9;&#x9;,Final_Grade&#xA;&#x9;&#x9;,Final_Grade_Score&#xA;&#x9;&#x9;,Module_Status&#xA;&#x9;&#x9;,No_Of_Attempts&#xA;&#x9;&#x9;,Credit_Units&#xA;&#x9;&#x9;&#xA;&#x9;INTO ##TMP_TBL1&#xA;&#x9;FROM UNQ_STUDENT_MGRADES &#xA;&#x9;&#xA;&#x9;WHERE Acad_Term not in (''1300'',''1400'',''1500'',''1600'') &#xA;&#x9;AND rec_cnt_by_pk = 1&#xA;&#x9;AND Qual_Type IN&#xA;    ',@QUAL_TYPE&#xA;    ); -- End Set&#x9;&#xA;&#x9;   -- FILTER OUT QUAL TYPE BASED ON ETL_JOB_PARAMS.COMPLEX_JOIN_QUAL_TYPE&#xA;&#xA;   &#xA;  PRINT (@query);&#xA;  SET @all_queries=CONCAT(N'',@all_queries,@query);&#xA;  EXEC (@query);&#xA;  &#xA;--[B] Read DW_LEO_GRADE and extract Computed Module Score and Grade from DW_LEO_FINAL_GRADE&#xA;-- by unique group b.Qual_Type, b.Student_Id, b.Module_Code, b.Semester_Code&#xA;&#xA;--[B1] WRK_STUDENT_LEO_GRADES1 - ##TMP_TBL2&#xA;-- Begin SET&#xA;SET @query=CONCAT(&#xA;    N'WITH UNQ_LEO_GRADES1 AS (&#xA;&#x9;SELECT&#xA;&#x9;&#x9; b.Student_Id&#xA;&#x9;&#x9;,b.Module_Code&#xA;&#x9;&#x9;,b.Module_ID&#xA;&#x9;&#x9;,b.Qual_Type&#xA;&#x9;&#x9;,b.Acad_Year&#xA;&#x9;&#x9;,b.Semester&#xA;&#x9;&#x9;,b.Semester_Code&#xA;&#x9;&#x9;,ROW_NUMBER() OVER (PARTITION BY b.Qual_Type, b.Student_Id, b.Module_Code, b.Semester_Code&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;ORDER BY b.Qual_Type, b.Student_Id, b.Module_Code, b.Semester_Code, b.Semester desc) as rec_cnt_by_pk&#xA;&#x9;&#xA;    FROM &quot;+ @[$Project::RPDW_Initial_Catalog] +&quot;.dbo.[DW_LEO_GRADE] b&#xA;&#xA;    )SELECT Student_Id&#xA;&#x9;&#x9;,Module_Code&#xA;&#x9;&#x9;,Module_ID&#xA;&#x9;&#x9;,Qual_Type&#xA;&#x9;&#x9;,Acad_Year&#xA;&#x9;&#x9;,Semester&#xA;&#x9;&#x9;,Semester_Code&#xA;&#x9;&#x9;&#xA;&#x9;INTO ##TMP_TBL2&#xA;&#x9;FROM UNQ_LEO_GRADES1 &#xA;&#x9;&#xA;&#x9;WHERE rec_cnt_by_pk = 1&#xA;&#x9;AND Qual_Type IN&#xA;    ',@QUAL_TYPE&#xA;    ); -- End Set&#x9;&#xA;&#x9;   -- FILTER OUT QUAL TYPE BASED ON ETL_JOB_PARAMS.COMPLEX_JOIN_QUAL_TYPE&#xA;&#xA;   &#xA;  PRINT (@query);&#xA;  SET @all_queries=CONCAT(N'',@all_queries,@query);&#xA;  EXEC (@query);&#xA;&#xA;  &#xA;--[B2] WRK_STUDENT_LEO_FINAL_GRADES1 ##TMP_TBL3&#xA;-- Begin SET&#xA;SET @query=CONCAT(&#xA;    N'WITH UNQ_LEO_FINAL_GRADES AS ( &#xA;&#x9;SELECT&#xA;&#x9;&#x9;Student_Id&#xA;&#x9;&#x9;,Module_ID&#xA;&#x9;&#x9;,Qual_Type&#xA;&#x9;&#x9;,Acad_Year&#xA;&#x9;&#x9;,Semester&#xA;&#x9;&#x9;,Semester_Code&#xA;&#x9;&#x9;,Computed_Module_Score&#xA;&#x9;&#x9;,Computed_Module_Grade&#xA;&#x9;&#x9;,ROW_NUMBER() OVER (PARTITION BY Qual_Type, Student_Id, Module_Code, Semester_Code&#xA;&#x9;&#x9;ORDER BY Qual_Type, Student_Id, Module_Code, Semester_Code, Semester desc) as rec_cnt_by_pk&#xA;&#xA;    FROM &quot;+ @[$Project::RPDW_Initial_Catalog] +&quot;.dbo.[DW_LEO_FINAL_GRADE]&#xA;&#xA;&#x9;)SELECT Student_Id&#xA;&#x9;&#x9;,Module_ID&#xA;&#x9;&#x9;,Qual_Type&#xA;&#x9;&#x9;,Acad_Year&#xA;&#x9;&#x9;,Semester&#xA;&#x9;&#x9;,Semester_Code&#xA;&#x9;&#x9;,Computed_Module_Score&#xA;&#x9;&#x9;,Computed_Module_Grade&#xA;&#x9;&#x9;&#xA;&#x9;INTO ##TMP_TBL3&#xA;&#x9;FROM UNQ_LEO_FINAL_GRADES &#xA;&#x9;&#xA;&#x9;WHERE rec_cnt_by_pk = 1&#xA;&#x9;AND Qual_Type IN&#xA;    ',@QUAL_TYPE&#xA;    ); -- End Set&#x9;&#xA;&#x9;   -- FILTER OUT QUAL TYPE BASED ON ETL_JOB_PARAMS.COMPLEX_JOIN_QUAL_TYPE&#xA;&#xA;   &#xA;  PRINT (@query);&#xA;  SET @all_queries=CONCAT(N'',@all_queries,@query);&#xA;  EXEC (@query);&#xA;&#xA; &#xA;-- [B3] - INNER JOIN WRK_STUDENT_LEO_GRADES1(##TMP_TBL2) WRK_STUDENT_LEO_FINAL_GRADES1 (##TMP_TBL3)&#xA;-- Begin SET&#xA;SET @query=&#xA;    N'WITH UNQ_LEO_GRADES2 AS ( &#xA;&#x9;SELECT&#xA;&#x9;&#x9; b.Student_Id&#xA;&#x9;&#x9;,b.Module_Code&#xA;&#x9;&#x9;,b.Module_ID&#xA;&#x9;&#x9;,b.Qual_Type&#xA;&#x9;&#x9;,b.Acad_Year&#xA;&#x9;&#x9;,b.Semester&#xA;&#x9;&#x9;,b.Semester_Code&#xA;&#x9;&#x9;,c.Computed_Module_Score&#xA;&#x9;&#x9;,c.Computed_Module_Grade&#xA;&#x9;&#x9;,ROW_NUMBER() OVER (PARTITION BY b.Qual_Type, b.Student_Id, b.Module_Code, b.Semester_Code&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;ORDER BY b.Qual_Type, b.Student_Id, b.Module_Code, b.Semester_Code) as rec_cnt_by_pk&#xA;&#x9;FROM ##TMP_TBL2 b&#xA;&#x9;INNER JOIN ##TMP_TBL3 c&#xA;&#x9;&#xA;&#x9;on b.Module_ID = c.Module_ID&#xA;&#x9;and b.Qual_Type = c.Qual_Type&#xA;&#x9;and b.Acad_Year = c.Acad_Year&#xA;&#x9;and b.Semester = c.Semester&#xA;&#x9;and b.Student_Id = c.Student_Id&#xA;   )SELECT &#xA;&#x9;&#x9; Student_Id&#xA;&#x9;&#x9;,Module_Code&#xA;&#x9;&#x9;,Module_ID&#xA;&#x9;&#x9;,Qual_Type&#xA;&#x9;&#x9;,Acad_Year&#xA;&#x9;&#x9;,Semester&#xA;&#x9;&#x9;,Semester_Code&#xA;&#x9;&#x9;,Computed_Module_Score&#xA;&#x9;&#x9;,Computed_Module_Grade&#xA;&#x9;&#x9;&#xA;&#x9;INTO ##TMP_TBL4&#xA;&#x9;FROM UNQ_LEO_GRADES2 WHERE rec_cnt_by_pk = 1&#xA;    '; -- End Set&#x9;&#xA;&#x9;&#xA;  PRINT (@query);&#xA;  SET @all_queries=CONCAT(N'',@all_queries,@query);&#xA;  EXEC (@query);&#xA;&#xA;  &#xA;-- MERGE [A] AND [B3]&#xA;-- Begin SET&#xA;SET @query=CONCAT(&#xA;    N'WITH TMP1 AS (&#xA;&#x9;SELECT &#xA;&#x9;&#x9; a.Qual_Type&#xA;&#x9;&#x9;,a.Student_Id&#xA;&#x9;&#x9;,a.Acad_Term&#xA;&#x9;&#x9;,a.Module_Code&#xA;&#x9;&#x9;,a.Average_Ca_Score&#xA;&#x9;&#x9;,a.Average_Sa_Score&#xA;&#x9;&#x9;,a.Final_Grade&#xA;&#x9;&#x9;,(CASE WHEN b.Computed_Module_Score != 0 THEN b.Computed_Module_Score ELSE a.Final_Grade_Score END) as Final_Grade_Score&#xA;&#x9;&#x9;,a.Module_Status&#xA;&#x9;&#x9;,a.No_Of_Attempts&#xA;&#x9;&#x9;,a.Credit_Units&#xA;&#x9;&#x9;,b.Semester&#xA;&#x9;&#x9;,b.Semester_Code&#xA;&#x9;&#x9;&#xA;&#x9;FROM ##TMP_TBL1 a&#xA;&#x9;LEFT JOIN ##TMP_TBL4 b&#xA;&#x9;&#xA;&#x9;ON a.Qual_Type = b.Qual_Type &#xA;&#x9;&#x9;and a.Student_Id = b.Student_Id &#xA;&#x9;&#x9;and a.Module_Code = b.Module_Code &#xA;&#x9;&#x9;and a.Acad_Term = b.Semester_Code&#xA;&#x9;&#x9;&#xA;)   SELECT &#xA;&#x9;&#x9; Qual_Type&#xA;&#x9;&#x9;,Student_Id&#xA;&#x9;&#x9;,Acad_Term&#xA;&#x9;&#x9;,Module_Code&#x9;&#xA;&#x9;&#x9;,Average_Ca_Score&#xA;&#x9;&#x9;,Average_Sa_Score&#xA;&#x9;&#x9;,Final_Grade&#xA;&#x9;&#x9;,Final_Grade_Score&#xA;&#x9;&#x9;,Module_Status&#xA;&#x9;&#x9;,No_Of_Attempts&#xA;&#x9;&#x9;,Credit_Units&#x9;&#xA;&#x9;&#x9;,Semester&#xA;&#xA;&#x9;INTO ##TMP_Module_Result&#xA;&#x9;FROM TMP1 &#xA;        WHERE 1 = 1&#xA;    ',@condition&#xA;    ); -- End Set&#x9;&#xA;&#x9;&#xA;  PRINT (@query);&#xA;  SET @all_queries=CONCAT(N'',@all_queries,@query);&#xA;  EXEC (@query);&#xA;&#xA;&#xA;&#xA;  INSERT INTO &quot;+ @[$Project::RPDW_USR_Initial_Catalog] +&quot;.[dbo].&quot;+ @[User::TgtTableName]+&quot;               &#xA;         (  &#xA;&#x9;&#x9; [Qual_Type]&#xA;&#x9;&#x9;,[Student_Id]&#xA;&#x9;&#x9;,[TERM]&#xA;&#x9;&#x9;,[Module_Code]&#x9;&#xA;&#x9;&#x9;,[Average_Ca_Score]&#xA;&#x9;&#x9;,[Average_Sa_Score]&#xA;&#x9;&#x9;,[Final_Grade]&#xA;&#x9;&#x9;,[Final_Grade_Score]&#xA;&#x9;&#x9;,[Module_Status]&#xA;&#x9;&#x9;,[No.Of.Attempts]&#xA;&#x9;&#x9;,[Credit_Units]&#xA;&#x9;&#x9;,[Semester]&#xA;&#x9;&#x9;,[CREATED_ON]&#xA;&#x9;&#x9;,[MODIFIED_ON]&#xA;&#x9;     ) &#xA;&#x9;SELECT &#xA;&#x9;&#x9; Qual_Type&#xA;&#x9;&#x9;,Student_Id&#xA;&#x9;&#x9;,Acad_Term&#x9;&#x9;AS [TERM]&#xA;&#x9;&#x9;,Module_Code&#x9;&#xA;&#x9;&#x9;,Average_Ca_Score&#xA;&#x9;&#x9;,Average_Sa_Score&#xA;&#x9;&#x9;,Final_Grade&#xA;&#x9;&#x9;,Final_Grade_Score&#xA;&#x9;&#x9;,Module_Status&#xA;&#x9;&#x9;,No_Of_Attempts&#x9;AS [No.Of.Attempts]&#xA;&#x9;&#x9;,Credit_Units&#x9;&#xA;&#x9;&#x9;,Semester&#xA;&#x9;&#x9;,getdate()&#xA;&#x9;    ,getdate()&#xA;&#x9;FROM ##TMP_Module_Result&#xA;;&#xA;&#xA;&#xA;-- Check Source Table Count&#xA;SELECT @source_cnt=COUNT(*) FROM ##TMP_Module_Result;&#xA;&#x9;&#xA;-- Check Tgt Table Count&#xA;SELECT @target_cnt=COUNT(*) FROM &quot;+ @[$Project::RPDW_USR_Initial_Catalog] +&quot;.[dbo].&quot;+ @[User::TgtTableName]+&quot;;&#xA;    &#xA;-- Update Counts&#xA;UPDATE &quot;+ @[$Project::RPDW_USR_Initial_Catalog] +&quot;.[dbo].[ETL_JOB_STATUS] &#xA;   SET [SRC_CNT]=@source_cnt,&#xA;       [TGT_CNT]=@target_cnt,&#xA;&#x9;   [REMARKS]=@all_queries,&#xA;&#x9;   [FILENAME]=@outputfilename&#xA;   WHERE [JOB_STATUS_ID]=@jobstatusid;&#x9;&#x9;&#xA;&#xA;--------------------------------------&#xA;COMMIT TRANSACTION&#xA;END TRY&#xA;&#xA;BEGIN CATCH&#xA;  ROLLBACK TRANSACTION&#xA;&#xA;  INSERT INTO &quot;+ @[$Project::RPDW_USR_Initial_Catalog] + &quot;.[dbo].[ETL_ERROR_LOG](JOB_STATUS_ID,ERROR_RECORD,created_on)&#xA;  SELECT   &#xA;         CAST(@jobstatusid as int) as JOB_STATUS_ID&#xA;        ,ERROR_MESSAGE() AS ErrorMessage&#xA;&#x9;&#x9;,getdate()  as created_on&#xA;&#xA;-- Update SQL QUERIES EXECUTED&#xA;UPDATE &quot;+ @[$Project::RPDW_USR_Initial_Catalog] +&quot;.[dbo].[ETL_JOB_STATUS] &#xA;   SET [REMARKS]=@all_queries&#xA;   WHERE [JOB_STATUS_ID]=@jobstatusid;&#x9;&#xA;   &#xA;END CATCH &#xA;GO&#xA;&quot;"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="SQL_DM_Load">
      <DTS:VariableValue
        DTS:DataType="8">BEGIN TRANSACTION
BEGIN TRY
------------
IF OBJECT_ID(N'tempdb..##TMP_Module_Result') IS NOT NULL
BEGIN
  DROP TABLE ##TMP_Module_Result
END

IF OBJECT_ID(N'tempdb..##TMP_TBL1') IS NOT NULL
BEGIN
  DROP TABLE ##TMP_TBL1
END

IF OBJECT_ID(N'tempdb..##TMP_TBL2') IS NOT NULL
BEGIN
  DROP TABLE ##TMP_TBL2
END

IF OBJECT_ID(N'tempdb..##TMP_TBL3') IS NOT NULL
BEGIN
  DROP TABLE ##TMP_TBL3
END

IF OBJECT_ID(N'tempdb..##TMP_TBL3') IS NOT NULL
BEGIN
  DROP TABLE ##TMP_TBL3
END

IF OBJECT_ID(N'tempdb..##TMP_TBL4') IS NOT NULL
BEGIN
  DROP TABLE ##TMP_TBL4
END

DECLARE @jobstatusid varchar(5)
,@condition varchar(100)
,@filter_criteria varchar(100)
,@QUAL_TYPE varchar(100)
,@query nvarchar(max)
,@job_name varchar(100)
,@source_cnt INT
,@target_cnt INT
,@all_queries varchar(4000)
,@outputfilename varchar(200)
,@date1 varchar(10)
;

SET @source_cnt=0;
SET @target_cnt=0;


select @jobstatusid=0;
select @date1=convert(varchar(10),GETDATE(),112);
select @outputfilename=CONCAT('DW_moduleresult_',@date1,'.txt');


SELECT @filter_criteria=FILTER_CRITERIA, @QUAL_TYPE=QUAL_TYPE_CRITERIA FROM RPDW_USR_STG.[dbo].[ETL_JOB_PARAMS]  
WHERE JOB_NAME='DW_ENT_STUDENT_MODULE_RESULT';

IF  @filter_criteria='FULL-LOAD' 
  BEGIN
     SET @condition=';';
  END
ELSE IF @filter_criteria&lt;&gt;'' OR ISNULL(@filter_criteria,N'')&lt;&gt;'' 
    BEGIN
	    SET @condition=CONCAT('AND ',@filter_criteria,';');
    END
; 

TRUNCATE TABLE RPDW_USR_STG.[dbo].DW_ENT_STUDENT_MODULE_RESULT  
;

--[A] Read DW_STUDENT_MODULE_GRADES from based on group a.Qual_Type ,a.Student_Id, a.Acad_Term, a.Module_Code
-- Begin SET
SET @query=CONCAT(
    N'WITH UNQ_STUDENT_MGRADES AS ( 
	SELECT 
		 a.Qual_Type
		,a.Student_Id
		,a.Acad_Term
		,a.Module_Code
		,a.Average_Ca_Score
		,a.Average_Sa_Score
		,a.Final_Grade
		,a.Final_Grade_Score
		,a.Module_Status
		,a.No_Of_Attempts
		,a.Credit_Units
		,ROW_NUMBER() OVER (PARTITION BY a.Qual_Type ,a.Student_Id, a.Acad_Term, a.Module_Code
							ORDER BY a.Qual_Type ,a.Student_Id, a.Acad_Term, a.Module_Code) as rec_cnt_by_pk
	
    FROM RPDW_STG.dbo.[DW_STUDENT_MODULE_GRADES] a

    )SELECT Qual_Type
		,Student_Id
		,Acad_Term
		,Module_Code
		,Average_Ca_Score
		,Average_Sa_Score
		,Final_Grade
		,Final_Grade_Score
		,Module_Status
		,No_Of_Attempts
		,Credit_Units
		
	INTO ##TMP_TBL1
	FROM UNQ_STUDENT_MGRADES 
	
	WHERE Acad_Term not in (''1300'',''1400'',''1500'',''1600'') 
	AND rec_cnt_by_pk = 1
	AND Qual_Type IN
    ',@QUAL_TYPE
    ); -- End Set	
	   -- FILTER OUT QUAL TYPE BASED ON ETL_JOB_PARAMS.COMPLEX_JOIN_QUAL_TYPE

   
  PRINT (@query);
  SET @all_queries=CONCAT(N'',@all_queries,@query);
  EXEC (@query);
  
--[B] Read DW_LEO_GRADE and extract Computed Module Score and Grade from DW_LEO_FINAL_GRADE
-- by unique group b.Qual_Type, b.Student_Id, b.Module_Code, b.Semester_Code

--[B1] WRK_STUDENT_LEO_GRADES1 - ##TMP_TBL2
-- Begin SET
SET @query=CONCAT(
    N'WITH UNQ_LEO_GRADES1 AS (
	SELECT
		 b.Student_Id
		,b.Module_Code
		,b.Module_ID
		,b.Qual_Type
		,b.Acad_Year
		,b.Semester
		,b.Semester_Code
		,ROW_NUMBER() OVER (PARTITION BY b.Qual_Type, b.Student_Id, b.Module_Code, b.Semester_Code
							ORDER BY b.Qual_Type, b.Student_Id, b.Module_Code, b.Semester_Code, b.Semester desc) as rec_cnt_by_pk
	
    FROM RPDW_STG.dbo.[DW_LEO_GRADE] b

    )SELECT Student_Id
		,Module_Code
		,Module_ID
		,Qual_Type
		,Acad_Year
		,Semester
		,Semester_Code
		
	INTO ##TMP_TBL2
	FROM UNQ_LEO_GRADES1 
	
	WHERE rec_cnt_by_pk = 1
	AND Qual_Type IN
    ',@QUAL_TYPE
    ); -- End Set	
	   -- FILTER OUT QUAL TYPE BASED ON ETL_JOB_PARAMS.COMPLEX_JOIN_QUAL_TYPE

   
  PRINT (@query);
  SET @all_queries=CONCAT(N'',@all_queries,@query);
  EXEC (@query);

  
--[B2] WRK_STUDENT_LEO_FINAL_GRADES1 ##TMP_TBL3
-- Begin SET
SET @query=CONCAT(
    N'WITH UNQ_LEO_FINAL_GRADES AS ( 
	SELECT
		Student_Id
		,Module_ID
		,Qual_Type
		,Acad_Year
		,Semester
		,Semester_Code
		,Computed_Module_Score
		,Computed_Module_Grade
		,ROW_NUMBER() OVER (PARTITION BY Qual_Type, Student_Id, Module_Code, Semester_Code
		ORDER BY Qual_Type, Student_Id, Module_Code, Semester_Code, Semester desc) as rec_cnt_by_pk

    FROM RPDW_STG.dbo.[DW_LEO_FINAL_GRADE]

	)SELECT Student_Id
		,Module_ID
		,Qual_Type
		,Acad_Year
		,Semester
		,Semester_Code
		,Computed_Module_Score
		,Computed_Module_Grade
		
	INTO ##TMP_TBL3
	FROM UNQ_LEO_FINAL_GRADES 
	
	WHERE rec_cnt_by_pk = 1
	AND Qual_Type IN
    ',@QUAL_TYPE
    ); -- End Set	
	   -- FILTER OUT QUAL TYPE BASED ON ETL_JOB_PARAMS.COMPLEX_JOIN_QUAL_TYPE

   
  PRINT (@query);
  SET @all_queries=CONCAT(N'',@all_queries,@query);
  EXEC (@query);

 
-- [B3] - INNER JOIN WRK_STUDENT_LEO_GRADES1(##TMP_TBL2) WRK_STUDENT_LEO_FINAL_GRADES1 (##TMP_TBL3)
-- Begin SET
SET @query=
    N'WITH UNQ_LEO_GRADES2 AS ( 
	SELECT
		 b.Student_Id
		,b.Module_Code
		,b.Module_ID
		,b.Qual_Type
		,b.Acad_Year
		,b.Semester
		,b.Semester_Code
		,c.Computed_Module_Score
		,c.Computed_Module_Grade
		,ROW_NUMBER() OVER (PARTITION BY b.Qual_Type, b.Student_Id, b.Module_Code, b.Semester_Code
							ORDER BY b.Qual_Type, b.Student_Id, b.Module_Code, b.Semester_Code) as rec_cnt_by_pk
	FROM ##TMP_TBL2 b
	INNER JOIN ##TMP_TBL3 c
	
	on b.Module_ID = c.Module_ID
	and b.Qual_Type = c.Qual_Type
	and b.Acad_Year = c.Acad_Year
	and b.Semester = c.Semester
	and b.Student_Id = c.Student_Id
   )SELECT 
		 Student_Id
		,Module_Code
		,Module_ID
		,Qual_Type
		,Acad_Year
		,Semester
		,Semester_Code
		,Computed_Module_Score
		,Computed_Module_Grade
		
	INTO ##TMP_TBL4
	FROM UNQ_LEO_GRADES2 WHERE rec_cnt_by_pk = 1
    '; -- End Set	
	
  PRINT (@query);
  SET @all_queries=CONCAT(N'',@all_queries,@query);
  EXEC (@query);

  
-- MERGE [A] AND [B3]
-- Begin SET
SET @query=CONCAT(
    N'WITH TMP1 AS (
	SELECT 
		 a.Qual_Type
		,a.Student_Id
		,a.Acad_Term
		,a.Module_Code
		,a.Average_Ca_Score
		,a.Average_Sa_Score
		,a.Final_Grade
		,(CASE WHEN b.Computed_Module_Score != 0 THEN b.Computed_Module_Score ELSE a.Final_Grade_Score END) as Final_Grade_Score
		,a.Module_Status
		,a.No_Of_Attempts
		,a.Credit_Units
		,b.Semester
		,b.Semester_Code
		
	FROM ##TMP_TBL1 a
	LEFT JOIN ##TMP_TBL4 b
	
	ON a.Qual_Type = b.Qual_Type 
		and a.Student_Id = b.Student_Id 
		and a.Module_Code = b.Module_Code 
		and a.Acad_Term = b.Semester_Code
		
)   SELECT 
		 Qual_Type
		,Student_Id
		,Acad_Term
		,Module_Code	
		,Average_Ca_Score
		,Average_Sa_Score
		,Final_Grade
		,Final_Grade_Score
		,Module_Status
		,No_Of_Attempts
		,Credit_Units	
		,Semester

	INTO ##TMP_Module_Result
	FROM TMP1 
        WHERE 1 = 1
    ',@condition
    ); -- End Set	
	
  PRINT (@query);
  SET @all_queries=CONCAT(N'',@all_queries,@query);
  EXEC (@query);



  INSERT INTO RPDW_USR_STG.[dbo].DW_ENT_STUDENT_MODULE_RESULT               
         (  
		 [Qual_Type]
		,[Student_Id]
		,[TERM]
		,[Module_Code]	
		,[Average_Ca_Score]
		,[Average_Sa_Score]
		,[Final_Grade]
		,[Final_Grade_Score]
		,[Module_Status]
		,[No.Of.Attempts]
		,[Credit_Units]
		,[Semester]
		,[CREATED_ON]
		,[MODIFIED_ON]
	     ) 
	SELECT 
		 Qual_Type
		,Student_Id
		,Acad_Term		AS [TERM]
		,Module_Code	
		,Average_Ca_Score
		,Average_Sa_Score
		,Final_Grade
		,Final_Grade_Score
		,Module_Status
		,No_Of_Attempts	AS [No.Of.Attempts]
		,Credit_Units	
		,Semester
		,getdate()
	    ,getdate()
	FROM ##TMP_Module_Result
;


-- Check Source Table Count
SELECT @source_cnt=COUNT(*) FROM ##TMP_Module_Result;
	
-- Check Tgt Table Count
SELECT @target_cnt=COUNT(*) FROM RPDW_USR_STG.[dbo].DW_ENT_STUDENT_MODULE_RESULT;
    
-- Update Counts
UPDATE RPDW_USR_STG.[dbo].[ETL_JOB_STATUS] 
   SET [SRC_CNT]=@source_cnt,
       [TGT_CNT]=@target_cnt,
	   [REMARKS]=@all_queries,
	   [FILENAME]=@outputfilename
   WHERE [JOB_STATUS_ID]=@jobstatusid;		

--------------------------------------
COMMIT TRANSACTION
END TRY

BEGIN CATCH
  ROLLBACK TRANSACTION

  INSERT INTO RPDW_USR_STG.[dbo].[ETL_ERROR_LOG](JOB_STATUS_ID,ERROR_RECORD,created_on)
  SELECT   
         CAST(@jobstatusid as int) as JOB_STATUS_ID
        ,ERROR_MESSAGE() AS ErrorMessage
		,getdate()  as created_on

-- Update SQL QUERIES EXECUTED
UPDATE RPDW_USR_STG.[dbo].[ETL_JOB_STATUS] 
   SET [REMARKS]=@all_queries
   WHERE [JOB_STATUS_ID]=@jobstatusid;	
   
END CATCH 
GO
</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{CB91058C-23C0-46C1-8892-A508906C0C2B}"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="STAGE">
      <DTS:VariableValue
        DTS:DataType="8">DW</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{F4CD78E6-C3D4-4030-B17C-C766BF1CC994}"
      DTS:EvaluateAsExpression="True"
      DTS:Expression="@[User::Job_name]"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="TgtTableName">
      <DTS:VariableValue
        DTS:DataType="8">DW_ENT_STUDENT_MODULE_RESULT</DTS:VariableValue>
    </DTS:Variable>
  </DTS:Variables>
  <DTS:Executables>
    <DTS:Executable
      DTS:refId="Package\DFT_ExportDMtoTXT"
      DTS:CreationName="Microsoft.Pipeline"
      DTS:Description="Data Flow Task"
      DTS:DTSID="{D1136729-21C9-45CE-AD3A-B4923D2714B8}"
      DTS:ExecutableType="Microsoft.Pipeline"
      DTS:LocaleID="-1"
      DTS:ObjectName="DFT_ExportDMtoTXT"
      DTS:TaskContact="Performs high-performance data extraction, transformation and loading;Microsoft Corporation; Microsoft SQL Server; (C) Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
      <DTS:Variables />
      <DTS:ObjectData>
        <pipeline
          version="1">
          <components>
            <component
              refId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput"
              componentClassID="Microsoft.FlatFileDestination"
              contactInfo="Flat File Destination;Microsoft Corporation; Microsoft SQL Server; (C) Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;1"
              description="Flat File Destination"
              localeId="1033"
              name="FF_DST_TextOutput">
              <properties>
                <property
                  dataType="System.Boolean"
                  description="Specifies whether the data will overwrite or append to the destination file."
                  name="Overwrite">true</property>
                <property
                  dataType="System.Null"
                  description="Specifies the text to write to the destination file before any data is written."
                  expressionType="Notify"
                  name="Header" />
                <property
                  dataType="System.Boolean"
                  description="When text qualifier is enabled, specifies whether the text qualifier in the data written to the destination file will be escaped or not."
                  name="EscapeQualifier">false</property>
              </properties>
              <connections>
                <connection
                  refId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Connections[FlatFileConnection]"
                  connectionManagerID="Package.ConnectionManagers[OutputTextFile_Conn]"
                  connectionManagerRefId="Package.ConnectionManagers[OutputTextFile_Conn]"
                  name="FlatFileConnection" />
              </connections>
              <inputs>
                <input
                  refId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input]"
                  hasSideEffects="true"
                  name="Flat File Destination Input">
                  <inputColumns>
                    <inputColumn
                      refId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].Columns[Qual_Type]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="4"
                      cachedName="Qual_Type"
                      externalMetadataColumnId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].ExternalColumns[Qual_Type]"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[Qual_Type]" />
                    <inputColumn
                      refId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].Columns[Student_Id]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="11"
                      cachedName="Student_Id"
                      externalMetadataColumnId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].ExternalColumns[Student_Id]"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[Student_Id]" />
                    <inputColumn
                      refId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].Columns[TERM]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="4"
                      cachedName="TERM"
                      externalMetadataColumnId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].ExternalColumns[TERM]"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[TERM]" />
                    <inputColumn
                      refId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].Columns[Module_Code]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="10"
                      cachedName="Module_Code"
                      externalMetadataColumnId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].ExternalColumns[Module_Code]"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[Module_Code]" />
                    <inputColumn
                      refId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].Columns[Average_Ca_Score]"
                      cachedDataType="numeric"
                      cachedName="Average_Ca_Score"
                      cachedPrecision="18"
                      cachedScale="6"
                      externalMetadataColumnId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].ExternalColumns[Average_Ca_Score]"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[Average_Ca_Score]" />
                    <inputColumn
                      refId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].Columns[Average_Sa_Score]"
                      cachedDataType="numeric"
                      cachedName="Average_Sa_Score"
                      cachedPrecision="18"
                      cachedScale="6"
                      externalMetadataColumnId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].ExternalColumns[Average_Sa_Score]"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[Average_Sa_Score]" />
                    <inputColumn
                      refId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].Columns[Final_Grade]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="3"
                      cachedName="Final_Grade"
                      externalMetadataColumnId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].ExternalColumns[Final_Grade]"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[Final_Grade]" />
                    <inputColumn
                      refId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].Columns[Final_Grade_Score]"
                      cachedDataType="numeric"
                      cachedName="Final_Grade_Score"
                      cachedPrecision="18"
                      cachedScale="6"
                      externalMetadataColumnId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].ExternalColumns[Final_Grade_Score]"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[Final_Grade_Score]" />
                    <inputColumn
                      refId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].Columns[Module_status]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="4"
                      cachedName="Module_status"
                      externalMetadataColumnId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].ExternalColumns[Module_status]"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[Module_status]" />
                    <inputColumn
                      refId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].Columns[No.Of.Attempts]"
                      cachedDataType="i4"
                      cachedName="No.Of.Attempts"
                      externalMetadataColumnId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].ExternalColumns[No.Of.Attempts]"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[No.Of.Attempts]" />
                    <inputColumn
                      refId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].Columns[Credit_Units]"
                      cachedDataType="numeric"
                      cachedName="Credit_Units"
                      cachedPrecision="8"
                      cachedScale="6"
                      externalMetadataColumnId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].ExternalColumns[Credit_Units]"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[Credit_Units]" />
                    <inputColumn
                      refId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].Columns[Semester]"
                      cachedDataType="i4"
                      cachedName="Semester"
                      externalMetadataColumnId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].ExternalColumns[Semester]"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[Semester]" />
                  </inputColumns>
                  <externalMetadataColumns
                    isUsed="True">
                    <externalMetadataColumn
                      refId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].ExternalColumns[Qual_Type]"
                      codePage="1252"
                      dataType="str"
                      length="4"
                      name="Qual_Type" />
                    <externalMetadataColumn
                      refId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].ExternalColumns[Student_Id]"
                      codePage="1252"
                      dataType="str"
                      length="11"
                      name="Student_Id" />
                    <externalMetadataColumn
                      refId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].ExternalColumns[TERM]"
                      codePage="1252"
                      dataType="str"
                      length="4"
                      name="TERM" />
                    <externalMetadataColumn
                      refId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].ExternalColumns[Module_Code]"
                      codePage="1252"
                      dataType="str"
                      length="10"
                      name="Module_Code" />
                    <externalMetadataColumn
                      refId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].ExternalColumns[Average_Ca_Score]"
                      dataType="numeric"
                      name="Average_Ca_Score"
                      precision="18"
                      scale="6" />
                    <externalMetadataColumn
                      refId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].ExternalColumns[Average_Sa_Score]"
                      dataType="numeric"
                      name="Average_Sa_Score"
                      precision="18"
                      scale="6" />
                    <externalMetadataColumn
                      refId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].ExternalColumns[Final_Grade]"
                      codePage="1252"
                      dataType="str"
                      length="3"
                      name="Final_Grade" />
                    <externalMetadataColumn
                      refId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].ExternalColumns[Final_Grade_Score]"
                      dataType="numeric"
                      name="Final_Grade_Score"
                      precision="18"
                      scale="6" />
                    <externalMetadataColumn
                      refId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].ExternalColumns[Module_status]"
                      codePage="1252"
                      dataType="str"
                      length="4"
                      name="Module_status" />
                    <externalMetadataColumn
                      refId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].ExternalColumns[No.Of.Attempts]"
                      dataType="i4"
                      name="No.Of.Attempts" />
                    <externalMetadataColumn
                      refId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].ExternalColumns[Credit_Units]"
                      dataType="numeric"
                      name="Credit_Units"
                      precision="8"
                      scale="6" />
                    <externalMetadataColumn
                      refId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input].ExternalColumns[Semester]"
                      dataType="i4"
                      name="Semester" />
                  </externalMetadataColumns>
                </input>
              </inputs>
            </component>
            <component
              refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM"
              componentClassID="Microsoft.OLEDBSource"
              contactInfo="OLE DB Source;Microsoft Corporation; Microsoft SQL Server; (C) Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;7"
              description="OLE DB Source"
              name="OLE_SRC_ReadDM"
              usesDispositions="true"
              version="7">
              <properties>
                <property
                  dataType="System.Int32"
                  description="The number of seconds before a command times out.  A value of 0 indicates an infinite time-out."
                  name="CommandTimeout">0</property>
                <property
                  dataType="System.String"
                  description="Specifies the name of the database object used to open a rowset."
                  name="OpenRowset"></property>
                <property
                  dataType="System.String"
                  description="Specifies the variable that contains the name of the database object used to open a rowset."
                  name="OpenRowsetVariable"></property>
                <property
                  dataType="System.String"
                  description="The SQL command to be executed."
                  name="SqlCommand"
                  UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor, Microsoft.DataTransformationServices.Controls, Version=15.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91">SELECT * FROM dbo.DW_ENT_STUDENT_MODULE_RESULT</property>
                <property
                  dataType="System.String"
                  description="The variable that contains the SQL command to be executed."
                  name="SqlCommandVariable"></property>
                <property
                  dataType="System.Int32"
                  description="Specifies the column code page to use when code page information is unavailable from the data source."
                  name="DefaultCodePage">1252</property>
                <property
                  dataType="System.Boolean"
                  description="Forces the use of the DefaultCodePage property value when describing character data."
                  name="AlwaysUseDefaultCodePage">false</property>
                <property
                  dataType="System.Int32"
                  description="Specifies the mode used to access the database."
                  name="AccessMode"
                  typeConverter="AccessMode">2</property>
                <property
                  dataType="System.String"
                  description="The mappings between the parameters in the SQL command and variables."
                  name="ParameterMapping"></property>
              </properties>
              <connections>
                <connection
                  refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Connections[OleDbConnection]"
                  connectionManagerID="{4E74D30E-4295-488F-A407-AD1DC4921EC7}:external"
                  connectionManagerRefId="Project.ConnectionManagers[RPDW_USR_Conn]"
                  description="The OLE DB runtime connection used to access the database."
                  name="OleDbConnection" />
              </connections>
              <outputs>
                <output
                  refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output]"
                  name="OLE DB Source Output">
                  <outputColumns>
                    <outputColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[Qual_Type]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].ExternalColumns[Qual_Type]"
                      length="4"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[Qual_Type]"
                      name="Qual_Type"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[Student_Id]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].ExternalColumns[Student_Id]"
                      length="11"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[Student_Id]"
                      name="Student_Id"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[TERM]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].ExternalColumns[TERM]"
                      length="4"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[TERM]"
                      name="TERM"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[Module_Code]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].ExternalColumns[Module_Code]"
                      length="10"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[Module_Code]"
                      name="Module_Code"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[Average_Ca_Score]"
                      dataType="numeric"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].ExternalColumns[Average_Ca_Score]"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[Average_Ca_Score]"
                      name="Average_Ca_Score"
                      precision="18"
                      scale="6"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[Average_Sa_Score]"
                      dataType="numeric"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].ExternalColumns[Average_Sa_Score]"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[Average_Sa_Score]"
                      name="Average_Sa_Score"
                      precision="18"
                      scale="6"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[Final_Grade]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].ExternalColumns[Final_Grade]"
                      length="3"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[Final_Grade]"
                      name="Final_Grade"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[Final_Grade_Score]"
                      dataType="numeric"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].ExternalColumns[Final_Grade_Score]"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[Final_Grade_Score]"
                      name="Final_Grade_Score"
                      precision="18"
                      scale="6"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[Module_status]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].ExternalColumns[Module_status]"
                      length="4"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[Module_status]"
                      name="Module_status"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[No.Of.Attempts]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].ExternalColumns[No.Of.Attempts]"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[No.Of.Attempts]"
                      name="No.Of.Attempts"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[Credit_Units]"
                      dataType="numeric"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].ExternalColumns[Credit_Units]"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[Credit_Units]"
                      name="Credit_Units"
                      precision="8"
                      scale="6"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[Semester]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].ExternalColumns[Semester]"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].Columns[Semester]"
                      name="Semester"
                      truncationRowDisposition="FailComponent" />
                  </outputColumns>
                  <externalMetadataColumns
                    isUsed="True">
                    <externalMetadataColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].ExternalColumns[CREATED_ON]"
                      dataType="dbTimeStamp"
                      name="CREATED_ON" />
                    <externalMetadataColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].ExternalColumns[MODIFIED_ON]"
                      dataType="dbTimeStamp"
                      name="MODIFIED_ON" />
                    <externalMetadataColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].ExternalColumns[Qual_Type]"
                      codePage="1252"
                      dataType="str"
                      length="4"
                      name="Qual_Type" />
                    <externalMetadataColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].ExternalColumns[Student_Id]"
                      codePage="1252"
                      dataType="str"
                      length="11"
                      name="Student_Id" />
                    <externalMetadataColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].ExternalColumns[TERM]"
                      codePage="1252"
                      dataType="str"
                      length="4"
                      name="TERM" />
                    <externalMetadataColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].ExternalColumns[Module_Code]"
                      codePage="1252"
                      dataType="str"
                      length="10"
                      name="Module_Code" />
                    <externalMetadataColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].ExternalColumns[Average_Ca_Score]"
                      dataType="numeric"
                      name="Average_Ca_Score"
                      precision="18"
                      scale="6" />
                    <externalMetadataColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].ExternalColumns[Average_Sa_Score]"
                      dataType="numeric"
                      name="Average_Sa_Score"
                      precision="18"
                      scale="6" />
                    <externalMetadataColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].ExternalColumns[Final_Grade]"
                      codePage="1252"
                      dataType="str"
                      length="3"
                      name="Final_Grade" />
                    <externalMetadataColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].ExternalColumns[Final_Grade_Score]"
                      dataType="numeric"
                      name="Final_Grade_Score"
                      precision="18"
                      scale="6" />
                    <externalMetadataColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].ExternalColumns[Module_status]"
                      codePage="1252"
                      dataType="str"
                      length="4"
                      name="Module_status" />
                    <externalMetadataColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].ExternalColumns[No.Of.Attempts]"
                      dataType="i4"
                      name="No.Of.Attempts" />
                    <externalMetadataColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].ExternalColumns[Credit_Units]"
                      dataType="numeric"
                      name="Credit_Units"
                      precision="8"
                      scale="6" />
                    <externalMetadataColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output].ExternalColumns[Semester]"
                      dataType="i4"
                      name="Semester" />
                  </externalMetadataColumns>
                </output>
                <output
                  refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Error Output]"
                  isErrorOut="true"
                  name="OLE DB Source Error Output">
                  <outputColumns>
                    <outputColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Error Output].Columns[Qual_Type]"
                      codePage="1252"
                      dataType="str"
                      length="4"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Error Output].Columns[Qual_Type]"
                      name="Qual_Type" />
                    <outputColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Error Output].Columns[Student_Id]"
                      codePage="1252"
                      dataType="str"
                      length="11"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Error Output].Columns[Student_Id]"
                      name="Student_Id" />
                    <outputColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Error Output].Columns[TERM]"
                      codePage="1252"
                      dataType="str"
                      length="4"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Error Output].Columns[TERM]"
                      name="TERM" />
                    <outputColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Error Output].Columns[Module_Code]"
                      codePage="1252"
                      dataType="str"
                      length="10"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Error Output].Columns[Module_Code]"
                      name="Module_Code" />
                    <outputColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Error Output].Columns[Average_Ca_Score]"
                      dataType="numeric"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Error Output].Columns[Average_Ca_Score]"
                      name="Average_Ca_Score"
                      precision="18"
                      scale="6" />
                    <outputColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Error Output].Columns[Average_Sa_Score]"
                      dataType="numeric"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Error Output].Columns[Average_Sa_Score]"
                      name="Average_Sa_Score"
                      precision="18"
                      scale="6" />
                    <outputColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Error Output].Columns[Final_Grade]"
                      codePage="1252"
                      dataType="str"
                      length="3"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Error Output].Columns[Final_Grade]"
                      name="Final_Grade" />
                    <outputColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Error Output].Columns[Final_Grade_Score]"
                      dataType="numeric"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Error Output].Columns[Final_Grade_Score]"
                      name="Final_Grade_Score"
                      precision="18"
                      scale="6" />
                    <outputColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Error Output].Columns[Module_status]"
                      codePage="1252"
                      dataType="str"
                      length="4"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Error Output].Columns[Module_status]"
                      name="Module_status" />
                    <outputColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Error Output].Columns[No.Of.Attempts]"
                      dataType="i4"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Error Output].Columns[No.Of.Attempts]"
                      name="No.Of.Attempts" />
                    <outputColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Error Output].Columns[Credit_Units]"
                      dataType="numeric"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Error Output].Columns[Credit_Units]"
                      name="Credit_Units"
                      precision="8"
                      scale="6" />
                    <outputColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Error Output].Columns[Semester]"
                      dataType="i4"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Error Output].Columns[Semester]"
                      name="Semester" />
                    <outputColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Error Output].Columns[ErrorCode]"
                      dataType="i4"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Error Output].Columns[ErrorCode]"
                      name="ErrorCode"
                      specialFlags="1" />
                    <outputColumn
                      refId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Error Output].Columns[ErrorColumn]"
                      dataType="i4"
                      lineageId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Error Output].Columns[ErrorColumn]"
                      name="ErrorColumn"
                      specialFlags="2" />
                  </outputColumns>
                  <externalMetadataColumns />
                </output>
              </outputs>
            </component>
          </components>
          <paths>
            <path
              refId="Package\DFT_ExportDMtoTXT.Paths[OLE DB Source Output]"
              endId="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput.Inputs[Flat File Destination Input]"
              name="OLE DB Source Output"
              startId="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM.Outputs[OLE DB Source Output]" />
          </paths>
        </pipeline>
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\ESQL_CreateETLJobLog"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{27AEAC01-A90C-43B9-BF73-8185D0C3BBF1}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="ESQL_CreateETLJobLog"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{4E74D30E-4295-488F-A407-AD1DC4921EC7}"
          SQLTask:SqlStatementSource="Exec [dbo].[usp_InsertETLJobLog] ?, ?, ?, ?" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
          <SQLTask:ParameterBinding
            SQLTask:ParameterName="0"
            SQLTask:DtsVariableName="User::Job_name"
            SQLTask:ParameterDirection="Input"
            SQLTask:DataType="129"
            SQLTask:ParameterSize="-1" />
          <SQLTask:ParameterBinding
            SQLTask:ParameterName="1"
            SQLTask:DtsVariableName="User::STAGE"
            SQLTask:ParameterDirection="Input"
            SQLTask:DataType="129"
            SQLTask:ParameterSize="-1" />
          <SQLTask:ParameterBinding
            SQLTask:ParameterName="2"
            SQLTask:DtsVariableName="User::SourceTable"
            SQLTask:ParameterDirection="Input"
            SQLTask:DataType="129"
            SQLTask:ParameterSize="-1" />
          <SQLTask:ParameterBinding
            SQLTask:ParameterName="3"
            SQLTask:DtsVariableName="User::TgtTableName"
            SQLTask:ParameterDirection="Input"
            SQLTask:DataType="129"
            SQLTask:ParameterSize="-1" />
        </SQLTask:SqlTaskData>
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\ESQL_GetProcessDate"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{5CF812F5-92CD-4A35-A61C-A4DA8FC2934A}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="ESQL_GetProcessDate"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{4E74D30E-4295-488F-A407-AD1DC4921EC7}"
          SQLTask:SqlStatementSource="Select getdate()"
          SQLTask:ResultType="ResultSetType_SingleRow" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
          <SQLTask:ResultBinding
            SQLTask:ResultName="0"
            SQLTask:DtsVariableName="User::Process_date" />
          <SQLTask:ParameterBinding
            SQLTask:ParameterName="0"
            SQLTask:DtsVariableName="User::Process_date"
            SQLTask:ParameterDirection="Input"
            SQLTask:DataType="135"
            SQLTask:ParameterSize="-1" />
        </SQLTask:SqlTaskData>
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\ESQL_Get_JOB_STATUS_ID"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{C4960380-D56F-4983-9EC4-16A3E39B314B}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="ESQL_Get_JOB_STATUS_ID"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{4E74D30E-4295-488F-A407-AD1DC4921EC7}"
          SQLTask:SqlStatementSource="SELECT max([JOB_STATUS_ID])&#xA;FROM [dbo].[ETL_JOB_STATUS] where [JOB_NAME]=? &#xA;and convert(varchar(8),CREATED_ON,112)=convert(varchar(8) ,getdate(),112)"
          SQLTask:ResultType="ResultSetType_SingleRow" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
          <SQLTask:ResultBinding
            SQLTask:ResultName="0"
            SQLTask:DtsVariableName="User::JOB_STATUS_ID" />
          <SQLTask:ParameterBinding
            SQLTask:ParameterName="0"
            SQLTask:DtsVariableName="User::Job_name"
            SQLTask:ParameterDirection="Input"
            SQLTask:DataType="129"
            SQLTask:ParameterSize="-1" />
        </SQLTask:SqlTaskData>
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\ESQL_LoadIntoDM"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{9809DA3C-9B25-40D1-A13B-079B61F960FB}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="ESQL_LoadIntoDM"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{4E74D30E-4295-488F-A407-AD1DC4921EC7}"
          SQLTask:SqlStmtSourceType="Variable"
          SQLTask:SqlStatementSource="User::SQL_DM_Load" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\ESQL_UpdateJobStatus"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{51B99F24-8EDD-4446-A93D-85110A3CA0BC}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="ESQL_UpdateJobStatus"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{4E74D30E-4295-488F-A407-AD1DC4921EC7}"
          SQLTask:SqlStatementSource="DECLARE &#xA;@jobstatusid INT&#xA;;&#xA;&#xA;select @jobstatusid=?;&#xA;&#xA;IF exists(select * from dbo.ETL_ERROR_LOG where [JOB_STATUS_ID]=@jobstatusid)&#xA; BEGIN&#xA; Update [dbo].[ETL_JOB_STATUS]&#xA;SET [PROCESSED_ON] =getdate(),&#xA;[JOB_STATUS]='Fail'&#xA;where [JOB_STATUS_ID]=@jobstatusid&#xA;  END&#xA;ELSE&#xA;BEGIN&#xA;Update [dbo].[ETL_JOB_STATUS]&#xA;SET [PROCESSED_ON] =getdate(),&#xA;[JOB_STATUS]='Success'&#xA;where [JOB_STATUS_ID]=@jobstatusid&#xA;END&#xA;;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
          <SQLTask:ParameterBinding
            SQLTask:ParameterName="0"
            SQLTask:DtsVariableName="User::JOB_STATUS_ID"
            SQLTask:ParameterDirection="Input"
            SQLTask:DataType="131"
            SQLTask:ParameterSize="-1" />
        </SQLTask:SqlTaskData>
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\ESQL_ValidateCurrentJobStatus"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{18C51914-4DB7-4BB3-B032-814BBCDDE142}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="ESQL_ValidateCurrentJobStatus"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{4E74D30E-4295-488F-A407-AD1DC4921EC7}"
          SQLTask:SqlStatementSource="SELECT CASE WHEN JOB_STATUS='Success' then 0 ELSE 1 END AS  JOB_STATUS&#xA;&#xA;from [dbo].[ETL_JOB_STATUS]&#xA;  where JOB_STATUS_ID = ?"
          SQLTask:ResultType="ResultSetType_SingleRow" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
          <SQLTask:ResultBinding
            SQLTask:ResultName="JOB_STATUS"
            SQLTask:DtsVariableName="User::Job_Status" />
          <SQLTask:ParameterBinding
            SQLTask:ParameterName="0"
            SQLTask:DtsVariableName="User::JOB_STATUS_ID"
            SQLTask:ParameterDirection="Input"
            SQLTask:DataType="131"
            SQLTask:ParameterSize="-1" />
        </SQLTask:SqlTaskData>
      </DTS:ObjectData>
    </DTS:Executable>
  </DTS:Executables>
  <DTS:PrecedenceConstraints>
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint]"
      DTS:CreationName=""
      DTS:DTSID="{B41E9D31-F8C5-407B-9915-028ADB6DB1EB}"
      DTS:From="Package\ESQL_LoadIntoDM"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint"
      DTS:To="Package\ESQL_UpdateJobStatus" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 1]"
      DTS:CreationName=""
      DTS:DTSID="{55D898B2-8D7E-412C-A9CF-064C5B0C40F0}"
      DTS:From="Package\ESQL_GetProcessDate"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 1"
      DTS:To="Package\ESQL_LoadIntoDM" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 2]"
      DTS:CreationName=""
      DTS:DTSID="{5AA3CE2E-E877-492A-B24D-EEAF47D962CA}"
      DTS:From="Package\ESQL_CreateETLJobLog"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 2"
      DTS:To="Package\ESQL_Get_JOB_STATUS_ID" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 3]"
      DTS:CreationName=""
      DTS:DTSID="{81DBD977-3AB7-445B-96C9-42018827107C}"
      DTS:From="Package\ESQL_Get_JOB_STATUS_ID"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 3"
      DTS:To="Package\ESQL_GetProcessDate" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 4]"
      DTS:CreationName=""
      DTS:DTSID="{424CE630-38BA-4C84-B13C-DCCA84144671}"
      DTS:From="Package\ESQL_UpdateJobStatus"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 4"
      DTS:To="Package\ESQL_ValidateCurrentJobStatus" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 5]"
      DTS:CreationName=""
      DTS:DTSID="{46671B47-FF8C-41E1-A6DE-D7DDC20F274D}"
      DTS:EvalOp="1"
      DTS:Expression="@[User::Job_Status]==0"
      DTS:From="Package\ESQL_ValidateCurrentJobStatus"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 5"
      DTS:To="Package\DFT_ExportDMtoTXT" />
  </DTS:PrecedenceConstraints>
  <DTS:EventHandlers>
    <DTS:EventHandler
      DTS:refId="Package.EventHandlers[OnError]"
      DTS:CreationName="OnError"
      DTS:DTSID="{471F204B-6871-43AE-901B-2C31357ABA80}"
      DTS:EventID="0"
      DTS:EventName="OnError"
      DTS:LocaleID="-1">
      <DTS:Variables>
        <DTS:Variable
          DTS:CreationName=""
          DTS:Description="The propagate property of the event"
          DTS:DTSID="{C97FFF78-D02D-450C-8169-3B6C673A36A1}"
          DTS:IncludeInDebugDump="6789"
          DTS:Namespace="System"
          DTS:ObjectName="Propagate">
          <DTS:VariableValue
            DTS:DataType="11">-1</DTS:VariableValue>
        </DTS:Variable>
      </DTS:Variables>
      <DTS:Executables>
        <DTS:Executable
          DTS:refId="Package.EventHandlers[OnError]\ETL_ERROR_LOG"
          DTS:CreationName="Microsoft.ExecuteSQLTask"
          DTS:Description="Execute SQL Task"
          DTS:DTSID="{797CB750-3F8E-4E3B-9F66-7C75D4EE0CF1}"
          DTS:ExecutableType="Microsoft.ExecuteSQLTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="ETL_ERROR_LOG">
          <DTS:Variables />
          <DTS:ObjectData>
            <SQLTask:SqlTaskData
              SQLTask:Connection="{4E74D30E-4295-488F-A407-AD1DC4921EC7}"
              SQLTask:SqlStatementSource="[dbo].[usp_InsertETLErrorLog] ?, ?" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="0"
                SQLTask:DtsVariableName="User::JOB_STATUS_ID"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="131"
                SQLTask:ParameterSize="-1" />
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="1"
                SQLTask:DtsVariableName="System::ErrorDescription"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="130"
                SQLTask:ParameterSize="-1" />
            </SQLTask:SqlTaskData>
          </DTS:ObjectData>
        </DTS:Executable>
      </DTS:Executables>
    </DTS:EventHandler>
  </DTS:EventHandlers>
  <DTS:DesignTimeProperties><![CDATA[<?xml version="1.0"?>
<!--This CDATA section contains the layout information of the package. The section includes information such as (x,y) coordinates, width, and height.-->
<!--If you manually edit this section and make a mistake, you can delete it. -->
<!--The package will still be able to load normally but the previous layout information will be lost and the designer will automatically re-arrange the elements on the design surface.-->
<Objects
  Version="8">
  <!--Each node below will contain properties that do not affect runtime behavior.-->
  <Package
    design-time-name="Package">
    <LayoutInfo>
      <GraphLayout
        Capacity="16" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:mssgm="clr-namespace:Microsoft.SqlServer.Graph.Model;assembly=Microsoft.SqlServer.Graph">
        <NodeLayout
          Size="185,42"
          Id="Package\DFT_ExportDMtoTXT"
          TopLeft="36,228" />
        <NodeLayout
          Size="204,42"
          Id="Package\ESQL_CreateETLJobLog"
          TopLeft="16,28" />
        <NodeLayout
          Size="226,42"
          Id="Package\ESQL_Get_JOB_STATUS_ID"
          TopLeft="282,27" />
        <NodeLayout
          Size="195,42"
          Id="Package\ESQL_GetProcessDate"
          TopLeft="611,29" />
        <NodeLayout
          Size="174,42"
          Id="Package\ESQL_LoadIntoDM"
          TopLeft="627,117" />
        <NodeLayout
          Size="199,42"
          Id="Package\ESQL_UpdateJobStatus"
          TopLeft="316,114" />
        <NodeLayout
          Size="240,42"
          Id="Package\ESQL_ValidateCurrentJobStatus"
          TopLeft="15,121" />
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint]"
          TopLeft="627,136.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{x:Null}"
              EndConnector="-112,0"
              Start="0,0"
              End="-104.5,0">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="-104.5,0" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 1]"
          TopLeft="711.25,71">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{x:Null}"
              EndConnector="0,46"
              Start="0,0"
              End="0,38.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,38.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 2]"
          TopLeft="220,48.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{x:Null}"
              EndConnector="62,0"
              Start="0,0"
              End="54.5,0">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="54.5,0" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 3]"
          TopLeft="508,49">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{x:Null}"
              EndConnector="103,0"
              Start="0,0"
              End="95.5,0">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="95.5,0" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 4]"
          TopLeft="316,138.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{x:Null}"
              EndConnector="-61,0"
              Start="0,0"
              End="-53.5,0">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="-53.5,0" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 5]"
          TopLeft="131.75,163">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{x:Null}"
              EndConnector="0,65"
              Start="0,0"
              End="0,57.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,57.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <mssgm:EdgeLabel
              BoundingBox="-8,20.75,16,16"
              RelativePosition="Any" />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </Package>
  <DtsEventHandler
    design-time-name="Package.EventHandlers[OnError]">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph">
        <NodeLayout
          Size="174,42"
          Id="Package.EventHandlers[OnError]\ETL_ERROR_LOG"
          TopLeft="5.5,5.5" />
      </GraphLayout>
    </LayoutInfo>
  </DtsEventHandler>
  <TaskHost
    design-time-name="Package\DFT_ExportDMtoTXT">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml">
        <NodeLayout
          Size="180,42"
          Id="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM"
          TopLeft="183,63" />
        <NodeLayout
          Size="181,42"
          Id="Package\DFT_ExportDMtoTXT\FF_DST_TextOutput"
          TopLeft="179,230" />
        <EdgeLayout
          Id="Package\DFT_ExportDMtoTXT.Paths[OLE DB Source Output]"
          TopLeft="271.25,105">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,125"
              Start="0,0"
              End="0,117.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,117.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </TaskHost>
  <PipelineComponentMetadata
    design-time-name="Package\DFT_ExportDMtoTXT\OLE_SRC_ReadDM">
    <Properties>
      <Property>
        <Name>DataSourceViewID</Name>
      </Property>
    </Properties>
  </PipelineComponentMetadata>
</Objects>]]></DTS:DesignTimeProperties>
</DTS:Executable>