<?xml version="1.0"?>
<DTS:Executable xmlns:DTS="www.microsoft.com/SqlServer/Dts"
  DTS:refId="Package"
  DTS:CreationDate="1/31/2019 4:40:18 PM"
  DTS:CreationName="Microsoft.Package"
  DTS:CreatorComputerName="NCS-140119GM07"
  DTS:CreatorName="NCS\P0500450"
  DTS:DTSID="{08F6F8E2-2DF1-4FB6-9CAF-4237B5A298A9}"
  DTS:ExecutableType="Microsoft.Package"
  DTS:LastModifiedProductVersion="15.0.0900.40"
  DTS:LocaleID="18441"
  DTS:ObjectName="DW_EXT_PFP"
  DTS:PackageType="5"
  DTS:VersionBuild="142"
  DTS:VersionGUID="{1A4F4C99-77B1-49FB-B120-FD112A9F455E}">
  <DTS:Property
    DTS:Name="PackageFormatVersion">8</DTS:Property>
  <DTS:ConnectionManagers>
    <DTS:ConnectionManager
      DTS:refId="Package.ConnectionManagers[RPDW_DW]"
      DTS:CreationName="OLEDB"
      DTS:DelayValidation="True"
      DTS:DTSID="{E7C8192A-D1F1-4E6F-B879-36215BD4EB9D}"
      DTS:ObjectName="RPDW_DW">
      <DTS:PropertyExpression
        DTS:Name="InitialCatalog">@[$Project::DW_Initial_Catalog]</DTS:PropertyExpression>
      <DTS:PropertyExpression
        DTS:Name="Password">@[$Project::Password]</DTS:PropertyExpression>
      <DTS:PropertyExpression
        DTS:Name="ServerName">@[$Project::ServerName]</DTS:PropertyExpression>
      <DTS:PropertyExpression
        DTS:Name="UserName">@[$Project::UserName]</DTS:PropertyExpression>
      <DTS:ObjectData>
        <DTS:ConnectionManager
          DTS:ConnectionString="Data Source=10.168.212.13;User ID=svc-dw-uat-etl;Initial Catalog=RPDW;Provider=SQLNCLI11.1;Integrated Security=SSPI;Auto Translate=False;">
          <DTS:Password
            DTS:Name="Password"
            Sensitive="1"
            Encrypted="1">AQAAANCMnd8BFdERjHoAwE/Cl+sBAAAAdGBqS7B1CkWG301g2fxV+wAAAAAIAAAARABUAFMAAAADZgAAwAAAABAAAAB5sYwEREADTZUydxI6woIKAAAAAASAAACgAAAAEAAAAK4Qdml2ax/vsqTLs5UX47AYAAAAFUAVnRnPs3nvEyO9F30Q73m6yc8UT9RcFAAAAM5vONVI5RFRD2ipbr1m+C+SGVK5</DTS:Password>
        </DTS:ConnectionManager>
      </DTS:ObjectData>
    </DTS:ConnectionManager>
    <DTS:ConnectionManager
      DTS:refId="Package.ConnectionManagers[RPDW_STG]"
      DTS:CreationName="OLEDB"
      DTS:DelayValidation="True"
      DTS:DTSID="{2EA3B035-3D33-4340-ADA2-581E306843AE}"
      DTS:ObjectName="RPDW_STG">
      <DTS:PropertyExpression
        DTS:Name="InitialCatalog">@[$Project::Staging_Initial_Catalog]</DTS:PropertyExpression>
      <DTS:PropertyExpression
        DTS:Name="Password">@[$Project::Password]</DTS:PropertyExpression>
      <DTS:PropertyExpression
        DTS:Name="ServerName">@[$Project::ServerName]</DTS:PropertyExpression>
      <DTS:PropertyExpression
        DTS:Name="UserName">@[$Project::UserName]</DTS:PropertyExpression>
      <DTS:ObjectData>
        <DTS:ConnectionManager
          DTS:ConnectionString="Data Source=10.168.212.13;User ID=svc-dw-uat-etl;Initial Catalog=RPDW_STG;Provider=SQLNCLI11.1;Integrated Security=SSPI;Auto Translate=False;">
          <DTS:Password
            DTS:Name="Password"
            Sensitive="1"
            Encrypted="1">AQAAANCMnd8BFdERjHoAwE/Cl+sBAAAAdGBqS7B1CkWG301g2fxV+wAAAAAIAAAARABUAFMAAAADZgAAwAAAABAAAAA3wPaS1+v+OqzefFbTF5D7AAAAAASAAACgAAAAEAAAAC3bj1PGlIdLmG/tuMKnj3MYAAAASIatqtjgug+XwvLUb3pz1CUa+b6BIrmOFAAAAHpflt+rU3NEOrjnbs4jxCypUu4j</DTS:Password>
        </DTS:ConnectionManager>
      </DTS:ObjectData>
    </DTS:ConnectionManager>
  </DTS:ConnectionManagers>
  <DTS:Variables>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{8422DF06-E286-4F5C-93EA-A4A5725EF2BD}"
      DTS:EvaluateAsExpression="True"
      DTS:Expression="&quot;BEGIN TRANSACTION&#xA;BEGIN TRY&#xA;------------&#xA;DECLARE @LastDWProcessdate datetime&#xA;,@processeddatetime datetime&#xA;,@jobstatusid varchar(5)&#xA;select @jobstatusid=&quot;+ (DT_STR, 5,1252) @[User::JobStatusId] +&quot;&#xA;select @LastDWProcessdate=isnull(max(Modified_on),'1900-01-01 00:00:00.000') from [dbo].[DW_EXT_PFP]&#xA;select  @processeddatetime= getdate()&#xA;&#xA;;WITH TMP_EXT&#xA;AS&#xA;(&#xA;SELECT &#xA;[SECONDARY SCHOOL]&#xA;,[STREAM CODE]&#xA;,[LANGUAGE MEDIUM]&#xA;,[UIN]&#xA;,[STATUTORY NAME]&#xA;,[HANPIYUIN NAME]&#xA;,[CITIZENSHIP]&#xA;,[BIRTH PLACE]&#xA;,[RELIGION CODE]&#xA;,[DATE OF BIRTH]&#xA;,[GENDER]&#xA;,[RACE CODE]&#xA;,[ADDRESS_1]&#xA;,[ADDRESS_2]&#xA;,[ADDRESS_3]&#xA;,[POSTAL CODE]&#xA;,[MOBILE NUMBER]&#xA;,[TELEPHONE NUMBER]&#xA;,[EMAIL]&#xA;,[FILLER]&#xA;,[EXAM YEAR]&#xA;,[NO. OF N LEVEL SUBJECTS]&#xA;,[NO. OF O LEVEL SUBJECTS]&#xA;,[NO. OF SUBJECTS ENTERED]&#xA;,[N LEVEL SUBJECT CODE 1]&#xA;,[N LEVEL GRADE 1]&#xA;,[N LEVEL SUBJECT CODE 2]&#xA;,[N LEVEL GRADE 2]&#xA;,[ N LEVEL SUBJECT CODE 3]&#xA;,[N LEVEL GRADE 3]&#xA;,[N LEVEL SUBJECT CODE 4]&#xA;,[N LEVEL GRADE 4]&#xA;,[N LEVEL SUBJECT CODE 5]&#xA;,[N LEVEL GRADE 5]&#xA;,[N LEVEL SUBJECT CODE 6]&#xA;,[N LEVEL GRADE 6]&#xA;,[N LEVEL SUBJECT CODE 7]&#xA;,[N LEVEL GRADE 7]&#xA;,[N LEVEL SUBJECT CODE 8]&#xA;,[N LEVEL GRADE 8]&#xA;,[N LEVEL SUBJECT CODE 9]&#xA;,[N LEVEL GRADE 9]&#xA;,[N LEVEL SUBJECT CODE 10]&#xA;,[N LEVEL GRADE 10]&#xA;,[N LEVEL SUBJECT CODE 11]&#xA;,[N LEVEL GRADE 11]&#xA;,[N LEVEL SUBJECT CODE 12]&#xA;,[N LEVEL GRADE 12]&#xA;,[O LEVEL SUBJECT CODE_1]&#xA;,[O LEVEL GRADE_1]&#xA;,[O LEVEL GRADE POINT_1]&#xA;,[O LEVEL SUBJECT CODE_2]&#xA;,[O LEVEL GRADE_2]&#xA;,[O LEVEL GRADE POINT_2]&#xA;,[O LEVEL SUBJECT CODE_3]&#xA;,[O LEVEL GRADE_3]&#xA;,[O LEVEL GRADE POINT_3]&#xA;,[O LEVEL SUBJECT CODE_4]&#xA;,[O LEVEL GRADE_4]&#xA;,[O LEVEL GRADE POINT_4]&#xA;,[O LEVEL SUBJECT CODE_5]&#xA;,[O LEVEL GRADE_5]&#xA;,[O LEVEL GRADE POINT_5]&#xA;,[O LEVEL SUBJECT CODE_6]&#xA;,[O LEVEL GRADE_6]&#xA;,[O LEVEL GRADE POINT_6]&#xA;,[O LEVEL SUBJECT CODE_7]&#xA;,[O LEVEL GRADE_7]&#xA;,[O LEVEL GRADE POINT_7]&#xA;,[O LEVEL SUBJECT CODE_8]&#xA;,[O LEVEL GRADE_8]&#xA;,[O LEVEL GRADE POINT_8]&#xA;,[O LEVEL SUBJECT CODE_9]&#xA;,[O LEVEL GRADE_9]&#xA;,[O LEVEL GRADE POINT_9]&#xA;,[O LEVEL SUBJECT CODE_10]&#xA;,[O LEVEL GRADE_10]&#xA;,[O LEVEL GRADE POINT_10]&#xA;,[O LEVEL SUBJECT CODE_11]&#xA;,[O LEVEL GRADE_11]&#xA;,[O LEVEL GRADE POINT_11]&#xA;,[O LEVEL SUBJECT CODE_12]&#xA;,[O LEVEL GRADE_12]&#xA;,[O LEVEL GRADE POINT_12]&#xA;,[CCA GRADE]&#xA;,[ELMAB3 RAW AGGREGATE ]&#xA;,[ELMAB3 NET AGGREGATE ]&#xA;,[ENGLISH CODE]&#xA;,[MATHS CODE]&#xA;,[GROUP 1-RELEVANT SUBJECT]&#xA;,[GROUP 2-RELEVANT SUBJECT]&#xA;,[ENGLISH GRADE]&#xA;,[MATHS GRADE]&#xA;,[GROUP 1-RELEVANT GRADE]&#xA;,[GROUP 2-RELEVANT GRADE]&#xA;,[NO. OF N LEVEL GRADE 1 SUBJECTS]&#xA;,[NO. OF N LEVEL GRADE 2 SUBJECTS]&#xA;,[NO. OF N LEVEL GRADE 3 SUBJECTS]&#xA;,[NO. OF N LEVEL GRADE 4 SUBJECTS]&#xA;,[NO. OF N LEVEL GRADE 5 SUBJECTS]&#xA;,[NO. OF N LEVEL GRADE 6 SUBJECTS]&#xA;,[NO. OF O LEVEL GRADE 1 SUBJECTS]&#xA;,[NO. OF O LEVEL GRADE 2 SUBJECTS]&#xA;,[NO. OF O LEVEL GRADE 3 SUBJECTS]&#xA;,[NO. OF O LEVEL GRADE 4 SUBJECTS]&#xA;,[NO. OF O LEVEL GRADE 5 SUBJECTS]&#xA;,[NO. OF O LEVEL GRADE 6 SUBJECTS]&#xA;,[FILLER_1]&#xA;,[CHOICE EXERCISE]&#xA;,[COURSE CHOICE_1]&#xA;,[COURSE ORDER 1]&#xA;,[COURSE CHOICE_2]&#xA;,[COURSE ORDER_2]&#xA;,[COURSE CHOICE_3]&#xA;,[COURSE ORDER_3]&#xA;,[COURSE CHOICE_4]&#xA;,[COURSE ORDER_4]&#xA;,[COURSE CHOICE_5]&#xA;,[COURSE ORDER_5]&#xA;,[APPEAL COURSE CODE_1]&#xA;,[APPEAL COURSE ORDER_1]&#xA;,[APPEAL COURSE CODE_2]&#xA;,[APPEAL COURSE ORDER_2]&#xA;,[APPEAL COURSE CODE_3]&#xA;,[APPEAL COURSE ORDER_3]&#xA;,[ROUND 1 POSTED COURSE CHOICE]&#xA;,[ROUND 1 POSTED COURSE CENTRE]&#xA;,[ROUND 1 POSTED CHOICE ORDER]&#xA;,[APPEAL POSTED COURSE]&#xA;,[APPEAL POSTED CENTRE]&#xA;,[APPEAL POSTED CHOICE ORDER]&#xA;,[POSTED EXERCISE]&#xA;,[POSTED COURSE]&#xA;,[POSTED CENTRE CODE]&#xA;,[POSTED CHOICE ORDER]&#xA;,[FINAL RAW SCORE]&#xA;,[FINAL NET SCORE]&#xA;,[FILLER_3]&#xA;,[TECH ELIGIBILITY ]&#xA;,[NON TECH ELIGIBILITY ]&#xA;,[ELIGIBLE COURSES]&#xA;,[FILLER_4]&#xA;,[COURSE ACCEPTANCE]&#xA;,[TECH_ELIGIBILITY2]&#xA;,[TECH_ELIGIBILITY3]&#xA;,[TECH_ELIGIBILITY4]&#xA;,[TECH_ELIGIBILITY5]&#xA;,[TECH_ELIGIBILITY6]&#xA;,[File_Name]&#xA;,[CREATED_ON]&#xA;,[MODIFIED_ON]&#xA;,[AY_YEAR]&#xA;,[AY_SEM]&#xA;  FROM &quot;+@[$Project::Staging_Initial_Catalog]+&quot;.[dbo].[STG_EXT_PFP]&#xA;   where [Latest_Ind] ='Y' &#xA;AND [MODIFIED_ON]&gt;@LastDWProcessdate&#xA;)&#xA;&#xA;&#xA;MERGE INTO [DW_EXT_PFP] AS DST&#xA;   USING TMP_EXT AS SRC&#xA;  ON (&#xA;  SRC. [AY_SEM] = DST.[AY_SEM] AND   SRC. [AY_YEAR] = DST.[AY_YEAR] AND   SRC. [DATE OF BIRTH] = DST.[DATE OF BIRTH] AND   SRC. [EXAM YEAR] = DST.[EXAM YEAR] AND   SRC. [POSTAL CODE] = DST.[POSTAL CODE] AND   SRC. [UIN] = DST.[UIN]&#xA;     )&#xA;&#xA;   WHEN NOT MATCHED THEN&#xA;   INSERT&#xA;&#x9;(&#xA;[SECONDARY SCHOOL]&#xA;,[STREAM CODE]&#xA;,[LANGUAGE MEDIUM]&#xA;,[UIN]&#xA;,[STATUTORY NAME]&#xA;,[HANPIYUIN NAME]&#xA;,[CITIZENSHIP]&#xA;,[BIRTH PLACE]&#xA;,[RELIGION CODE]&#xA;,[DATE OF BIRTH]&#xA;,[GENDER]&#xA;,[RACE CODE]&#xA;,[ADDRESS_1]&#xA;,[ADDRESS_2]&#xA;,[ADDRESS_3]&#xA;,[POSTAL CODE]&#xA;,[MOBILE NUMBER]&#xA;,[TELEPHONE NUMBER]&#xA;,[EMAIL]&#xA;,[FILLER]&#xA;,[EXAM YEAR]&#xA;,[NO. OF N LEVEL SUBJECTS]&#xA;,[NO. OF O LEVEL SUBJECTS]&#xA;,[NO. OF SUBJECTS ENTERED]&#xA;,[N LEVEL SUBJECT CODE 1]&#xA;,[N LEVEL GRADE 1]&#xA;,[N LEVEL SUBJECT CODE 2]&#xA;,[N LEVEL GRADE 2]&#xA;,[ N LEVEL SUBJECT CODE 3]&#xA;,[N LEVEL GRADE 3]&#xA;,[N LEVEL SUBJECT CODE 4]&#xA;,[N LEVEL GRADE 4]&#xA;,[N LEVEL SUBJECT CODE 5]&#xA;,[N LEVEL GRADE 5]&#xA;,[N LEVEL SUBJECT CODE 6]&#xA;,[N LEVEL GRADE 6]&#xA;,[N LEVEL SUBJECT CODE 7]&#xA;,[N LEVEL GRADE 7]&#xA;,[N LEVEL SUBJECT CODE 8]&#xA;,[N LEVEL GRADE 8]&#xA;,[N LEVEL SUBJECT CODE 9]&#xA;,[N LEVEL GRADE 9]&#xA;,[N LEVEL SUBJECT CODE 10]&#xA;,[N LEVEL GRADE 10]&#xA;,[N LEVEL SUBJECT CODE 11]&#xA;,[N LEVEL GRADE 11]&#xA;,[N LEVEL SUBJECT CODE 12]&#xA;,[N LEVEL GRADE 12]&#xA;,[O LEVEL SUBJECT CODE_1]&#xA;,[O LEVEL GRADE_1]&#xA;,[O LEVEL GRADE POINT_1]&#xA;,[O LEVEL SUBJECT CODE_2]&#xA;,[O LEVEL GRADE_2]&#xA;,[O LEVEL GRADE POINT_2]&#xA;,[O LEVEL SUBJECT CODE_3]&#xA;,[O LEVEL GRADE_3]&#xA;,[O LEVEL GRADE POINT_3]&#xA;,[O LEVEL SUBJECT CODE_4]&#xA;,[O LEVEL GRADE_4]&#xA;,[O LEVEL GRADE POINT_4]&#xA;,[O LEVEL SUBJECT CODE_5]&#xA;,[O LEVEL GRADE_5]&#xA;,[O LEVEL GRADE POINT_5]&#xA;,[O LEVEL SUBJECT CODE_6]&#xA;,[O LEVEL GRADE_6]&#xA;,[O LEVEL GRADE POINT_6]&#xA;,[O LEVEL SUBJECT CODE_7]&#xA;,[O LEVEL GRADE_7]&#xA;,[O LEVEL GRADE POINT_7]&#xA;,[O LEVEL SUBJECT CODE_8]&#xA;,[O LEVEL GRADE_8]&#xA;,[O LEVEL GRADE POINT_8]&#xA;,[O LEVEL SUBJECT CODE_9]&#xA;,[O LEVEL GRADE_9]&#xA;,[O LEVEL GRADE POINT_9]&#xA;,[O LEVEL SUBJECT CODE_10]&#xA;,[O LEVEL GRADE_10]&#xA;,[O LEVEL GRADE POINT_10]&#xA;,[O LEVEL SUBJECT CODE_11]&#xA;,[O LEVEL GRADE_11]&#xA;,[O LEVEL GRADE POINT_11]&#xA;,[O LEVEL SUBJECT CODE_12]&#xA;,[O LEVEL GRADE_12]&#xA;,[O LEVEL GRADE POINT_12]&#xA;,[CCA GRADE]&#xA;,[ELMAB3 RAW AGGREGATE ]&#xA;,[ELMAB3 NET AGGREGATE ]&#xA;,[ENGLISH CODE]&#xA;,[MATHS CODE]&#xA;,[GROUP 1-RELEVANT SUBJECT]&#xA;,[GROUP 2-RELEVANT SUBJECT]&#xA;,[ENGLISH GRADE]&#xA;,[MATHS GRADE]&#xA;,[GROUP 1-RELEVANT GRADE]&#xA;,[GROUP 2-RELEVANT GRADE]&#xA;,[NO. OF N LEVEL GRADE 1 SUBJECTS]&#xA;,[NO. OF N LEVEL GRADE 2 SUBJECTS]&#xA;,[NO. OF N LEVEL GRADE 3 SUBJECTS]&#xA;,[NO. OF N LEVEL GRADE 4 SUBJECTS]&#xA;,[NO. OF N LEVEL GRADE 5 SUBJECTS]&#xA;,[NO. OF N LEVEL GRADE 6 SUBJECTS]&#xA;,[NO. OF O LEVEL GRADE 1 SUBJECTS]&#xA;,[NO. OF O LEVEL GRADE 2 SUBJECTS]&#xA;,[NO. OF O LEVEL GRADE 3 SUBJECTS]&#xA;,[NO. OF O LEVEL GRADE 4 SUBJECTS]&#xA;,[NO. OF O LEVEL GRADE 5 SUBJECTS]&#xA;,[NO. OF O LEVEL GRADE 6 SUBJECTS]&#xA;,[FILLER_1]&#xA;,[CHOICE EXERCISE]&#xA;,[COURSE CHOICE_1]&#xA;,[COURSE ORDER 1]&#xA;,[COURSE CHOICE_2]&#xA;,[COURSE ORDER_2]&#xA;,[COURSE CHOICE_3]&#xA;,[COURSE ORDER_3]&#xA;,[COURSE CHOICE_4]&#xA;,[COURSE ORDER_4]&#xA;,[COURSE CHOICE_5]&#xA;,[COURSE ORDER_5]&#xA;,[APPEAL COURSE CODE_1]&#xA;,[APPEAL COURSE ORDER_1]&#xA;,[APPEAL COURSE CODE_2]&#xA;,[APPEAL COURSE ORDER_2]&#xA;,[APPEAL COURSE CODE_3]&#xA;,[APPEAL COURSE ORDER_3]&#xA;,[ROUND 1 POSTED COURSE CHOICE]&#xA;,[ROUND 1 POSTED COURSE CENTRE]&#xA;,[ROUND 1 POSTED CHOICE ORDER]&#xA;,[APPEAL POSTED COURSE]&#xA;,[APPEAL POSTED CENTRE]&#xA;,[APPEAL POSTED CHOICE ORDER]&#xA;,[POSTED EXERCISE]&#xA;,[POSTED COURSE]&#xA;,[POSTED CENTRE CODE]&#xA;,[POSTED CHOICE ORDER]&#xA;,[FINAL RAW SCORE]&#xA;,[FINAL NET SCORE]&#xA;,[FILLER_3]&#xA;,[TECH ELIGIBILITY ]&#xA;,[NON TECH ELIGIBILITY ]&#xA;,[ELIGIBLE COURSES]&#xA;,[FILLER_4]&#xA;,[COURSE ACCEPTANCE]&#xA;,[TECH_ELIGIBILITY2]&#xA;,[TECH_ELIGIBILITY3]&#xA;,[TECH_ELIGIBILITY4]&#xA;,[TECH_ELIGIBILITY5]&#xA;,[TECH_ELIGIBILITY6]&#xA;,[File_Name]&#xA;,[CREATED_ON]&#xA;,[MODIFIED_ON]&#xA;,[AY_YEAR]&#xA;,[AY_SEM]&#xA;&#x9;  )&#xA;VALUES&#xA;&#x9;(  &#xA; src.[SECONDARY SCHOOL]&#xA;,src.[STREAM CODE]&#xA;,src.[LANGUAGE MEDIUM]&#xA;,src.[UIN]&#xA;,src.[STATUTORY NAME]&#xA;,src.[HANPIYUIN NAME]&#xA;,src.[CITIZENSHIP]&#xA;,src.[BIRTH PLACE]&#xA;,src.[RELIGION CODE]&#xA;,src.[DATE OF BIRTH]&#xA;,src.[GENDER]&#xA;,src.[RACE CODE]&#xA;,src.[ADDRESS_1]&#xA;,src.[ADDRESS_2]&#xA;,src.[ADDRESS_3]&#xA;,src.[POSTAL CODE]&#xA;,src.[MOBILE NUMBER]&#xA;,src.[TELEPHONE NUMBER]&#xA;,src.[EMAIL]&#xA;,src.[FILLER]&#xA;,src.[EXAM YEAR]&#xA;,src.[NO. OF N LEVEL SUBJECTS]&#xA;,src.[NO. OF O LEVEL SUBJECTS]&#xA;,src.[NO. OF SUBJECTS ENTERED]&#xA;,src.[N LEVEL SUBJECT CODE 1]&#xA;,src.[N LEVEL GRADE 1]&#xA;,src.[N LEVEL SUBJECT CODE 2]&#xA;,src.[N LEVEL GRADE 2]&#xA;,src.[ N LEVEL SUBJECT CODE 3]&#xA;,src.[N LEVEL GRADE 3]&#xA;,src.[N LEVEL SUBJECT CODE 4]&#xA;,src.[N LEVEL GRADE 4]&#xA;,src.[N LEVEL SUBJECT CODE 5]&#xA;,src.[N LEVEL GRADE 5]&#xA;,src.[N LEVEL SUBJECT CODE 6]&#xA;,src.[N LEVEL GRADE 6]&#xA;,src.[N LEVEL SUBJECT CODE 7]&#xA;,src.[N LEVEL GRADE 7]&#xA;,src.[N LEVEL SUBJECT CODE 8]&#xA;,src.[N LEVEL GRADE 8]&#xA;,src.[N LEVEL SUBJECT CODE 9]&#xA;,src.[N LEVEL GRADE 9]&#xA;,src.[N LEVEL SUBJECT CODE 10]&#xA;,src.[N LEVEL GRADE 10]&#xA;,src.[N LEVEL SUBJECT CODE 11]&#xA;,src.[N LEVEL GRADE 11]&#xA;,src.[N LEVEL SUBJECT CODE 12]&#xA;,src.[N LEVEL GRADE 12]&#xA;,src.[O LEVEL SUBJECT CODE_1]&#xA;,src.[O LEVEL GRADE_1]&#xA;,src.[O LEVEL GRADE POINT_1]&#xA;,src.[O LEVEL SUBJECT CODE_2]&#xA;,src.[O LEVEL GRADE_2]&#xA;,src.[O LEVEL GRADE POINT_2]&#xA;,src.[O LEVEL SUBJECT CODE_3]&#xA;,src.[O LEVEL GRADE_3]&#xA;,src.[O LEVEL GRADE POINT_3]&#xA;,src.[O LEVEL SUBJECT CODE_4]&#xA;,src.[O LEVEL GRADE_4]&#xA;,src.[O LEVEL GRADE POINT_4]&#xA;,src.[O LEVEL SUBJECT CODE_5]&#xA;,src.[O LEVEL GRADE_5]&#xA;,src.[O LEVEL GRADE POINT_5]&#xA;,src.[O LEVEL SUBJECT CODE_6]&#xA;,src.[O LEVEL GRADE_6]&#xA;,src.[O LEVEL GRADE POINT_6]&#xA;,src.[O LEVEL SUBJECT CODE_7]&#xA;,src.[O LEVEL GRADE_7]&#xA;,src.[O LEVEL GRADE POINT_7]&#xA;,src.[O LEVEL SUBJECT CODE_8]&#xA;,src.[O LEVEL GRADE_8]&#xA;,src.[O LEVEL GRADE POINT_8]&#xA;,src.[O LEVEL SUBJECT CODE_9]&#xA;,src.[O LEVEL GRADE_9]&#xA;,src.[O LEVEL GRADE POINT_9]&#xA;,src.[O LEVEL SUBJECT CODE_10]&#xA;,src.[O LEVEL GRADE_10]&#xA;,src.[O LEVEL GRADE POINT_10]&#xA;,src.[O LEVEL SUBJECT CODE_11]&#xA;,src.[O LEVEL GRADE_11]&#xA;,src.[O LEVEL GRADE POINT_11]&#xA;,src.[O LEVEL SUBJECT CODE_12]&#xA;,src.[O LEVEL GRADE_12]&#xA;,src.[O LEVEL GRADE POINT_12]&#xA;,src.[CCA GRADE]&#xA;,src.[ELMAB3 RAW AGGREGATE ]&#xA;,src.[ELMAB3 NET AGGREGATE ]&#xA;,src.[ENGLISH CODE]&#xA;,src.[MATHS CODE]&#xA;,src.[GROUP 1-RELEVANT SUBJECT]&#xA;,src.[GROUP 2-RELEVANT SUBJECT]&#xA;,src.[ENGLISH GRADE]&#xA;,src.[MATHS GRADE]&#xA;,src.[GROUP 1-RELEVANT GRADE]&#xA;,src.[GROUP 2-RELEVANT GRADE]&#xA;,src.[NO. OF N LEVEL GRADE 1 SUBJECTS]&#xA;,src.[NO. OF N LEVEL GRADE 2 SUBJECTS]&#xA;,src.[NO. OF N LEVEL GRADE 3 SUBJECTS]&#xA;,src.[NO. OF N LEVEL GRADE 4 SUBJECTS]&#xA;,src.[NO. OF N LEVEL GRADE 5 SUBJECTS]&#xA;,src.[NO. OF N LEVEL GRADE 6 SUBJECTS]&#xA;,src.[NO. OF O LEVEL GRADE 1 SUBJECTS]&#xA;,src.[NO. OF O LEVEL GRADE 2 SUBJECTS]&#xA;,src.[NO. OF O LEVEL GRADE 3 SUBJECTS]&#xA;,src.[NO. OF O LEVEL GRADE 4 SUBJECTS]&#xA;,src.[NO. OF O LEVEL GRADE 5 SUBJECTS]&#xA;,src.[NO. OF O LEVEL GRADE 6 SUBJECTS]&#xA;,src.[FILLER_1]&#xA;,src.[CHOICE EXERCISE]&#xA;,src.[COURSE CHOICE_1]&#xA;,src.[COURSE ORDER 1]&#xA;,src.[COURSE CHOICE_2]&#xA;,src.[COURSE ORDER_2]&#xA;,src.[COURSE CHOICE_3]&#xA;,src.[COURSE ORDER_3]&#xA;,src.[COURSE CHOICE_4]&#xA;,src.[COURSE ORDER_4]&#xA;,src.[COURSE CHOICE_5]&#xA;,src.[COURSE ORDER_5]&#xA;,src.[APPEAL COURSE CODE_1]&#xA;,src.[APPEAL COURSE ORDER_1]&#xA;,src.[APPEAL COURSE CODE_2]&#xA;,src.[APPEAL COURSE ORDER_2]&#xA;,src.[APPEAL COURSE CODE_3]&#xA;,src.[APPEAL COURSE ORDER_3]&#xA;,src.[ROUND 1 POSTED COURSE CHOICE]&#xA;,src.[ROUND 1 POSTED COURSE CENTRE]&#xA;,src.[ROUND 1 POSTED CHOICE ORDER]&#xA;,src.[APPEAL POSTED COURSE]&#xA;,src.[APPEAL POSTED CENTRE]&#xA;,src.[APPEAL POSTED CHOICE ORDER]&#xA;,src.[POSTED EXERCISE]&#xA;,src.[POSTED COURSE]&#xA;,src.[POSTED CENTRE CODE]&#xA;,src.[POSTED CHOICE ORDER]&#xA;,src.[FINAL RAW SCORE]&#xA;,src.[FINAL NET SCORE]&#xA;,src.[FILLER_3]&#xA;,src.[TECH ELIGIBILITY ]&#xA;,src.[NON TECH ELIGIBILITY ]&#xA;,src.[ELIGIBLE COURSES]&#xA;,src.[FILLER_4]&#xA;,src.[COURSE ACCEPTANCE]&#xA;,src.[TECH_ELIGIBILITY2]&#xA;,src.[TECH_ELIGIBILITY3]&#xA;,src.[TECH_ELIGIBILITY4]&#xA;,src.[TECH_ELIGIBILITY5]&#xA;,src.[TECH_ELIGIBILITY6]&#xA;,src.[File_Name]&#xA;,src.[CREATED_ON]&#xA;,src.[MODIFIED_ON]&#xA;,src.[AY_YEAR]&#xA;,src.[AY_SEM]&#xA;&#xA;&#x9;)&#xA;   WHEN MATCHED&#xA;   &#xA;   THEN UPDATE&#xA;   SET &#x9; &#xA; dst.[EXAM YEAR] = isnull(src.[EXAM YEAR],' '),&#xA;dst.[NO. OF N LEVEL SUBJECTS] = isnull(src.[NO. OF N LEVEL SUBJECTS],' '),&#xA;dst.[NO. OF O LEVEL SUBJECTS] = isnull(src.[NO. OF O LEVEL SUBJECTS],' '),&#xA;dst.[NO. OF SUBJECTS ENTERED] = isnull(src.[NO. OF SUBJECTS ENTERED],' '),&#xA;dst.[N LEVEL SUBJECT CODE 1] = isnull(src.[N LEVEL SUBJECT CODE 1],' '),&#xA;dst.[N LEVEL GRADE 1] = isnull(src.[N LEVEL GRADE 1],' '),&#xA;dst.[N LEVEL SUBJECT CODE 2] = isnull(src.[N LEVEL SUBJECT CODE 2],' '),&#xA;dst.[N LEVEL GRADE 2] = isnull(src.[N LEVEL GRADE 2],' '),&#xA;dst.[ N LEVEL SUBJECT CODE 3] = isnull(src.[ N LEVEL SUBJECT CODE 3],' '),&#xA;dst.[N LEVEL GRADE 3] = isnull(src.[N LEVEL GRADE 3],' '),&#xA;dst.[N LEVEL SUBJECT CODE 4] = isnull(src.[N LEVEL SUBJECT CODE 4],' '),&#xA;dst.[N LEVEL GRADE 4] = isnull(src.[N LEVEL GRADE 4],' '),&#xA;dst.[N LEVEL SUBJECT CODE 5] = isnull(src.[N LEVEL SUBJECT CODE 5],' '),&#xA;dst.[N LEVEL GRADE 5] = isnull(src.[N LEVEL GRADE 5],' '),&#xA;dst.[N LEVEL SUBJECT CODE 6] = isnull(src.[N LEVEL SUBJECT CODE 6],' '),&#xA;dst.[N LEVEL GRADE 6] = isnull(src.[N LEVEL GRADE 6],' '),&#xA;dst.[N LEVEL SUBJECT CODE 7] = isnull(src.[N LEVEL SUBJECT CODE 7],' '),&#xA;dst.[N LEVEL GRADE 7] = isnull(src.[N LEVEL GRADE 7],' '),&#xA;dst.[N LEVEL SUBJECT CODE 8] = isnull(src.[N LEVEL SUBJECT CODE 8],' '),&#xA;dst.[N LEVEL GRADE 8] = isnull(src.[N LEVEL GRADE 8],' '),&#xA;dst.[N LEVEL SUBJECT CODE 9] = isnull(src.[N LEVEL SUBJECT CODE 9],' '),&#xA;dst.[N LEVEL GRADE 9] = isnull(src.[N LEVEL GRADE 9],' '),&#xA;dst.[N LEVEL SUBJECT CODE 10] = isnull(src.[N LEVEL SUBJECT CODE 10],' '),&#xA;dst.[N LEVEL GRADE 10] = isnull(src.[N LEVEL GRADE 10],' '),&#xA;dst.[N LEVEL SUBJECT CODE 11] = isnull(src.[N LEVEL SUBJECT CODE 11],' '),&#xA;dst.[N LEVEL GRADE 11] = isnull(src.[N LEVEL GRADE 11],' '),&#xA;dst.[N LEVEL SUBJECT CODE 12] = isnull(src.[N LEVEL SUBJECT CODE 12],' '),&#xA;dst.[N LEVEL GRADE 12] = isnull(src.[N LEVEL GRADE 12],' '),&#xA;dst.[O LEVEL SUBJECT CODE_1] = isnull(src.[O LEVEL SUBJECT CODE_1],' '),&#xA;dst.[O LEVEL GRADE_1] = isnull(src.[O LEVEL GRADE_1],' '),&#xA;dst.[O LEVEL GRADE POINT_1] = isnull(src.[O LEVEL GRADE POINT_1],' '),&#xA;dst.[O LEVEL SUBJECT CODE_2] = isnull(src.[O LEVEL SUBJECT CODE_2],' '),&#xA;dst.[O LEVEL GRADE_2] = isnull(src.[O LEVEL GRADE_2],' '),&#xA;dst.[O LEVEL GRADE POINT_2] = isnull(src.[O LEVEL GRADE POINT_2],' '),&#xA;dst.[O LEVEL SUBJECT CODE_3] = isnull(src.[O LEVEL SUBJECT CODE_3],' '),&#xA;dst.[O LEVEL GRADE_3] = isnull(src.[O LEVEL GRADE_3],' '),&#xA;dst.[O LEVEL GRADE POINT_3] = isnull(src.[O LEVEL GRADE POINT_3],' '),&#xA;dst.[O LEVEL SUBJECT CODE_4] = isnull(src.[O LEVEL SUBJECT CODE_4],' '),&#xA;dst.[O LEVEL GRADE_4] = isnull(src.[O LEVEL GRADE_4],' '),&#xA;dst.[O LEVEL GRADE POINT_4] = isnull(src.[O LEVEL GRADE POINT_4],' '),&#xA;dst.[O LEVEL SUBJECT CODE_5] = isnull(src.[O LEVEL SUBJECT CODE_5],' '),&#xA;dst.[O LEVEL GRADE_5] = isnull(src.[O LEVEL GRADE_5],' '),&#xA;dst.[O LEVEL GRADE POINT_5] = isnull(src.[O LEVEL GRADE POINT_5],' '),&#xA;dst.[O LEVEL SUBJECT CODE_6] = isnull(src.[O LEVEL SUBJECT CODE_6],' '),&#xA;dst.[O LEVEL GRADE_6] = isnull(src.[O LEVEL GRADE_6],' '),&#xA;dst.[O LEVEL GRADE POINT_6] = isnull(src.[O LEVEL GRADE POINT_6],' '),&#xA;dst.[O LEVEL SUBJECT CODE_7] = isnull(src.[O LEVEL SUBJECT CODE_7],' '),&#xA;dst.[O LEVEL GRADE_7] = isnull(src.[O LEVEL GRADE_7],' '),&#xA;dst.[O LEVEL GRADE POINT_7] = isnull(src.[O LEVEL GRADE POINT_7],' '),&#xA;dst.[O LEVEL SUBJECT CODE_8] = isnull(src.[O LEVEL SUBJECT CODE_8],' '),&#xA;dst.[O LEVEL GRADE_8] = isnull(src.[O LEVEL GRADE_8],' '),&#xA;dst.[O LEVEL GRADE POINT_8] = isnull(src.[O LEVEL GRADE POINT_8],' '),&#xA;dst.[O LEVEL SUBJECT CODE_9] = isnull(src.[O LEVEL SUBJECT CODE_9],' '),&#xA;dst.[O LEVEL GRADE_9] = isnull(src.[O LEVEL GRADE_9],' '),&#xA;dst.[O LEVEL GRADE POINT_9] = isnull(src.[O LEVEL GRADE POINT_9],' '),&#xA;dst.[O LEVEL SUBJECT CODE_10] = isnull(src.[O LEVEL SUBJECT CODE_10],' '),&#xA;dst.[O LEVEL GRADE_10] = isnull(src.[O LEVEL GRADE_10],' '),&#xA;dst.[O LEVEL GRADE POINT_10] = isnull(src.[O LEVEL GRADE POINT_10],' '),&#xA;dst.[O LEVEL SUBJECT CODE_11] = isnull(src.[O LEVEL SUBJECT CODE_11],' '),&#xA;dst.[O LEVEL GRADE_11] = isnull(src.[O LEVEL GRADE_11],' '),&#xA;dst.[O LEVEL GRADE POINT_11] = isnull(src.[O LEVEL GRADE POINT_11],' '),&#xA;dst.[O LEVEL SUBJECT CODE_12] = isnull(src.[O LEVEL SUBJECT CODE_12],' '),&#xA;dst.[O LEVEL GRADE_12] = isnull(src.[O LEVEL GRADE_12],' '),&#xA;dst.[O LEVEL GRADE POINT_12] = isnull(src.[O LEVEL GRADE POINT_12],' '),&#xA;dst.[CCA GRADE] = isnull(src.[CCA GRADE],' '),&#xA;dst.[ELMAB3 RAW AGGREGATE ] = isnull(src.[ELMAB3 RAW AGGREGATE ],' '),&#xA;dst.[ELMAB3 NET AGGREGATE ] = isnull(src.[ELMAB3 NET AGGREGATE ],' '),&#xA;dst.[ENGLISH CODE] = isnull(src.[ENGLISH CODE],' '),&#xA;dst.[MATHS CODE] = isnull(src.[MATHS CODE],' '),&#xA;dst.[GROUP 1-RELEVANT SUBJECT] = isnull(src.[GROUP 1-RELEVANT SUBJECT],' '),&#xA;dst.[GROUP 2-RELEVANT SUBJECT] = isnull(src.[GROUP 2-RELEVANT SUBJECT],' '),&#xA;dst.[ENGLISH GRADE] = isnull(src.[ENGLISH GRADE],' '),&#xA;dst.[MATHS GRADE] = isnull(src.[MATHS GRADE],' '),&#xA;dst.[GROUP 1-RELEVANT GRADE] = isnull(src.[GROUP 1-RELEVANT GRADE],' '),&#xA;dst.[GROUP 2-RELEVANT GRADE] = isnull(src.[GROUP 2-RELEVANT GRADE],' '),&#xA;dst.[NO. OF N LEVEL GRADE 1 SUBJECTS] = isnull(src.[NO. OF N LEVEL GRADE 1 SUBJECTS],' '),&#xA;dst.[NO. OF N LEVEL GRADE 2 SUBJECTS] = isnull(src.[NO. OF N LEVEL GRADE 2 SUBJECTS],' '),&#xA;dst.[NO. OF N LEVEL GRADE 3 SUBJECTS] = isnull(src.[NO. OF N LEVEL GRADE 3 SUBJECTS],' '),&#xA;dst.[NO. OF N LEVEL GRADE 4 SUBJECTS] = isnull(src.[NO. OF N LEVEL GRADE 4 SUBJECTS],' '),&#xA;dst.[NO. OF N LEVEL GRADE 5 SUBJECTS] = isnull(src.[NO. OF N LEVEL GRADE 5 SUBJECTS],' '),&#xA;dst.[NO. OF N LEVEL GRADE 6 SUBJECTS] = isnull(src.[NO. OF N LEVEL GRADE 6 SUBJECTS],' '),&#xA;dst.[NO. OF O LEVEL GRADE 1 SUBJECTS] = isnull(src.[NO. OF O LEVEL GRADE 1 SUBJECTS],' '),&#xA;dst.[NO. OF O LEVEL GRADE 2 SUBJECTS] = isnull(src.[NO. OF O LEVEL GRADE 2 SUBJECTS],' '),&#xA;dst.[NO. OF O LEVEL GRADE 3 SUBJECTS] = isnull(src.[NO. OF O LEVEL GRADE 3 SUBJECTS],' '),&#xA;dst.[NO. OF O LEVEL GRADE 4 SUBJECTS] = isnull(src.[NO. OF O LEVEL GRADE 4 SUBJECTS],' '),&#xA;dst.[NO. OF O LEVEL GRADE 5 SUBJECTS] = isnull(src.[NO. OF O LEVEL GRADE 5 SUBJECTS],' '),&#xA;dst.[NO. OF O LEVEL GRADE 6 SUBJECTS] = isnull(src.[NO. OF O LEVEL GRADE 6 SUBJECTS],' '),&#xA;dst.[FILLER_1] = isnull(src.[FILLER_1],' '),&#xA;dst.[CHOICE EXERCISE] = isnull(src.[CHOICE EXERCISE],' '),&#xA;dst.[COURSE CHOICE_1] = isnull(src.[COURSE CHOICE_1],' '),&#xA;dst.[COURSE ORDER 1] = isnull(src.[COURSE ORDER 1],' '),&#xA;dst.[COURSE CHOICE_2] = isnull(src.[COURSE CHOICE_2],' '),&#xA;dst.[COURSE ORDER_2] = isnull(src.[COURSE ORDER_2],' '),&#xA;dst.[COURSE CHOICE_3] = isnull(src.[COURSE CHOICE_3],' '),&#xA;dst.[COURSE ORDER_3] = isnull(src.[COURSE ORDER_3],' '),&#xA;dst.[COURSE CHOICE_4] = isnull(src.[COURSE CHOICE_4],' '),&#xA;dst.[COURSE ORDER_4] = isnull(src.[COURSE ORDER_4],' '),&#xA;dst.[COURSE CHOICE_5] = isnull(src.[COURSE CHOICE_5],' '),&#xA;dst.[COURSE ORDER_5] = isnull(src.[COURSE ORDER_5],' '),&#xA;dst.[APPEAL COURSE CODE_1] = isnull(src.[APPEAL COURSE CODE_1],' '),&#xA;dst.[APPEAL COURSE ORDER_1] = isnull(src.[APPEAL COURSE ORDER_1],' '),&#xA;dst.[APPEAL COURSE CODE_2] = isnull(src.[APPEAL COURSE CODE_2],' '),&#xA;dst.[APPEAL COURSE ORDER_2] = isnull(src.[APPEAL COURSE ORDER_2],' '),&#xA;dst.[APPEAL COURSE CODE_3] = isnull(src.[APPEAL COURSE CODE_3],' '),&#xA;dst.[APPEAL COURSE ORDER_3] = isnull(src.[APPEAL COURSE ORDER_3],' '),&#xA;dst.[ROUND 1 POSTED COURSE CHOICE] = isnull(src.[ROUND 1 POSTED COURSE CHOICE],' '),&#xA;dst.[ROUND 1 POSTED COURSE CENTRE] = isnull(src.[ROUND 1 POSTED COURSE CENTRE],' '),&#xA;dst.[ROUND 1 POSTED CHOICE ORDER] = isnull(src.[ROUND 1 POSTED CHOICE ORDER],' '),&#xA;dst.[APPEAL POSTED COURSE] = isnull(src.[APPEAL POSTED COURSE],' '),&#xA;dst.[APPEAL POSTED CENTRE] = isnull(src.[APPEAL POSTED CENTRE],' '),&#xA;dst.[APPEAL POSTED CHOICE ORDER] = isnull(src.[APPEAL POSTED CHOICE ORDER],' '),&#xA;dst.[POSTED EXERCISE] = isnull(src.[POSTED EXERCISE],' '),&#xA;dst.[POSTED COURSE] = isnull(src.[POSTED COURSE],' '),&#xA;dst.[POSTED CENTRE CODE] = isnull(src.[POSTED CENTRE CODE],' '),&#xA;dst.[POSTED CHOICE ORDER] = isnull(src.[POSTED CHOICE ORDER],' '),&#xA;dst.[FINAL RAW SCORE] = isnull(src.[FINAL RAW SCORE],' '),&#xA;dst.[FINAL NET SCORE] = isnull(src.[FINAL NET SCORE],' '),&#xA;dst.[FILLER_3] = isnull(src.[FILLER_3],' '),&#xA;dst.[TECH ELIGIBILITY ] = isnull(src.[TECH ELIGIBILITY ],' '),&#xA;dst.[NON TECH ELIGIBILITY ] = isnull(src.[NON TECH ELIGIBILITY ],' '),&#xA;dst.[ELIGIBLE COURSES] = isnull(src.[ELIGIBLE COURSES],' '),&#xA;dst.[FILLER_4] = isnull(src.[FILLER_4],' '),&#xA;dst.[COURSE ACCEPTANCE] = isnull(src.[COURSE ACCEPTANCE],' '),&#xA;dst.[TECH_ELIGIBILITY2] = isnull(src.[TECH_ELIGIBILITY2],' '),&#xA;dst.[TECH_ELIGIBILITY3] = isnull(src.[TECH_ELIGIBILITY3],' '),&#xA;dst.[TECH_ELIGIBILITY4] = isnull(src.[TECH_ELIGIBILITY4],' '),&#xA;dst.[TECH_ELIGIBILITY5] = isnull(src.[TECH_ELIGIBILITY5],' '),&#xA;dst.[TECH_ELIGIBILITY6] = isnull(src.[TECH_ELIGIBILITY6],' '),&#xA;dst.[File_Name] = isnull(src.[File_Name],' '),&#xA;dst.[CREATED_ON] = isnull(src.[CREATED_ON],' '),&#xA;dst.[MODIFIED_ON] = isnull(src.[MODIFIED_ON],' '),&#xA;dst.[AY_YEAR] = isnull(src.[AY_YEAR],' '),&#xA;dst.[AY_SEM] = isnull(src.[AY_SEM],' ');&#xA;&#xA;--------------------------------------&#xA;COMMIT TRANSACTION&#xA;END TRY&#xA;&#xA;BEGIN CATCH&#xA;  ROLLBACK TRANSACTION&#xA;INSERT INTO ETL_ERROR_LOG(JOB_STATUS_ID,ERROR_RECORD,created_on)&#xA;  SELECT   &#xA;         CAST(@jobstatusid as int) as JOB_STATUS_ID&#xA;        ,ERROR_MESSAGE() AS ErrorMessage&#xA;&#x9;&#x9;,@processeddatetime  as created_on&#xA;  &#xA;  &#xA;END CATCH  &#xA;GO&quot;"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="InsertQuery">
      <DTS:VariableValue
        DTS:DataType="8">BEGIN TRANSACTION
BEGIN TRY
------------
DECLARE @LastDWProcessdate datetime
,@processeddatetime datetime
,@jobstatusid varchar(5)
select @jobstatusid=0
select @LastDWProcessdate=isnull(max(Modified_on),'1900-01-01 00:00:00.000') from [dbo].[DW_EXT_PFP]
select  @processeddatetime= getdate()

;WITH TMP_EXT
AS
(
SELECT 
[SECONDARY SCHOOL]
,[STREAM CODE]
,[LANGUAGE MEDIUM]
,[UIN]
,[STATUTORY NAME]
,[HANPIYUIN NAME]
,[CITIZENSHIP]
,[BIRTH PLACE]
,[RELIGION CODE]
,[DATE OF BIRTH]
,[GENDER]
,[RACE CODE]
,[ADDRESS_1]
,[ADDRESS_2]
,[ADDRESS_3]
,[POSTAL CODE]
,[MOBILE NUMBER]
,[TELEPHONE NUMBER]
,[EMAIL]
,[FILLER]
,[EXAM YEAR]
,[NO. OF N LEVEL SUBJECTS]
,[NO. OF O LEVEL SUBJECTS]
,[NO. OF SUBJECTS ENTERED]
,[N LEVEL SUBJECT CODE 1]
,[N LEVEL GRADE 1]
,[N LEVEL SUBJECT CODE 2]
,[N LEVEL GRADE 2]
,[ N LEVEL SUBJECT CODE 3]
,[N LEVEL GRADE 3]
,[N LEVEL SUBJECT CODE 4]
,[N LEVEL GRADE 4]
,[N LEVEL SUBJECT CODE 5]
,[N LEVEL GRADE 5]
,[N LEVEL SUBJECT CODE 6]
,[N LEVEL GRADE 6]
,[N LEVEL SUBJECT CODE 7]
,[N LEVEL GRADE 7]
,[N LEVEL SUBJECT CODE 8]
,[N LEVEL GRADE 8]
,[N LEVEL SUBJECT CODE 9]
,[N LEVEL GRADE 9]
,[N LEVEL SUBJECT CODE 10]
,[N LEVEL GRADE 10]
,[N LEVEL SUBJECT CODE 11]
,[N LEVEL GRADE 11]
,[N LEVEL SUBJECT CODE 12]
,[N LEVEL GRADE 12]
,[O LEVEL SUBJECT CODE_1]
,[O LEVEL GRADE_1]
,[O LEVEL GRADE POINT_1]
,[O LEVEL SUBJECT CODE_2]
,[O LEVEL GRADE_2]
,[O LEVEL GRADE POINT_2]
,[O LEVEL SUBJECT CODE_3]
,[O LEVEL GRADE_3]
,[O LEVEL GRADE POINT_3]
,[O LEVEL SUBJECT CODE_4]
,[O LEVEL GRADE_4]
,[O LEVEL GRADE POINT_4]
,[O LEVEL SUBJECT CODE_5]
,[O LEVEL GRADE_5]
,[O LEVEL GRADE POINT_5]
,[O LEVEL SUBJECT CODE_6]
,[O LEVEL GRADE_6]
,[O LEVEL GRADE POINT_6]
,[O LEVEL SUBJECT CODE_7]
,[O LEVEL GRADE_7]
,[O LEVEL GRADE POINT_7]
,[O LEVEL SUBJECT CODE_8]
,[O LEVEL GRADE_8]
,[O LEVEL GRADE POINT_8]
,[O LEVEL SUBJECT CODE_9]
,[O LEVEL GRADE_9]
,[O LEVEL GRADE POINT_9]
,[O LEVEL SUBJECT CODE_10]
,[O LEVEL GRADE_10]
,[O LEVEL GRADE POINT_10]
,[O LEVEL SUBJECT CODE_11]
,[O LEVEL GRADE_11]
,[O LEVEL GRADE POINT_11]
,[O LEVEL SUBJECT CODE_12]
,[O LEVEL GRADE_12]
,[O LEVEL GRADE POINT_12]
,[CCA GRADE]
,[ELMAB3 RAW AGGREGATE ]
,[ELMAB3 NET AGGREGATE ]
,[ENGLISH CODE]
,[MATHS CODE]
,[GROUP 1-RELEVANT SUBJECT]
,[GROUP 2-RELEVANT SUBJECT]
,[ENGLISH GRADE]
,[MATHS GRADE]
,[GROUP 1-RELEVANT GRADE]
,[GROUP 2-RELEVANT GRADE]
,[NO. OF N LEVEL GRADE 1 SUBJECTS]
,[NO. OF N LEVEL GRADE 2 SUBJECTS]
,[NO. OF N LEVEL GRADE 3 SUBJECTS]
,[NO. OF N LEVEL GRADE 4 SUBJECTS]
,[NO. OF N LEVEL GRADE 5 SUBJECTS]
,[NO. OF N LEVEL GRADE 6 SUBJECTS]
,[NO. OF O LEVEL GRADE 1 SUBJECTS]
,[NO. OF O LEVEL GRADE 2 SUBJECTS]
,[NO. OF O LEVEL GRADE 3 SUBJECTS]
,[NO. OF O LEVEL GRADE 4 SUBJECTS]
,[NO. OF O LEVEL GRADE 5 SUBJECTS]
,[NO. OF O LEVEL GRADE 6 SUBJECTS]
,[FILLER_1]
,[CHOICE EXERCISE]
,[COURSE CHOICE_1]
,[COURSE ORDER 1]
,[COURSE CHOICE_2]
,[COURSE ORDER_2]
,[COURSE CHOICE_3]
,[COURSE ORDER_3]
,[COURSE CHOICE_4]
,[COURSE ORDER_4]
,[COURSE CHOICE_5]
,[COURSE ORDER_5]
,[APPEAL COURSE CODE_1]
,[APPEAL COURSE ORDER_1]
,[APPEAL COURSE CODE_2]
,[APPEAL COURSE ORDER_2]
,[APPEAL COURSE CODE_3]
,[APPEAL COURSE ORDER_3]
,[ROUND 1 POSTED COURSE CHOICE]
,[ROUND 1 POSTED COURSE CENTRE]
,[ROUND 1 POSTED CHOICE ORDER]
,[APPEAL POSTED COURSE]
,[APPEAL POSTED CENTRE]
,[APPEAL POSTED CHOICE ORDER]
,[POSTED EXERCISE]
,[POSTED COURSE]
,[POSTED CENTRE CODE]
,[POSTED CHOICE ORDER]
,[FINAL RAW SCORE]
,[FINAL NET SCORE]
,[FILLER_3]
,[TECH ELIGIBILITY ]
,[NON TECH ELIGIBILITY ]
,[ELIGIBLE COURSES]
,[FILLER_4]
,[COURSE ACCEPTANCE]
,[TECH_ELIGIBILITY2]
,[TECH_ELIGIBILITY3]
,[TECH_ELIGIBILITY4]
,[TECH_ELIGIBILITY5]
,[TECH_ELIGIBILITY6]
,[File_Name]
,[CREATED_ON]
,[MODIFIED_ON]
,[AY_YEAR]
,[AY_SEM]
  FROM RPDW_STG.[dbo].[STG_EXT_PFP]
   where [Latest_Ind] ='Y' 
AND [MODIFIED_ON]&gt;@LastDWProcessdate
)


MERGE INTO [DW_EXT_PFP] AS DST
   USING TMP_EXT AS SRC
  ON (
  SRC. [AY_SEM] = DST.[AY_SEM] AND   SRC. [AY_YEAR] = DST.[AY_YEAR] AND   SRC. [DATE OF BIRTH] = DST.[DATE OF BIRTH] AND   SRC. [EXAM YEAR] = DST.[EXAM YEAR] AND   SRC. [POSTAL CODE] = DST.[POSTAL CODE] AND   SRC. [UIN] = DST.[UIN]
     )

   WHEN NOT MATCHED THEN
   INSERT
	(
[SECONDARY SCHOOL]
,[STREAM CODE]
,[LANGUAGE MEDIUM]
,[UIN]
,[STATUTORY NAME]
,[HANPIYUIN NAME]
,[CITIZENSHIP]
,[BIRTH PLACE]
,[RELIGION CODE]
,[DATE OF BIRTH]
,[GENDER]
,[RACE CODE]
,[ADDRESS_1]
,[ADDRESS_2]
,[ADDRESS_3]
,[POSTAL CODE]
,[MOBILE NUMBER]
,[TELEPHONE NUMBER]
,[EMAIL]
,[FILLER]
,[EXAM YEAR]
,[NO. OF N LEVEL SUBJECTS]
,[NO. OF O LEVEL SUBJECTS]
,[NO. OF SUBJECTS ENTERED]
,[N LEVEL SUBJECT CODE 1]
,[N LEVEL GRADE 1]
,[N LEVEL SUBJECT CODE 2]
,[N LEVEL GRADE 2]
,[ N LEVEL SUBJECT CODE 3]
,[N LEVEL GRADE 3]
,[N LEVEL SUBJECT CODE 4]
,[N LEVEL GRADE 4]
,[N LEVEL SUBJECT CODE 5]
,[N LEVEL GRADE 5]
,[N LEVEL SUBJECT CODE 6]
,[N LEVEL GRADE 6]
,[N LEVEL SUBJECT CODE 7]
,[N LEVEL GRADE 7]
,[N LEVEL SUBJECT CODE 8]
,[N LEVEL GRADE 8]
,[N LEVEL SUBJECT CODE 9]
,[N LEVEL GRADE 9]
,[N LEVEL SUBJECT CODE 10]
,[N LEVEL GRADE 10]
,[N LEVEL SUBJECT CODE 11]
,[N LEVEL GRADE 11]
,[N LEVEL SUBJECT CODE 12]
,[N LEVEL GRADE 12]
,[O LEVEL SUBJECT CODE_1]
,[O LEVEL GRADE_1]
,[O LEVEL GRADE POINT_1]
,[O LEVEL SUBJECT CODE_2]
,[O LEVEL GRADE_2]
,[O LEVEL GRADE POINT_2]
,[O LEVEL SUBJECT CODE_3]
,[O LEVEL GRADE_3]
,[O LEVEL GRADE POINT_3]
,[O LEVEL SUBJECT CODE_4]
,[O LEVEL GRADE_4]
,[O LEVEL GRADE POINT_4]
,[O LEVEL SUBJECT CODE_5]
,[O LEVEL GRADE_5]
,[O LEVEL GRADE POINT_5]
,[O LEVEL SUBJECT CODE_6]
,[O LEVEL GRADE_6]
,[O LEVEL GRADE POINT_6]
,[O LEVEL SUBJECT CODE_7]
,[O LEVEL GRADE_7]
,[O LEVEL GRADE POINT_7]
,[O LEVEL SUBJECT CODE_8]
,[O LEVEL GRADE_8]
,[O LEVEL GRADE POINT_8]
,[O LEVEL SUBJECT CODE_9]
,[O LEVEL GRADE_9]
,[O LEVEL GRADE POINT_9]
,[O LEVEL SUBJECT CODE_10]
,[O LEVEL GRADE_10]
,[O LEVEL GRADE POINT_10]
,[O LEVEL SUBJECT CODE_11]
,[O LEVEL GRADE_11]
,[O LEVEL GRADE POINT_11]
,[O LEVEL SUBJECT CODE_12]
,[O LEVEL GRADE_12]
,[O LEVEL GRADE POINT_12]
,[CCA GRADE]
,[ELMAB3 RAW AGGREGATE ]
,[ELMAB3 NET AGGREGATE ]
,[ENGLISH CODE]
,[MATHS CODE]
,[GROUP 1-RELEVANT SUBJECT]
,[GROUP 2-RELEVANT SUBJECT]
,[ENGLISH GRADE]
,[MATHS GRADE]
,[GROUP 1-RELEVANT GRADE]
,[GROUP 2-RELEVANT GRADE]
,[NO. OF N LEVEL GRADE 1 SUBJECTS]
,[NO. OF N LEVEL GRADE 2 SUBJECTS]
,[NO. OF N LEVEL GRADE 3 SUBJECTS]
,[NO. OF N LEVEL GRADE 4 SUBJECTS]
,[NO. OF N LEVEL GRADE 5 SUBJECTS]
,[NO. OF N LEVEL GRADE 6 SUBJECTS]
,[NO. OF O LEVEL GRADE 1 SUBJECTS]
,[NO. OF O LEVEL GRADE 2 SUBJECTS]
,[NO. OF O LEVEL GRADE 3 SUBJECTS]
,[NO. OF O LEVEL GRADE 4 SUBJECTS]
,[NO. OF O LEVEL GRADE 5 SUBJECTS]
,[NO. OF O LEVEL GRADE 6 SUBJECTS]
,[FILLER_1]
,[CHOICE EXERCISE]
,[COURSE CHOICE_1]
,[COURSE ORDER 1]
,[COURSE CHOICE_2]
,[COURSE ORDER_2]
,[COURSE CHOICE_3]
,[COURSE ORDER_3]
,[COURSE CHOICE_4]
,[COURSE ORDER_4]
,[COURSE CHOICE_5]
,[COURSE ORDER_5]
,[APPEAL COURSE CODE_1]
,[APPEAL COURSE ORDER_1]
,[APPEAL COURSE CODE_2]
,[APPEAL COURSE ORDER_2]
,[APPEAL COURSE CODE_3]
,[APPEAL COURSE ORDER_3]
,[ROUND 1 POSTED COURSE CHOICE]
,[ROUND 1 POSTED COURSE CENTRE]
,[ROUND 1 POSTED CHOICE ORDER]
,[APPEAL POSTED COURSE]
,[APPEAL POSTED CENTRE]
,[APPEAL POSTED CHOICE ORDER]
,[POSTED EXERCISE]
,[POSTED COURSE]
,[POSTED CENTRE CODE]
,[POSTED CHOICE ORDER]
,[FINAL RAW SCORE]
,[FINAL NET SCORE]
,[FILLER_3]
,[TECH ELIGIBILITY ]
,[NON TECH ELIGIBILITY ]
,[ELIGIBLE COURSES]
,[FILLER_4]
,[COURSE ACCEPTANCE]
,[TECH_ELIGIBILITY2]
,[TECH_ELIGIBILITY3]
,[TECH_ELIGIBILITY4]
,[TECH_ELIGIBILITY5]
,[TECH_ELIGIBILITY6]
,[File_Name]
,[CREATED_ON]
,[MODIFIED_ON]
,[AY_YEAR]
,[AY_SEM]
	  )
VALUES
	(  
 src.[SECONDARY SCHOOL]
,src.[STREAM CODE]
,src.[LANGUAGE MEDIUM]
,src.[UIN]
,src.[STATUTORY NAME]
,src.[HANPIYUIN NAME]
,src.[CITIZENSHIP]
,src.[BIRTH PLACE]
,src.[RELIGION CODE]
,src.[DATE OF BIRTH]
,src.[GENDER]
,src.[RACE CODE]
,src.[ADDRESS_1]
,src.[ADDRESS_2]
,src.[ADDRESS_3]
,src.[POSTAL CODE]
,src.[MOBILE NUMBER]
,src.[TELEPHONE NUMBER]
,src.[EMAIL]
,src.[FILLER]
,src.[EXAM YEAR]
,src.[NO. OF N LEVEL SUBJECTS]
,src.[NO. OF O LEVEL SUBJECTS]
,src.[NO. OF SUBJECTS ENTERED]
,src.[N LEVEL SUBJECT CODE 1]
,src.[N LEVEL GRADE 1]
,src.[N LEVEL SUBJECT CODE 2]
,src.[N LEVEL GRADE 2]
,src.[ N LEVEL SUBJECT CODE 3]
,src.[N LEVEL GRADE 3]
,src.[N LEVEL SUBJECT CODE 4]
,src.[N LEVEL GRADE 4]
,src.[N LEVEL SUBJECT CODE 5]
,src.[N LEVEL GRADE 5]
,src.[N LEVEL SUBJECT CODE 6]
,src.[N LEVEL GRADE 6]
,src.[N LEVEL SUBJECT CODE 7]
,src.[N LEVEL GRADE 7]
,src.[N LEVEL SUBJECT CODE 8]
,src.[N LEVEL GRADE 8]
,src.[N LEVEL SUBJECT CODE 9]
,src.[N LEVEL GRADE 9]
,src.[N LEVEL SUBJECT CODE 10]
,src.[N LEVEL GRADE 10]
,src.[N LEVEL SUBJECT CODE 11]
,src.[N LEVEL GRADE 11]
,src.[N LEVEL SUBJECT CODE 12]
,src.[N LEVEL GRADE 12]
,src.[O LEVEL SUBJECT CODE_1]
,src.[O LEVEL GRADE_1]
,src.[O LEVEL GRADE POINT_1]
,src.[O LEVEL SUBJECT CODE_2]
,src.[O LEVEL GRADE_2]
,src.[O LEVEL GRADE POINT_2]
,src.[O LEVEL SUBJECT CODE_3]
,src.[O LEVEL GRADE_3]
,src.[O LEVEL GRADE POINT_3]
,src.[O LEVEL SUBJECT CODE_4]
,src.[O LEVEL GRADE_4]
,src.[O LEVEL GRADE POINT_4]
,src.[O LEVEL SUBJECT CODE_5]
,src.[O LEVEL GRADE_5]
,src.[O LEVEL GRADE POINT_5]
,src.[O LEVEL SUBJECT CODE_6]
,src.[O LEVEL GRADE_6]
,src.[O LEVEL GRADE POINT_6]
,src.[O LEVEL SUBJECT CODE_7]
,src.[O LEVEL GRADE_7]
,src.[O LEVEL GRADE POINT_7]
,src.[O LEVEL SUBJECT CODE_8]
,src.[O LEVEL GRADE_8]
,src.[O LEVEL GRADE POINT_8]
,src.[O LEVEL SUBJECT CODE_9]
,src.[O LEVEL GRADE_9]
,src.[O LEVEL GRADE POINT_9]
,src.[O LEVEL SUBJECT CODE_10]
,src.[O LEVEL GRADE_10]
,src.[O LEVEL GRADE POINT_10]
,src.[O LEVEL SUBJECT CODE_11]
,src.[O LEVEL GRADE_11]
,src.[O LEVEL GRADE POINT_11]
,src.[O LEVEL SUBJECT CODE_12]
,src.[O LEVEL GRADE_12]
,src.[O LEVEL GRADE POINT_12]
,src.[CCA GRADE]
,src.[ELMAB3 RAW AGGREGATE ]
,src.[ELMAB3 NET AGGREGATE ]
,src.[ENGLISH CODE]
,src.[MATHS CODE]
,src.[GROUP 1-RELEVANT SUBJECT]
,src.[GROUP 2-RELEVANT SUBJECT]
,src.[ENGLISH GRADE]
,src.[MATHS GRADE]
,src.[GROUP 1-RELEVANT GRADE]
,src.[GROUP 2-RELEVANT GRADE]
,src.[NO. OF N LEVEL GRADE 1 SUBJECTS]
,src.[NO. OF N LEVEL GRADE 2 SUBJECTS]
,src.[NO. OF N LEVEL GRADE 3 SUBJECTS]
,src.[NO. OF N LEVEL GRADE 4 SUBJECTS]
,src.[NO. OF N LEVEL GRADE 5 SUBJECTS]
,src.[NO. OF N LEVEL GRADE 6 SUBJECTS]
,src.[NO. OF O LEVEL GRADE 1 SUBJECTS]
,src.[NO. OF O LEVEL GRADE 2 SUBJECTS]
,src.[NO. OF O LEVEL GRADE 3 SUBJECTS]
,src.[NO. OF O LEVEL GRADE 4 SUBJECTS]
,src.[NO. OF O LEVEL GRADE 5 SUBJECTS]
,src.[NO. OF O LEVEL GRADE 6 SUBJECTS]
,src.[FILLER_1]
,src.[CHOICE EXERCISE]
,src.[COURSE CHOICE_1]
,src.[COURSE ORDER 1]
,src.[COURSE CHOICE_2]
,src.[COURSE ORDER_2]
,src.[COURSE CHOICE_3]
,src.[COURSE ORDER_3]
,src.[COURSE CHOICE_4]
,src.[COURSE ORDER_4]
,src.[COURSE CHOICE_5]
,src.[COURSE ORDER_5]
,src.[APPEAL COURSE CODE_1]
,src.[APPEAL COURSE ORDER_1]
,src.[APPEAL COURSE CODE_2]
,src.[APPEAL COURSE ORDER_2]
,src.[APPEAL COURSE CODE_3]
,src.[APPEAL COURSE ORDER_3]
,src.[ROUND 1 POSTED COURSE CHOICE]
,src.[ROUND 1 POSTED COURSE CENTRE]
,src.[ROUND 1 POSTED CHOICE ORDER]
,src.[APPEAL POSTED COURSE]
,src.[APPEAL POSTED CENTRE]
,src.[APPEAL POSTED CHOICE ORDER]
,src.[POSTED EXERCISE]
,src.[POSTED COURSE]
,src.[POSTED CENTRE CODE]
,src.[POSTED CHOICE ORDER]
,src.[FINAL RAW SCORE]
,src.[FINAL NET SCORE]
,src.[FILLER_3]
,src.[TECH ELIGIBILITY ]
,src.[NON TECH ELIGIBILITY ]
,src.[ELIGIBLE COURSES]
,src.[FILLER_4]
,src.[COURSE ACCEPTANCE]
,src.[TECH_ELIGIBILITY2]
,src.[TECH_ELIGIBILITY3]
,src.[TECH_ELIGIBILITY4]
,src.[TECH_ELIGIBILITY5]
,src.[TECH_ELIGIBILITY6]
,src.[File_Name]
,src.[CREATED_ON]
,src.[MODIFIED_ON]
,src.[AY_YEAR]
,src.[AY_SEM]

	)
   WHEN MATCHED
   
   THEN UPDATE
   SET 	 
 dst.[EXAM YEAR] = isnull(src.[EXAM YEAR],' '),
dst.[NO. OF N LEVEL SUBJECTS] = isnull(src.[NO. OF N LEVEL SUBJECTS],' '),
dst.[NO. OF O LEVEL SUBJECTS] = isnull(src.[NO. OF O LEVEL SUBJECTS],' '),
dst.[NO. OF SUBJECTS ENTERED] = isnull(src.[NO. OF SUBJECTS ENTERED],' '),
dst.[N LEVEL SUBJECT CODE 1] = isnull(src.[N LEVEL SUBJECT CODE 1],' '),
dst.[N LEVEL GRADE 1] = isnull(src.[N LEVEL GRADE 1],' '),
dst.[N LEVEL SUBJECT CODE 2] = isnull(src.[N LEVEL SUBJECT CODE 2],' '),
dst.[N LEVEL GRADE 2] = isnull(src.[N LEVEL GRADE 2],' '),
dst.[ N LEVEL SUBJECT CODE 3] = isnull(src.[ N LEVEL SUBJECT CODE 3],' '),
dst.[N LEVEL GRADE 3] = isnull(src.[N LEVEL GRADE 3],' '),
dst.[N LEVEL SUBJECT CODE 4] = isnull(src.[N LEVEL SUBJECT CODE 4],' '),
dst.[N LEVEL GRADE 4] = isnull(src.[N LEVEL GRADE 4],' '),
dst.[N LEVEL SUBJECT CODE 5] = isnull(src.[N LEVEL SUBJECT CODE 5],' '),
dst.[N LEVEL GRADE 5] = isnull(src.[N LEVEL GRADE 5],' '),
dst.[N LEVEL SUBJECT CODE 6] = isnull(src.[N LEVEL SUBJECT CODE 6],' '),
dst.[N LEVEL GRADE 6] = isnull(src.[N LEVEL GRADE 6],' '),
dst.[N LEVEL SUBJECT CODE 7] = isnull(src.[N LEVEL SUBJECT CODE 7],' '),
dst.[N LEVEL GRADE 7] = isnull(src.[N LEVEL GRADE 7],' '),
dst.[N LEVEL SUBJECT CODE 8] = isnull(src.[N LEVEL SUBJECT CODE 8],' '),
dst.[N LEVEL GRADE 8] = isnull(src.[N LEVEL GRADE 8],' '),
dst.[N LEVEL SUBJECT CODE 9] = isnull(src.[N LEVEL SUBJECT CODE 9],' '),
dst.[N LEVEL GRADE 9] = isnull(src.[N LEVEL GRADE 9],' '),
dst.[N LEVEL SUBJECT CODE 10] = isnull(src.[N LEVEL SUBJECT CODE 10],' '),
dst.[N LEVEL GRADE 10] = isnull(src.[N LEVEL GRADE 10],' '),
dst.[N LEVEL SUBJECT CODE 11] = isnull(src.[N LEVEL SUBJECT CODE 11],' '),
dst.[N LEVEL GRADE 11] = isnull(src.[N LEVEL GRADE 11],' '),
dst.[N LEVEL SUBJECT CODE 12] = isnull(src.[N LEVEL SUBJECT CODE 12],' '),
dst.[N LEVEL GRADE 12] = isnull(src.[N LEVEL GRADE 12],' '),
dst.[O LEVEL SUBJECT CODE_1] = isnull(src.[O LEVEL SUBJECT CODE_1],' '),
dst.[O LEVEL GRADE_1] = isnull(src.[O LEVEL GRADE_1],' '),
dst.[O LEVEL GRADE POINT_1] = isnull(src.[O LEVEL GRADE POINT_1],' '),
dst.[O LEVEL SUBJECT CODE_2] = isnull(src.[O LEVEL SUBJECT CODE_2],' '),
dst.[O LEVEL GRADE_2] = isnull(src.[O LEVEL GRADE_2],' '),
dst.[O LEVEL GRADE POINT_2] = isnull(src.[O LEVEL GRADE POINT_2],' '),
dst.[O LEVEL SUBJECT CODE_3] = isnull(src.[O LEVEL SUBJECT CODE_3],' '),
dst.[O LEVEL GRADE_3] = isnull(src.[O LEVEL GRADE_3],' '),
dst.[O LEVEL GRADE POINT_3] = isnull(src.[O LEVEL GRADE POINT_3],' '),
dst.[O LEVEL SUBJECT CODE_4] = isnull(src.[O LEVEL SUBJECT CODE_4],' '),
dst.[O LEVEL GRADE_4] = isnull(src.[O LEVEL GRADE_4],' '),
dst.[O LEVEL GRADE POINT_4] = isnull(src.[O LEVEL GRADE POINT_4],' '),
dst.[O LEVEL SUBJECT CODE_5] = isnull(src.[O LEVEL SUBJECT CODE_5],' '),
dst.[O LEVEL GRADE_5] = isnull(src.[O LEVEL GRADE_5],' '),
dst.[O LEVEL GRADE POINT_5] = isnull(src.[O LEVEL GRADE POINT_5],' '),
dst.[O LEVEL SUBJECT CODE_6] = isnull(src.[O LEVEL SUBJECT CODE_6],' '),
dst.[O LEVEL GRADE_6] = isnull(src.[O LEVEL GRADE_6],' '),
dst.[O LEVEL GRADE POINT_6] = isnull(src.[O LEVEL GRADE POINT_6],' '),
dst.[O LEVEL SUBJECT CODE_7] = isnull(src.[O LEVEL SUBJECT CODE_7],' '),
dst.[O LEVEL GRADE_7] = isnull(src.[O LEVEL GRADE_7],' '),
dst.[O LEVEL GRADE POINT_7] = isnull(src.[O LEVEL GRADE POINT_7],' '),
dst.[O LEVEL SUBJECT CODE_8] = isnull(src.[O LEVEL SUBJECT CODE_8],' '),
dst.[O LEVEL GRADE_8] = isnull(src.[O LEVEL GRADE_8],' '),
dst.[O LEVEL GRADE POINT_8] = isnull(src.[O LEVEL GRADE POINT_8],' '),
dst.[O LEVEL SUBJECT CODE_9] = isnull(src.[O LEVEL SUBJECT CODE_9],' '),
dst.[O LEVEL GRADE_9] = isnull(src.[O LEVEL GRADE_9],' '),
dst.[O LEVEL GRADE POINT_9] = isnull(src.[O LEVEL GRADE POINT_9],' '),
dst.[O LEVEL SUBJECT CODE_10] = isnull(src.[O LEVEL SUBJECT CODE_10],' '),
dst.[O LEVEL GRADE_10] = isnull(src.[O LEVEL GRADE_10],' '),
dst.[O LEVEL GRADE POINT_10] = isnull(src.[O LEVEL GRADE POINT_10],' '),
dst.[O LEVEL SUBJECT CODE_11] = isnull(src.[O LEVEL SUBJECT CODE_11],' '),
dst.[O LEVEL GRADE_11] = isnull(src.[O LEVEL GRADE_11],' '),
dst.[O LEVEL GRADE POINT_11] = isnull(src.[O LEVEL GRADE POINT_11],' '),
dst.[O LEVEL SUBJECT CODE_12] = isnull(src.[O LEVEL SUBJECT CODE_12],' '),
dst.[O LEVEL GRADE_12] = isnull(src.[O LEVEL GRADE_12],' '),
dst.[O LEVEL GRADE POINT_12] = isnull(src.[O LEVEL GRADE POINT_12],' '),
dst.[CCA GRADE] = isnull(src.[CCA GRADE],' '),
dst.[ELMAB3 RAW AGGREGATE ] = isnull(src.[ELMAB3 RAW AGGREGATE ],' '),
dst.[ELMAB3 NET AGGREGATE ] = isnull(src.[ELMAB3 NET AGGREGATE ],' '),
dst.[ENGLISH CODE] = isnull(src.[ENGLISH CODE],' '),
dst.[MATHS CODE] = isnull(src.[MATHS CODE],' '),
dst.[GROUP 1-RELEVANT SUBJECT] = isnull(src.[GROUP 1-RELEVANT SUBJECT],' '),
dst.[GROUP 2-RELEVANT SUBJECT] = isnull(src.[GROUP 2-RELEVANT SUBJECT],' '),
dst.[ENGLISH GRADE] = isnull(src.[ENGLISH GRADE],' '),
dst.[MATHS GRADE] = isnull(src.[MATHS GRADE],' '),
dst.[GROUP 1-RELEVANT GRADE] = isnull(src.[GROUP 1-RELEVANT GRADE],' '),
dst.[GROUP 2-RELEVANT GRADE] = isnull(src.[GROUP 2-RELEVANT GRADE],' '),
dst.[NO. OF N LEVEL GRADE 1 SUBJECTS] = isnull(src.[NO. OF N LEVEL GRADE 1 SUBJECTS],' '),
dst.[NO. OF N LEVEL GRADE 2 SUBJECTS] = isnull(src.[NO. OF N LEVEL GRADE 2 SUBJECTS],' '),
dst.[NO. OF N LEVEL GRADE 3 SUBJECTS] = isnull(src.[NO. OF N LEVEL GRADE 3 SUBJECTS],' '),
dst.[NO. OF N LEVEL GRADE 4 SUBJECTS] = isnull(src.[NO. OF N LEVEL GRADE 4 SUBJECTS],' '),
dst.[NO. OF N LEVEL GRADE 5 SUBJECTS] = isnull(src.[NO. OF N LEVEL GRADE 5 SUBJECTS],' '),
dst.[NO. OF N LEVEL GRADE 6 SUBJECTS] = isnull(src.[NO. OF N LEVEL GRADE 6 SUBJECTS],' '),
dst.[NO. OF O LEVEL GRADE 1 SUBJECTS] = isnull(src.[NO. OF O LEVEL GRADE 1 SUBJECTS],' '),
dst.[NO. OF O LEVEL GRADE 2 SUBJECTS] = isnull(src.[NO. OF O LEVEL GRADE 2 SUBJECTS],' '),
dst.[NO. OF O LEVEL GRADE 3 SUBJECTS] = isnull(src.[NO. OF O LEVEL GRADE 3 SUBJECTS],' '),
dst.[NO. OF O LEVEL GRADE 4 SUBJECTS] = isnull(src.[NO. OF O LEVEL GRADE 4 SUBJECTS],' '),
dst.[NO. OF O LEVEL GRADE 5 SUBJECTS] = isnull(src.[NO. OF O LEVEL GRADE 5 SUBJECTS],' '),
dst.[NO. OF O LEVEL GRADE 6 SUBJECTS] = isnull(src.[NO. OF O LEVEL GRADE 6 SUBJECTS],' '),
dst.[FILLER_1] = isnull(src.[FILLER_1],' '),
dst.[CHOICE EXERCISE] = isnull(src.[CHOICE EXERCISE],' '),
dst.[COURSE CHOICE_1] = isnull(src.[COURSE CHOICE_1],' '),
dst.[COURSE ORDER 1] = isnull(src.[COURSE ORDER 1],' '),
dst.[COURSE CHOICE_2] = isnull(src.[COURSE CHOICE_2],' '),
dst.[COURSE ORDER_2] = isnull(src.[COURSE ORDER_2],' '),
dst.[COURSE CHOICE_3] = isnull(src.[COURSE CHOICE_3],' '),
dst.[COURSE ORDER_3] = isnull(src.[COURSE ORDER_3],' '),
dst.[COURSE CHOICE_4] = isnull(src.[COURSE CHOICE_4],' '),
dst.[COURSE ORDER_4] = isnull(src.[COURSE ORDER_4],' '),
dst.[COURSE CHOICE_5] = isnull(src.[COURSE CHOICE_5],' '),
dst.[COURSE ORDER_5] = isnull(src.[COURSE ORDER_5],' '),
dst.[APPEAL COURSE CODE_1] = isnull(src.[APPEAL COURSE CODE_1],' '),
dst.[APPEAL COURSE ORDER_1] = isnull(src.[APPEAL COURSE ORDER_1],' '),
dst.[APPEAL COURSE CODE_2] = isnull(src.[APPEAL COURSE CODE_2],' '),
dst.[APPEAL COURSE ORDER_2] = isnull(src.[APPEAL COURSE ORDER_2],' '),
dst.[APPEAL COURSE CODE_3] = isnull(src.[APPEAL COURSE CODE_3],' '),
dst.[APPEAL COURSE ORDER_3] = isnull(src.[APPEAL COURSE ORDER_3],' '),
dst.[ROUND 1 POSTED COURSE CHOICE] = isnull(src.[ROUND 1 POSTED COURSE CHOICE],' '),
dst.[ROUND 1 POSTED COURSE CENTRE] = isnull(src.[ROUND 1 POSTED COURSE CENTRE],' '),
dst.[ROUND 1 POSTED CHOICE ORDER] = isnull(src.[ROUND 1 POSTED CHOICE ORDER],' '),
dst.[APPEAL POSTED COURSE] = isnull(src.[APPEAL POSTED COURSE],' '),
dst.[APPEAL POSTED CENTRE] = isnull(src.[APPEAL POSTED CENTRE],' '),
dst.[APPEAL POSTED CHOICE ORDER] = isnull(src.[APPEAL POSTED CHOICE ORDER],' '),
dst.[POSTED EXERCISE] = isnull(src.[POSTED EXERCISE],' '),
dst.[POSTED COURSE] = isnull(src.[POSTED COURSE],' '),
dst.[POSTED CENTRE CODE] = isnull(src.[POSTED CENTRE CODE],' '),
dst.[POSTED CHOICE ORDER] = isnull(src.[POSTED CHOICE ORDER],' '),
dst.[FINAL RAW SCORE] = isnull(src.[FINAL RAW SCORE],' '),
dst.[FINAL NET SCORE] = isnull(src.[FINAL NET SCORE],' '),
dst.[FILLER_3] = isnull(src.[FILLER_3],' '),
dst.[TECH ELIGIBILITY ] = isnull(src.[TECH ELIGIBILITY ],' '),
dst.[NON TECH ELIGIBILITY ] = isnull(src.[NON TECH ELIGIBILITY ],' '),
dst.[ELIGIBLE COURSES] = isnull(src.[ELIGIBLE COURSES],' '),
dst.[FILLER_4] = isnull(src.[FILLER_4],' '),
dst.[COURSE ACCEPTANCE] = isnull(src.[COURSE ACCEPTANCE],' '),
dst.[TECH_ELIGIBILITY2] = isnull(src.[TECH_ELIGIBILITY2],' '),
dst.[TECH_ELIGIBILITY3] = isnull(src.[TECH_ELIGIBILITY3],' '),
dst.[TECH_ELIGIBILITY4] = isnull(src.[TECH_ELIGIBILITY4],' '),
dst.[TECH_ELIGIBILITY5] = isnull(src.[TECH_ELIGIBILITY5],' '),
dst.[TECH_ELIGIBILITY6] = isnull(src.[TECH_ELIGIBILITY6],' '),
dst.[File_Name] = isnull(src.[File_Name],' '),
dst.[CREATED_ON] = isnull(src.[CREATED_ON],' '),
dst.[MODIFIED_ON] = isnull(src.[MODIFIED_ON],' '),
dst.[AY_YEAR] = isnull(src.[AY_YEAR],' '),
dst.[AY_SEM] = isnull(src.[AY_SEM],' ');

--------------------------------------
COMMIT TRANSACTION
END TRY

BEGIN CATCH
  ROLLBACK TRANSACTION
INSERT INTO ETL_ERROR_LOG(JOB_STATUS_ID,ERROR_RECORD,created_on)
  SELECT   
         CAST(@jobstatusid as int) as JOB_STATUS_ID
        ,ERROR_MESSAGE() AS ErrorMessage
		,@processeddatetime  as created_on
  
  
END CATCH  
GO</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{BE0A1FBB-CBA3-4F10-8BDC-1B68A3AE2EBD}"
      DTS:IncludeInDebugDump="6789"
      DTS:Namespace="User"
      DTS:ObjectName="JobStatusId">
      <DTS:VariableValue
        DTS:DataType="3">0</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{6C6A60AE-C3F0-4A98-B70E-53E5DBFB3497}"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="Job_Name">
      <DTS:VariableValue
        DTS:DataType="8">DW_EXT_PFP</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{F8F9E19A-81E0-4355-B045-F42EF18BD3A0}"
      DTS:IncludeInDebugDump="6789"
      DTS:Namespace="User"
      DTS:ObjectName="MndColumncheck">
      <DTS:VariableValue
        DTS:DataType="3">0</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{0C8C6604-973D-4AB4-AB37-45B17789171E}"
      DTS:IncludeInDebugDump="6789"
      DTS:Namespace="User"
      DTS:ObjectName="PrevJobStatus">
      <DTS:VariableValue
        DTS:DataType="3">0</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{3069F73E-51E4-4957-8A59-E1BCF02136DF}"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="sqlprimarykeycheck">
      <DTS:VariableValue
        DTS:DataType="3">0</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{6D968B3F-DD16-4D4D-804D-FEB300C3681B}"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="sqlprocesseddate">
      <DTS:VariableValue
        DTS:DataType="7">2/27/2019 11:28:00 AM</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{5E206701-C27F-4759-87ED-4263523F1020}"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="SrcTable">
      <DTS:VariableValue
        DTS:DataType="8">STG_EXT_PFP</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{503615C1-3347-4119-A57D-A3A28E0BEFAB}"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="Stage">
      <DTS:VariableValue
        DTS:DataType="8">DW</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{5DA45788-B0D6-44F8-9822-43C4AF7D6E59}"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="TgtTable">
      <DTS:VariableValue
        DTS:DataType="8">DW_EXT_PFP</DTS:VariableValue>
    </DTS:Variable>
  </DTS:Variables>
  <DTS:Executables>
    <DTS:Executable
      DTS:refId="Package\check previous job status"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{A5FED51E-BB41-4D76-80D0-6A61C053AC34}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="check previous job status"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{E7C8192A-D1F1-4E6F-B879-36215BD4EB9D}"
          SQLTask:SqlStatementSource="&#xA;SELECT CASE WHEN [JOB_STATUS] ='SUCCESS' THEN 1 ELSE 0 END AS PrevJobStatus&#xA;FROM [DBO].[ETL_JOB_STATUS] WHERE [JOB_STATUS_ID]=&#xA;(SELECT MAX([JOB_STATUS_ID]) FROM [DBO].[ETL_JOB_STATUS]&#xA;WHERE [TARGET_TABLENAME]=?&#xA;AND [STAGE]='STG')&#xA;&#xA;"
          SQLTask:ResultType="ResultSetType_SingleRow" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
          <SQLTask:ResultBinding
            SQLTask:ResultName="PrevJobStatus"
            SQLTask:DtsVariableName="User::PrevJobStatus" />
          <SQLTask:ParameterBinding
            SQLTask:ParameterName="0"
            SQLTask:DtsVariableName="User::SrcTable"
            SQLTask:ParameterDirection="Input"
            SQLTask:DataType="130"
            SQLTask:ParameterSize="-1" />
        </SQLTask:SqlTaskData>
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Create ETL Job Log"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{DFF8974A-CDE4-4340-91E9-E0C65B4A5FC5}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Create ETL Job Log"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{E7C8192A-D1F1-4E6F-B879-36215BD4EB9D}"
          SQLTask:SqlStatementSource="&#xA;EXEC dbo.[usp_InsertETLJobLog]  ?,?,?,?" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
          <SQLTask:ParameterBinding
            SQLTask:ParameterName="0"
            SQLTask:DtsVariableName="User::Job_Name"
            SQLTask:ParameterDirection="Input"
            SQLTask:DataType="130"
            SQLTask:ParameterSize="-1" />
          <SQLTask:ParameterBinding
            SQLTask:ParameterName="1"
            SQLTask:DtsVariableName="User::Stage"
            SQLTask:ParameterDirection="Input"
            SQLTask:DataType="130"
            SQLTask:ParameterSize="-1" />
          <SQLTask:ParameterBinding
            SQLTask:ParameterName="2"
            SQLTask:DtsVariableName="User::SrcTable"
            SQLTask:ParameterDirection="Input"
            SQLTask:DataType="130"
            SQLTask:ParameterSize="-1" />
          <SQLTask:ParameterBinding
            SQLTask:ParameterName="3"
            SQLTask:DtsVariableName="User::TgtTable"
            SQLTask:ParameterDirection="Input"
            SQLTask:DataType="130"
            SQLTask:ParameterSize="-1" />
        </SQLTask:SqlTaskData>
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\get Job Status Id"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{5455CB69-C512-41D2-B41D-EEB971F37F0D}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="get Job Status Id"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{E7C8192A-D1F1-4E6F-B879-36215BD4EB9D}"
          SQLTask:SqlStatementSource="declare  @JobstatusID int&#xA;&#xA;select @JobstatusID=max(job_status_id) from [ETL_JOB_STATUS]&#xA;where [TARGET_TABLENAME]=?&#xA;&#xA;&#xA;Select @JobstatusID "
          SQLTask:ResultType="ResultSetType_SingleRow" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
          <SQLTask:ResultBinding
            SQLTask:ResultName="0"
            SQLTask:DtsVariableName="User::JobStatusId" />
          <SQLTask:ParameterBinding
            SQLTask:ParameterName="0"
            SQLTask:DtsVariableName="User::TgtTable"
            SQLTask:ParameterDirection="Input"
            SQLTask:DataType="130"
            SQLTask:ParameterSize="-1" />
        </SQLTask:SqlTaskData>
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\getprocesseddate"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{073564AB-2B78-4B17-94E2-F47B51E34475}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="getprocesseddate"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{E7C8192A-D1F1-4E6F-B879-36215BD4EB9D}"
          SQLTask:SqlStatementSource="SELECT GETDATE()"
          SQLTask:ResultType="ResultSetType_SingleRow" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
          <SQLTask:ResultBinding
            SQLTask:ResultName="0"
            SQLTask:DtsVariableName="User::sqlprocesseddate" />
        </SQLTask:SqlTaskData>
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\insert into main table"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{D2308C47-D590-46B9-939A-11CE5EC87831}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="insert into main table"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{E7C8192A-D1F1-4E6F-B879-36215BD4EB9D}"
          SQLTask:SqlStmtSourceType="Variable"
          SQLTask:SqlStatementSource="User::InsertQuery" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Masking"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{2B590C9E-74EE-4A3B-BD3F-C1651DCD99DB}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Masking"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{E7C8192A-D1F1-4E6F-B879-36215BD4EB9D}"
          SQLTask:SqlStatementSource="UPDATE A SET  A.MASKED_NATIONAL_ID=U.MASKED_NATIONAL_ID FROM DW_NATIONAL_ID_MASKING U JOIN   DW_EXT_PFP  A ON A.UIN=U.NATIONAL_ID" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\update on failure"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{10AEACBC-50A0-4AD3-984B-849EBBA84800}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="update on failure"
      DTS:ThreadHint="1">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{E7C8192A-D1F1-4E6F-B879-36215BD4EB9D}"
          SQLTask:SqlStatementSource="   UPDATE [DBO].[ETL_JOB_STATUS]&#xA;  SET [JOB_STATUS]='Fail',&#xA;[ERROR_MSG]='Last Job not completed sucessfully'&#xA;  where [JOB_STATUS_ID]=?&#xA;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
          <SQLTask:ParameterBinding
            SQLTask:ParameterName="0"
            SQLTask:DtsVariableName="User::JobStatusId"
            SQLTask:ParameterDirection="Input"
            SQLTask:DataType="3"
            SQLTask:ParameterSize="-1" />
        </SQLTask:SqlTaskData>
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\UpdateJobStatus"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{04832B96-6C78-4F24-B372-AC30339C2622}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="UpdateJobStatus"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{E7C8192A-D1F1-4E6F-B879-36215BD4EB9D}"
          SQLTask:SqlStatementSource="&#xA; &#xA;&#xA;DECLARE &#xA;@jobstatusid INT&#xA;select @jobstatusid=?&#xA;IF EXISTS(SELECT * FROM dbo.ETL_ERROR_LOG WHERE [JOB_STATUS_ID]=@jobstatusid)&#xA;&#xA; BEGIN&#xA;&#xA;&#xA;&#xA; UPDATE [dbo].[ETL_JOB_STATUS]&#xA;&#xA;SET [PROCESSED_ON] =GETDATE(),&#xA;&#xA;[JOB_STATUS]='FAIL'&#xA;&#xA;WHERE [JOB_STATUS_ID]=@jobstatusid&#xA;&#xA;  END&#xA;&#xA;ELSE&#xA;&#xA;BEGIN&#xA;&#xA;UPDATE [DBO].[ETL_JOB_STATUS]&#xA;&#xA;SET [PROCESSED_ON] =GETDATE(),&#xA;&#xA;[JOB_STATUS]='Success'&#xA;&#xA;WHERE [JOB_STATUS_ID]=@jobstatusid&#xA;&#xA;END&#xA;&#xA; " xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
          <SQLTask:ParameterBinding
            SQLTask:ParameterName="0"
            SQLTask:DtsVariableName="User::JobStatusId"
            SQLTask:ParameterDirection="Input"
            SQLTask:DataType="3"
            SQLTask:ParameterSize="-1" />
        </SQLTask:SqlTaskData>
      </DTS:ObjectData>
    </DTS:Executable>
  </DTS:Executables>
  <DTS:PrecedenceConstraints>
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint]"
      DTS:CreationName=""
      DTS:DTSID="{2EAD9827-DF6D-467F-8B58-4CF08C0C63FF}"
      DTS:EvalOp="1"
      DTS:Expression="@[User::PrevJobStatus]==0"
      DTS:From="Package\check previous job status"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint"
      DTS:To="Package\update on failure" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 1]"
      DTS:CreationName=""
      DTS:DTSID="{953FDA2E-0988-4D75-81F7-0278CC79B7A3}"
      DTS:From="Package\Create ETL Job Log"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 1"
      DTS:To="Package\get Job Status Id" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 2]"
      DTS:CreationName=""
      DTS:DTSID="{55D0AB78-495F-4DFD-9DE5-788CE8741494}"
      DTS:From="Package\getprocesseddate"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 2"
      DTS:To="Package\insert into main table" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 3]"
      DTS:CreationName=""
      DTS:DTSID="{A8B2891C-8B17-4A81-A3F8-95AD78041A2D}"
      DTS:EvalOp="1"
      DTS:Expression="@[User::PrevJobStatus]==1"
      DTS:From="Package\check previous job status"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 3"
      DTS:To="Package\getprocesseddate" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 4]"
      DTS:CreationName=""
      DTS:DTSID="{3E6D4B4A-8E1F-46FF-AC93-97F9A8233B4D}"
      DTS:From="Package\get Job Status Id"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 4"
      DTS:To="Package\check previous job status" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 5]"
      DTS:CreationName=""
      DTS:DTSID="{89E13F65-6F97-4772-B5DF-11A983438731}"
      DTS:From="Package\insert into main table"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 5"
      DTS:To="Package\Masking" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 6]"
      DTS:CreationName=""
      DTS:DTSID="{54A6F08B-3B31-424F-A7CF-3B272A93EB9B}"
      DTS:From="Package\Masking"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 6"
      DTS:To="Package\UpdateJobStatus" />
  </DTS:PrecedenceConstraints>
  <DTS:EventHandlers>
    <DTS:EventHandler
      DTS:refId="Package.EventHandlers[OnError]"
      DTS:CreationName="OnError"
      DTS:DTSID="{8B8114A1-EDA5-4300-A9EA-06498D796E61}"
      DTS:EventID="0"
      DTS:EventName="OnError"
      DTS:LocaleID="-1">
      <DTS:Variables>
        <DTS:Variable
          DTS:CreationName=""
          DTS:Description="The propagate property of the event"
          DTS:DTSID="{0BE23A03-7A7B-4BCE-9ED7-608D868FFFFC}"
          DTS:IncludeInDebugDump="6789"
          DTS:Namespace="System"
          DTS:ObjectName="Propagate">
          <DTS:VariableValue
            DTS:DataType="11">-1</DTS:VariableValue>
        </DTS:Variable>
      </DTS:Variables>
      <DTS:Executables>
        <DTS:Executable
          DTS:refId="Package.EventHandlers[OnError]\Error Log"
          DTS:CreationName="Microsoft.ExecuteSQLTask"
          DTS:Description="Execute SQL Task"
          DTS:DTSID="{9AA22F27-C2B7-4767-8607-48BF34C7B91D}"
          DTS:ExecutableType="Microsoft.ExecuteSQLTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="Error Log">
          <DTS:Variables />
          <DTS:ObjectData>
            <SQLTask:SqlTaskData
              SQLTask:Connection="{E7C8192A-D1F1-4E6F-B879-36215BD4EB9D}"
              SQLTask:SqlStatementSource="  insert into [dbo].[ETL_ERROR_LOG]([JOB_STATUS_ID],[ERROR_RECORD])&#xA;  select ?,?" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="1"
                SQLTask:DtsVariableName="System::ErrorDescription"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="130"
                SQLTask:ParameterSize="-1" />
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="0"
                SQLTask:DtsVariableName="User::JobStatusId"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="3"
                SQLTask:ParameterSize="-1" />
            </SQLTask:SqlTaskData>
          </DTS:ObjectData>
        </DTS:Executable>
        <DTS:Executable
          DTS:refId="Package.EventHandlers[OnError]\ETL Job Status Log"
          DTS:CreationName="Microsoft.ExecuteSQLTask"
          DTS:Description="Execute SQL Task"
          DTS:DTSID="{DB79F354-7E69-4EDD-ACF5-D74D0C32520B}"
          DTS:ExecutableType="Microsoft.ExecuteSQLTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="ETL Job Status Log">
          <DTS:Variables />
          <DTS:ObjectData>
            <SQLTask:SqlTaskData
              SQLTask:Connection="{E7C8192A-D1F1-4E6F-B879-36215BD4EB9D}"
              SQLTask:SqlStatementSource="update [ETL_JOB_STATUS]&#xA;set Job_Status='Fail'&#xA;,Error_Msg=?&#xA;where job_status_id=?" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="0"
                SQLTask:DtsVariableName="System::ErrorDescription"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="130"
                SQLTask:ParameterSize="-1" />
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="1"
                SQLTask:DtsVariableName="User::JobStatusId"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="3"
                SQLTask:ParameterSize="-1" />
            </SQLTask:SqlTaskData>
          </DTS:ObjectData>
        </DTS:Executable>
      </DTS:Executables>
      <DTS:PrecedenceConstraints>
        <DTS:PrecedenceConstraint
          DTS:refId="Package.EventHandlers[OnError].PrecedenceConstraints[Constraint]"
          DTS:CreationName=""
          DTS:DTSID="{CF74E736-8957-4C15-AE6E-34BC34604527}"
          DTS:From="Package.EventHandlers[OnError]\Error Log"
          DTS:LogicalAnd="True"
          DTS:ObjectName="Constraint"
          DTS:To="Package.EventHandlers[OnError]\ETL Job Status Log" />
      </DTS:PrecedenceConstraints>
    </DTS:EventHandler>
  </DTS:EventHandlers>
  <DTS:DesignTimeProperties><![CDATA[<?xml version="1.0"?>
<!--This CDATA section contains the layout information of the package. The section includes information such as (x,y) coordinates, width, and height.-->
<!--If you manually edit this section and make a mistake, you can delete it. -->
<!--The package will still be able to load normally but the previous layout information will be lost and the designer will automatically re-arrange the elements on the design surface.-->
<Objects
  Version="8">
  <!--Each node below will contain properties that do not affect runtime behavior.-->
  <Package
    design-time-name="Package">
    <LayoutInfo>
      <GraphLayout
        Capacity="16" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:mssgm="clr-namespace:Microsoft.SqlServer.Graph.Model;assembly=Microsoft.SqlServer.Graph">
        <NodeLayout
          Size="198,42"
          Id="Package\check previous job status"
          TopLeft="415,32" />
        <NodeLayout
          Size="170,42"
          Id="Package\Create ETL Job Log"
          TopLeft="9,30" />
        <NodeLayout
          Size="159,42"
          Id="Package\get Job Status Id"
          TopLeft="225,31" />
        <NodeLayout
          Size="162,42"
          Id="Package\getprocesseddate"
          TopLeft="660,29" />
        <NodeLayout
          Size="179,42"
          Id="Package\insert into main table"
          TopLeft="648,128" />
        <NodeLayout
          Size="117,42"
          Id="Package\Masking"
          TopLeft="882,161" />
        <NodeLayout
          Size="159,42"
          Id="Package\update on failure"
          TopLeft="418,164" />
        <NodeLayout
          Size="158,42"
          Id="Package\UpdateJobStatus"
          TopLeft="661,214" />
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint]"
          TopLeft="514,74">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="-16.5,90"
              Start="0,0"
              End="-16.5,82.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,41" />
                  <mssgle:CubicBezierSegment
                    Point1="0,41"
                    Point2="0,45"
                    Point3="-4,45" />
                  <mssgle:LineSegment
                    End="-12.5,45" />
                  <mssgle:CubicBezierSegment
                    Point1="-12.5,45"
                    Point2="-16.5,45"
                    Point3="-16.5,49" />
                  <mssgle:LineSegment
                    End="-16.5,82.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <mssgm:EdgeLabel
              BoundingBox="-16.25,50,16,16"
              RelativePosition="Any" />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 1]"
          TopLeft="179,51.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="46,0"
              Start="0,0"
              End="38.5,0">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="38.5,0" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 2]"
          TopLeft="739.25,71">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,57"
              Start="0,0"
              End="0,49.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,49.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 3]"
          TopLeft="613,51.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="47,0"
              Start="0,0"
              End="39.5,0">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="39.5,0" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <mssgm:EdgeLabel
              BoundingBox="11.75,5,16,16"
              RelativePosition="Any" />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 4]"
          TopLeft="384,52.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="31,0"
              Start="0,0"
              End="23.5,0">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="23.5,0" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 5]"
          TopLeft="827,149">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="55,33"
              Start="0,0"
              End="47.5,33">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="23.5,0" />
                  <mssgle:CubicBezierSegment
                    Point1="23.5,0"
                    Point2="27.5,0"
                    Point3="27.5,4" />
                  <mssgle:LineSegment
                    End="27.5,29" />
                  <mssgle:CubicBezierSegment
                    Point1="27.5,29"
                    Point2="27.5,33"
                    Point3="31.5,33" />
                  <mssgle:LineSegment
                    End="47.5,33" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 6]"
          TopLeft="882,187.666666666667">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="-63,47.3333333333333"
              Start="0,0"
              End="-55.5,47.3333333333333">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="-22.5871559633028,0" />
                  <mssgle:CubicBezierSegment
                    Point1="-22.5871559633028,0"
                    Point2="-26.5871559633028,0"
                    Point3="-26.5871559633028,4" />
                  <mssgle:LineSegment
                    End="-26.5871559633028,43.3333333333333" />
                  <mssgle:CubicBezierSegment
                    Point1="-26.5871559633028,43.3333333333333"
                    Point2="-26.5871559633028,47.3333333333333"
                    Point3="-30.5871559633028,47.3333333333333" />
                  <mssgle:LineSegment
                    End="-55.5,47.3333333333333" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </Package>
  <DtsEventHandler
    design-time-name="Package.EventHandlers[OnError]">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:mssgm="clr-namespace:Microsoft.SqlServer.Graph.Model;assembly=Microsoft.SqlServer.Graph">
        <NodeLayout
          Size="123,42"
          Id="Package.EventHandlers[OnError]\Error Log"
          TopLeft="60,60" />
        <NodeLayout
          Size="169,42"
          Id="Package.EventHandlers[OnError]\ETL Job Status Log"
          TopLeft="60,162" />
        <EdgeLayout
          Id="Package.EventHandlers[OnError].PrecedenceConstraints[Constraint]"
          TopLeft="121.5,102">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="23,60"
              Start="0,0"
              End="23,52.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,26" />
                  <mssgle:CubicBezierSegment
                    Point1="0,26"
                    Point2="0,30"
                    Point3="4,30" />
                  <mssgle:LineSegment
                    End="19,30" />
                  <mssgle:CubicBezierSegment
                    Point1="19,30"
                    Point2="23,30"
                    Point3="23,34" />
                  <mssgle:LineSegment
                    End="23,52.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <mssgm:EdgeLabel
              BoundingBox="0,0,0,0"
              RelativePosition="Any" />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </DtsEventHandler>
</Objects>]]></DTS:DesignTimeProperties>
</DTS:Executable>