<?xml version="1.0"?>
<DTS:Executable xmlns:DTS="www.microsoft.com/SqlServer/Dts"
  DTS:refId="Package"
  DTS:CreationDate="1/30/2019 1:46:31 PM"
  DTS:CreationName="Microsoft.Package"
  DTS:CreatorComputerName="NCS-110119GM22"
  DTS:CreatorName="NCS\P0500388"
  DTS:DelayValidation="True"
  DTS:DTSID="{22352103-85EC-4C80-AD74-2CBDE8C1777B}"
  DTS:ExecutableType="Microsoft.Package"
  DTS:LastModifiedProductVersion="15.0.0900.40"
  DTS:LocaleID="18441"
  DTS:ObjectName="STG_EXT_FIN_AID_OUTCOME_STATUS"
  DTS:PackageType="5"
  DTS:VersionBuild="126"
  DTS:VersionGUID="{35B8CCF8-4737-40C0-A203-5D5CD1EE0CD6}">
  <DTS:Property
    DTS:Name="PackageFormatVersion">8</DTS:Property>
  <DTS:ConnectionManagers>
    <DTS:ConnectionManager
      DTS:refId="Package.ConnectionManagers[ErrorLog]"
      DTS:CreationName="OLEDB"
      DTS:DTSID="{667BF556-E39C-4CE9-9715-4F548183EDF5}"
      DTS:ObjectName="ErrorLog">
      <DTS:PropertyExpression
        DTS:Name="InitialCatalog">@[$Project::DW_Initial_Catalog]</DTS:PropertyExpression>
      <DTS:PropertyExpression
        DTS:Name="Password">@[$Project::Password]</DTS:PropertyExpression>
      <DTS:PropertyExpression
        DTS:Name="ServerName">@[$Project::ServerName]</DTS:PropertyExpression>
      <DTS:PropertyExpression
        DTS:Name="UserName">@[$Project::UserName]</DTS:PropertyExpression>
      <DTS:ObjectData>
        <DTS:ConnectionManager
          DTS:ConnectionString="Data Source=10.168.212.13;User ID=svc-dw-uat-etl;Initial Catalog=RPDW;Provider=SQLNCLI11.1;Integrated Security=SSPI;Auto Translate=False;" />
      </DTS:ObjectData>
    </DTS:ConnectionManager>
    <DTS:ConnectionManager
      DTS:refId="Package.ConnectionManagers[PSTG]"
      DTS:CreationName="OLEDB"
      DTS:DTSID="{0DDA9EEA-C132-4BF8-84DB-F5ED4DED3441}"
      DTS:ObjectName="PSTG">
      <DTS:PropertyExpression
        DTS:Name="InitialCatalog">@[$Project::PreStaging_Initial_Catalog]</DTS:PropertyExpression>
      <DTS:PropertyExpression
        DTS:Name="Password">@[$Project::Password]</DTS:PropertyExpression>
      <DTS:PropertyExpression
        DTS:Name="ServerName">@[$Project::ServerName]</DTS:PropertyExpression>
      <DTS:PropertyExpression
        DTS:Name="UserName">@[$Project::UserName]</DTS:PropertyExpression>
      <DTS:ObjectData>
        <DTS:ConnectionManager
          DTS:ConnectionString="Data Source=10.168.212.13;User ID=svc-dw-uat-etl;Initial Catalog=RPDW_PSTG;Provider=SQLNCLI11.1;Integrated Security=SSPI;Auto Translate=False;" />
      </DTS:ObjectData>
    </DTS:ConnectionManager>
    <DTS:ConnectionManager
      DTS:refId="Package.ConnectionManagers[STG]"
      DTS:CreationName="OLEDB"
      DTS:DTSID="{C4063684-FFCF-4E79-B330-DA34E5411B99}"
      DTS:ObjectName="STG">
      <DTS:PropertyExpression
        DTS:Name="InitialCatalog">@[$Project::Staging_Initial_Catalog]</DTS:PropertyExpression>
      <DTS:PropertyExpression
        DTS:Name="Password">@[$Project::Password]</DTS:PropertyExpression>
      <DTS:PropertyExpression
        DTS:Name="ServerName">@[$Project::ServerName]</DTS:PropertyExpression>
      <DTS:PropertyExpression
        DTS:Name="UserName">@[$Project::UserName]</DTS:PropertyExpression>
      <DTS:ObjectData>
        <DTS:ConnectionManager
          DTS:ConnectionString="Data Source=10.168.212.13;User ID=svc-dw-uat-etl;Initial Catalog=RPDW_STG;Provider=SQLNCLI11.1;Integrated Security=SSPI;Auto Translate=False;" />
      </DTS:ObjectData>
    </DTS:ConnectionManager>
  </DTS:ConnectionManagers>
  <DTS:Variables>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{71FF3912-4CFE-42DC-9CBF-C3D34EAC27F2}"
      DTS:IncludeInDebugDump="6789"
      DTS:Namespace="User"
      DTS:ObjectName="Duplicate_Check">
      <DTS:VariableValue
        DTS:DataType="3">0</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{8B254B95-6D6C-4A1A-9FF4-EE9D3993C6A7}"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="Job_name">
      <DTS:VariableValue
        DTS:DataType="8">STG_EXT_FIN_AID_OUTCOME_STATUS</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{D0519B01-F8EE-44EA-8BCA-F2B22C4F5114}"
      DTS:IncludeInDebugDump="6789"
      DTS:Namespace="User"
      DTS:ObjectName="Job_Status">
      <DTS:VariableValue
        DTS:DataType="3">1</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{D2C25F2B-6213-4F8C-BF7E-A7F862D40DF3}"
      DTS:IncludeInDebugDump="6789"
      DTS:Namespace="User"
      DTS:ObjectName="JOB_STATUS_ID">
      <DTS:VariableValue
        DTS:DataType="3">0</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{86BDBF89-D1A2-47AF-96CE-8D7BF1120828}"
      DTS:IncludeInDebugDump="6789"
      DTS:Namespace="User"
      DTS:ObjectName="Mandatory_constraint_Check">
      <DTS:VariableValue
        DTS:DataType="3">0</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{7967B72B-5EA2-4448-8602-ABB8D7E1A9B2}"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="PreStage">
      <DTS:VariableValue
        DTS:DataType="8">PSTG</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{BF60CE5B-0D7C-4C59-A861-402F98BBB9D6}"
      DTS:IncludeInDebugDump="6789"
      DTS:Namespace="User"
      DTS:ObjectName="Process_date">
      <DTS:VariableValue
        DTS:DataType="7">2/1/2019 2:58:00 PM</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{101D6241-5BE4-4624-BF3D-B0AECCD99687}"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="SourceTable">
      <DTS:VariableValue
        DTS:DataType="8">PSTG_EXT_FIN_AID_OUTCOME_STATUS</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{40159F2B-9C48-491B-A41C-C58A028516D1}"
      DTS:EvaluateAsExpression="True"
      DTS:Expression="&quot;BEGIN TRANSACTION&#xA;BEGIN TRY&#xA;--------------------------------------&#xA;&#xA;declare @MandColValidation int,&#xA;@NoDuplicates int,&#xA;@Job_Status_ID int&#xA;SELECT  @NoDuplicates=?&#xA;SELECT @MandColValidation=?&#xA;SELECT @Job_Status_ID=?&#xA;&#xA;if(@NoDuplicates&lt;&gt;0 or @MandColValidation&lt;&gt;0)&#xA;&#xA;begin &#xA;insert into [dbo].[ETL_ERROR_LOG](JOB_STATUS_ID,ERROR_RECORD) &#xA;SELECT  @Job_Status_ID JOB_STATUS_ID, ''+[Acad_Yr]+', '+[Student_ID] +', '+[App_Type] +', '+[App_Status] +' , '+[App_ID] +' ,is duplicate primary key in source file' as ErrorColValues&#xA;FROM &quot;+ @[$Project::PreStaging_Initial_Catalog] +&quot;.[dbo].[PSTG_EXT_FIN_AID_OUTCOME_STATUS]&#xA;GROUP&#xA;BY  [Acad_Yr],[Student_ID],[App_ID],[App_Type],[App_Status]&#xA;having count(1)&gt;1&#xA;union all&#xA;SELECT    @Job_Status_ID JOB_STATUS_ID, ''+[Acad_Yr]+', '+[Student_ID] +', '+[App_Type] +', '+[App_Status] +' , '+[App_ID] +' ,Mandatory columns Issues'  as ErrorColValues&#xA;FROM &quot;+ @[$Project::PreStaging_Initial_Catalog] +&quot;.[dbo].[PSTG_EXT_FIN_AID_OUTCOME_STATUS]&#xA;where  ([Acad_Yr]='' or [Student_ID]='' OR [App_ID]='' or [App_Type]='' or [App_Status]=''&#xA; or [Acad_Yr] IS NULL or [Student_ID] IS NULL OR [App_ID] IS NULL or [App_Type] IS NULL or [App_Status] IS NULL)&#xA;GROUP BY   [Acad_Yr],[Student_ID],[App_ID],[App_Type],[App_Status]&#xA;END&#xA;else&#xA;select 'Unknown Error','Check the file and rerun the package'&#xA;&#xA;&#xA;IF @NoDuplicates&lt;&gt;0&#xA;&#xA;UPDATE [dbo].[ETL_JOB_STATUS]&#xA;SET [JOB_STATUS]='Fail',&#xA;[ERROR_MSG]='Duplicate primary key found in PSTG table'&#xA;WHERE JOB_STATUS_ID=@Job_Status_ID&#xA;&#xA;ELSE IF @MandColValidation&lt;&gt;0&#xA;UPDATE [dbo].[ETL_JOB_STATUS]&#xA;SET [JOB_STATUS]='Fail',&#xA;[ERROR_MSG]='Mandatory Columns constraint in PSTG table'&#xA;WHERE JOB_STATUS_ID=@Job_Status_ID&#xA;&#xA;ELSE&#xA;SELECT 'UNKNOWN'&#xA;&#xA;&#xA;--------------------------------------&#xA;COMMIT TRANSACTION&#xA;END TRY&#xA;&#xA;BEGIN CATCH&#xA;  ROLLBACK TRANSACTION&#xA;END CATCH  &#xA;GO&quot;"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="SQL_Script_Constraint">
      <DTS:VariableValue
        DTS:DataType="8">BEGIN TRANSACTION
BEGIN TRY
--------------------------------------

declare @MandColValidation int,
@NoDuplicates int,
@Job_Status_ID int
SELECT  @NoDuplicates=?
SELECT @MandColValidation=?
SELECT @Job_Status_ID=?

if(@NoDuplicates&lt;&gt;0 or @MandColValidation&lt;&gt;0)

begin 
insert into [dbo].[ETL_ERROR_LOG](JOB_STATUS_ID,ERROR_RECORD) 
SELECT  @Job_Status_ID JOB_STATUS_ID, ''+[Acad_Yr]+', '+[Student_ID] +', '+[App_Type] +', '+[App_Status] +' , '+[App_ID] +' ,is duplicate primary key in source file' as ErrorColValues
FROM RPDW_PSTG.[dbo].[PSTG_EXT_FIN_AID_OUTCOME_STATUS]
GROUP
BY  [Acad_Yr],[Student_ID],[App_ID],[App_Type],[App_Status]
having count(1)&gt;1
union all
SELECT    @Job_Status_ID JOB_STATUS_ID, ''+[Acad_Yr]+', '+[Student_ID] +', '+[App_Type] +', '+[App_Status] +' , '+[App_ID] +' ,Mandatory columns Issues'  as ErrorColValues
FROM RPDW_PSTG.[dbo].[PSTG_EXT_FIN_AID_OUTCOME_STATUS]
where  ([Acad_Yr]='' or [Student_ID]='' OR [App_ID]='' or [App_Type]='' or [App_Status]=''
 or [Acad_Yr] IS NULL or [Student_ID] IS NULL OR [App_ID] IS NULL or [App_Type] IS NULL or [App_Status] IS NULL)
GROUP BY   [Acad_Yr],[Student_ID],[App_ID],[App_Type],[App_Status]
END
else
select 'Unknown Error','Check the file and rerun the package'


IF @NoDuplicates&lt;&gt;0

UPDATE [dbo].[ETL_JOB_STATUS]
SET [JOB_STATUS]='Fail',
[ERROR_MSG]='Duplicate primary key found in PSTG table'
WHERE JOB_STATUS_ID=@Job_Status_ID

ELSE IF @MandColValidation&lt;&gt;0
UPDATE [dbo].[ETL_JOB_STATUS]
SET [JOB_STATUS]='Fail',
[ERROR_MSG]='Mandatory Columns constraint in PSTG table'
WHERE JOB_STATUS_ID=@Job_Status_ID

ELSE
SELECT 'UNKNOWN'


--------------------------------------
COMMIT TRANSACTION
END TRY

BEGIN CATCH
  ROLLBACK TRANSACTION
END CATCH  
GO</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{80DC3687-BC13-4A21-8D5E-2A4CF304C104}"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="STAGE">
      <DTS:VariableValue
        DTS:DataType="8">STG</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{17CE0963-93EB-4D55-AC5A-9C99CCC6DE79}"
      DTS:EvaluateAsExpression="True"
      DTS:Expression="&quot;&#xA;BEGIN TRANSACTION&#xA;BEGIN TRY&#xA;--------------------------------------&#xA;DECLARE @jobstatusid varchar(10)&#xA;select @jobstatusid=&quot;+ (DT_STR, 5,1252) @[User::JOB_STATUS_ID] +&quot;&#xA;&#xA;&#xA;DELETE FROM [dbo].[STG_EXT_FIN_AID_OUTCOME_STATUS] &#xA;where  exists (select * from TMP_STG_EXT_FIN_AID_OUTCOME_STATUS b&#xA;where STG_EXT_FIN_AID_OUTCOME_STATUS.Acad_Yr=b.Acad_Yr and STG_EXT_FIN_AID_OUTCOME_STATUS.App_Type=b.App_Type )&#xA;&#xA;&#xA;INSERT INTO [dbo].[STG_EXT_FIN_AID_OUTCOME_STATUS] &#xA;&#xA;SELECT  [Acad_Yr]&#xA;      ,[Acad_Term]&#xA;      ,[Student_ID]&#xA;      ,[Fin_Aid_Category]&#xA;      ,[Fin_Aid_Type]&#xA;      ,[Fin_Aid_Desc]&#xA;      ,[Fin_Aid_Status_Desc]&#xA;      ,[App_ID]&#xA;      ,[App_Type]&#xA;      ,[App_Status]&#xA;      ,[Award_ID]&#xA;      ,CAST([Award_Amt] as decimal(8,2))&#xA;      ,CAST([Date_Updated] as date)&#xA;      ,[Award_Remarks]&#xA;      ,[Eligibility_Govt_Bursary]&#xA;      ,CAST([Verified_GHI_Award] as decimal(8,2))&#xA;      ,CAST([Verified_PCI_Award] as decimal(8,2))&#xA;      ,Cast([Num_Household_Members] as tinyint)&#xA;      ,[Property_Type]&#xA;      ,[Tenancy_Type]&#xA;      ,[Special_Circumstances]&#xA;      ,[Remarks_Staff_Verifier]&#xA;&#x9;  ,'Y'&#xA;&#x9;  ,getdate()&#xA;&#x9;  ,getdate()&#xA;FROM [dbo].[TMP_STG_EXT_FIN_AID_OUTCOME_STATUS]&#xA;&#xA;&#xA;COMMIT TRANSACTION&#xA;END TRY&#xA;&#xA;BEGIN CATCH&#xA;ROLLBACK TRANSACTION&#xA;&#xA;  INSERT INTO &quot;+ @[$Project::DW_Initial_Catalog]+&quot;..ETL_ERROR_LOG(JOB_STATUS_ID,ERROR_RECORD,created_on)&#xA;  SELECT   &#xA;         CAST(@jobstatusid as int) as JOB_STATUS_ID&#xA;        ,ERROR_MESSAGE() AS ErrorMessage&#xA;&#x9;&#x9;,getdate()  as created_on&#xA;END CATCH  &#xA;GO&quot;"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="stg_load">
      <DTS:VariableValue
        DTS:DataType="8">
BEGIN TRANSACTION
BEGIN TRY
--------------------------------------
DECLARE @jobstatusid varchar(10)
select @jobstatusid=0


DELETE FROM [dbo].[STG_EXT_FIN_AID_OUTCOME_STATUS] 
where  exists (select * from TMP_STG_EXT_FIN_AID_OUTCOME_STATUS b
where STG_EXT_FIN_AID_OUTCOME_STATUS.Acad_Yr=b.Acad_Yr and STG_EXT_FIN_AID_OUTCOME_STATUS.App_Type=b.App_Type )


INSERT INTO [dbo].[STG_EXT_FIN_AID_OUTCOME_STATUS] 

SELECT  [Acad_Yr]
      ,[Acad_Term]
      ,[Student_ID]
      ,[Fin_Aid_Category]
      ,[Fin_Aid_Type]
      ,[Fin_Aid_Desc]
      ,[Fin_Aid_Status_Desc]
      ,[App_ID]
      ,[App_Type]
      ,[App_Status]
      ,[Award_ID]
      ,CAST([Award_Amt] as decimal(8,2))
      ,CAST([Date_Updated] as date)
      ,[Award_Remarks]
      ,[Eligibility_Govt_Bursary]
      ,CAST([Verified_GHI_Award] as decimal(8,2))
      ,CAST([Verified_PCI_Award] as decimal(8,2))
      ,Cast([Num_Household_Members] as tinyint)
      ,[Property_Type]
      ,[Tenancy_Type]
      ,[Special_Circumstances]
      ,[Remarks_Staff_Verifier]
	  ,'Y'
	  ,getdate()
	  ,getdate()
FROM [dbo].[TMP_STG_EXT_FIN_AID_OUTCOME_STATUS]


COMMIT TRANSACTION
END TRY

BEGIN CATCH
ROLLBACK TRANSACTION

  INSERT INTO RPDW..ETL_ERROR_LOG(JOB_STATUS_ID,ERROR_RECORD,created_on)
  SELECT   
         CAST(@jobstatusid as int) as JOB_STATUS_ID
        ,ERROR_MESSAGE() AS ErrorMessage
		,getdate()  as created_on
END CATCH  
GO</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{012D51C9-5888-45E2-80B4-2DEA43097A3A}"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="TgtTableName">
      <DTS:VariableValue
        DTS:DataType="8">STG_EXT_FIN_AID_OUTCOME_STATUS</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{FAAFECCA-DF62-49AB-B91B-0C3099F5D4FA}"
      DTS:EvaluateAsExpression="True"
      DTS:Expression="&quot;&#xA;INSERT INTO &quot;+ @[$Project::Staging_Initial_Catalog] +&quot;..TMP_STG_EXT_FIN_AID_OUTCOME_STATUS&#xA;&#xA;SELECT  CAST([Acad_Yr] as varchar (6)) [Acad_Yr]&#xA;      ,CAST([Acad_Term] as varchar (6))[Acad_Term]&#xA;      ,CAST([Student_ID] as Varchar(10)) [Student_ID]&#xA;      ,CAST([Fin_Aid_Category] as varchar(50)) [Fin_Aid_Category]&#xA;      ,CAST([Fin_Aid_Type] as varchar(100)) [Fin_Aid_Type]&#xA;      ,CAST([Fin_Aid_Desc] as varchar(200)) [Fin_Aid_Desc]&#xA;      ,CAST([Fin_Aid_Status_Desc] as varchar(50)) [Fin_Aid_Status_Desc]&#xA;      ,CAST([App_ID] as varchar(50)) [App_ID]&#xA;      ,CAST([App_Type] as varchar(50)) [App_Type]&#xA;      ,CAST([App_Status] as varchar(50)) [App_Status]&#xA;      ,CAST([Award_ID] as  varchar(50)) [Award_ID]&#xA;      ,CAST([Award_Amt] as decimal(8,2)) Award_Amt&#xA;      ,CAST([Date_Updated] as date) Date_Updated&#xA;      ,CAST([Award_Remarks] as varchar(100)) [Award_Remarks]&#xA;      ,CAST([Eligibility_Govt_Bursary] as varchar(1)) [Eligibility_Govt_Bursary]&#xA;      ,CAST([Verified_GHI_Award] as decimal(8,2)) Verified_GHI_Award&#xA;      ,CAST([Verified_PCI_Award] as decimal(8,2)) Verified_PCI_Award&#xA;      ,Cast([Num_Household_Members] as tinyint) Num_Household_Members&#xA;      ,cast([Property_Type] as varchar(50)) [Property_Type]&#xA;      ,CAST([Tenancy_Type] as varchar(50)) [Tenancy_Type]&#xA;      ,Cast([Special_Circumstances] as varchar(200)) [Special_Circumstances]&#xA;      ,CAST([Remarks_Staff_Verifier] as varchar(200)) [Remarks_Staff_Verifier]&#xA;&#x9;  ,getdate() create_on&#xA;&#x9;  ,getdate() modified_on&#xA;FROM [dbo].[PSTG_EXT_FIN_AID_OUTCOME_STATUS]&quot;"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="TMP_load">
      <DTS:VariableValue
        DTS:DataType="8">
INSERT INTO RPDW_STG..TMP_STG_EXT_FIN_AID_OUTCOME_STATUS

SELECT  CAST([Acad_Yr] as varchar (6)) [Acad_Yr]
      ,CAST([Acad_Term] as varchar (6))[Acad_Term]
      ,CAST([Student_ID] as Varchar(10)) [Student_ID]
      ,CAST([Fin_Aid_Category] as varchar(50)) [Fin_Aid_Category]
      ,CAST([Fin_Aid_Type] as varchar(100)) [Fin_Aid_Type]
      ,CAST([Fin_Aid_Desc] as varchar(200)) [Fin_Aid_Desc]
      ,CAST([Fin_Aid_Status_Desc] as varchar(50)) [Fin_Aid_Status_Desc]
      ,CAST([App_ID] as varchar(50)) [App_ID]
      ,CAST([App_Type] as varchar(50)) [App_Type]
      ,CAST([App_Status] as varchar(50)) [App_Status]
      ,CAST([Award_ID] as  varchar(50)) [Award_ID]
      ,CAST([Award_Amt] as decimal(8,2)) Award_Amt
      ,CAST([Date_Updated] as date) Date_Updated
      ,CAST([Award_Remarks] as varchar(100)) [Award_Remarks]
      ,CAST([Eligibility_Govt_Bursary] as varchar(1)) [Eligibility_Govt_Bursary]
      ,CAST([Verified_GHI_Award] as decimal(8,2)) Verified_GHI_Award
      ,CAST([Verified_PCI_Award] as decimal(8,2)) Verified_PCI_Award
      ,Cast([Num_Household_Members] as tinyint) Num_Household_Members
      ,cast([Property_Type] as varchar(50)) [Property_Type]
      ,CAST([Tenancy_Type] as varchar(50)) [Tenancy_Type]
      ,Cast([Special_Circumstances] as varchar(200)) [Special_Circumstances]
      ,CAST([Remarks_Staff_Verifier] as varchar(200)) [Remarks_Staff_Verifier]
	  ,getdate() create_on
	  ,getdate() modified_on
FROM [dbo].[PSTG_EXT_FIN_AID_OUTCOME_STATUS]</DTS:VariableValue>
    </DTS:Variable>
  </DTS:Variables>
  <DTS:Executables>
    <DTS:Executable
      DTS:refId="Package\Create ETL Job Log"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{DD0DE287-6DA8-44ED-BFD1-0FB7F0476984}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Create ETL Job Log"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{667BF556-E39C-4CE9-9715-4F548183EDF5}"
          SQLTask:SqlStatementSource="Exec [dbo].[usp_InsertETLJobLog] ?, ?, ?, ?" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
          <SQLTask:ParameterBinding
            SQLTask:ParameterName="0"
            SQLTask:DtsVariableName="User::Job_name"
            SQLTask:ParameterDirection="Input"
            SQLTask:DataType="129"
            SQLTask:ParameterSize="-1" />
          <SQLTask:ParameterBinding
            SQLTask:ParameterName="1"
            SQLTask:DtsVariableName="User::STAGE"
            SQLTask:ParameterDirection="Input"
            SQLTask:DataType="129"
            SQLTask:ParameterSize="-1" />
          <SQLTask:ParameterBinding
            SQLTask:ParameterName="2"
            SQLTask:DtsVariableName="User::SourceTable"
            SQLTask:ParameterDirection="Input"
            SQLTask:DataType="129"
            SQLTask:ParameterSize="-1" />
          <SQLTask:ParameterBinding
            SQLTask:ParameterName="3"
            SQLTask:DtsVariableName="User::TgtTableName"
            SQLTask:ParameterDirection="Input"
            SQLTask:DataType="129"
            SQLTask:ParameterSize="-1" />
        </SQLTask:SqlTaskData>
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Error Log"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{4C3880BB-8DAE-47C3-A14A-49890EA9EAFA}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Error Log"
      DTS:ThreadHint="2">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{667BF556-E39C-4CE9-9715-4F548183EDF5}"
          SQLTask:SqlStatementSource="&#xA;  UPDATE [dbo].[ETL_JOB_STATUS]&#xA;SET&#xA;ERROR_MSG = 'PSTG table is not completed',&#xA;JOB_STATUS ='Fail'&#xA;--PROCESSED_ON =getdate()&#xA;WHERE JOB_STATUS_ID=?" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
          <SQLTask:ParameterBinding
            SQLTask:ParameterName="0"
            SQLTask:DtsVariableName="User::JOB_STATUS_ID"
            SQLTask:ParameterDirection="Input"
            SQLTask:DataType="131"
            SQLTask:ParameterSize="-1" />
        </SQLTask:SqlTaskData>
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\JOB_STATUS_ID"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{220D2550-3BD7-49F6-BE5B-0C937DA0965C}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="JOB_STATUS_ID"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{667BF556-E39C-4CE9-9715-4F548183EDF5}"
          SQLTask:SqlStatementSource="SELECT max([JOB_STATUS_ID])&#xA;      &#xA;  FROM [dbo].[ETL_JOB_STATUS] where [SOURCE_FILENAME]=? &#xA;---and convert(varchar(8),CREATED_ON,112)=convert--(varchar(8) ,getdate(),112)"
          SQLTask:ResultType="ResultSetType_SingleRow" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
          <SQLTask:ResultBinding
            SQLTask:ResultName="0"
            SQLTask:DtsVariableName="User::JOB_STATUS_ID" />
          <SQLTask:ParameterBinding
            SQLTask:ParameterName="0"
            SQLTask:DtsVariableName="User::SourceTable"
            SQLTask:ParameterDirection="Input"
            SQLTask:DataType="129"
            SQLTask:ParameterSize="-1" />
        </SQLTask:SqlTaskData>
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Load Into STG"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{4B61E3A8-D579-4772-9340-476AAB9053B5}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Load Into STG"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{C4063684-FFCF-4E79-B330-DA34E5411B99}"
          SQLTask:SqlStmtSourceType="Variable"
          SQLTask:SqlStatementSource="User::stg_load" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\log to job status table"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{BF067DD6-C7C8-4380-94B8-B8AF53DE225E}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="log to job status table"
      DTS:ThreadHint="1">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{667BF556-E39C-4CE9-9715-4F548183EDF5}"
          SQLTask:SqlStmtSourceType="Variable"
          SQLTask:SqlStatementSource="User::SQL_Script_Constraint" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
          <SQLTask:ParameterBinding
            SQLTask:ParameterName="0"
            SQLTask:DtsVariableName="User::Duplicate_Check"
            SQLTask:ParameterDirection="Input"
            SQLTask:DataType="131"
            SQLTask:ParameterSize="-1" />
          <SQLTask:ParameterBinding
            SQLTask:ParameterName="1"
            SQLTask:DtsVariableName="User::Mandatory_constraint_Check"
            SQLTask:ParameterDirection="Input"
            SQLTask:DataType="131"
            SQLTask:ParameterSize="-1" />
          <SQLTask:ParameterBinding
            SQLTask:ParameterName="2"
            SQLTask:DtsVariableName="User::JOB_STATUS_ID"
            SQLTask:ParameterDirection="Input"
            SQLTask:DataType="131"
            SQLTask:ParameterSize="-1" />
        </SQLTask:SqlTaskData>
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Process_Date"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{77710261-C581-4D55-B503-BBDFB710EB2B}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Process_Date"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{C4063684-FFCF-4E79-B330-DA34E5411B99}"
          SQLTask:SqlStatementSource="Select getdate()"
          SQLTask:ResultType="ResultSetType_SingleRow" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
          <SQLTask:ResultBinding
            SQLTask:ResultName="0"
            SQLTask:DtsVariableName="User::Process_date" />
        </SQLTask:SqlTaskData>
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\TMP Load"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{4A74017F-3CF1-44A0-A812-49B816A105F4}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="TMP Load"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{0DDA9EEA-C132-4BF8-84DB-F5ED4DED3441}"
          SQLTask:SqlStmtSourceType="Variable"
          SQLTask:SqlStatementSource="User::TMP_load" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Truncate Temp Table"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{870279A7-786A-464A-9097-C1CA19213FCB}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Truncate Temp Table"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{C4063684-FFCF-4E79-B330-DA34E5411B99}"
          SQLTask:SqlStatementSource="Truncate table [dbo].[TMP_STG_EXT_FIN_AID_OUTCOME_STATUS]" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Update Succes"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{3D9849E0-3613-4AB1-9E20-4DA498D3E660}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Update Succes"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{667BF556-E39C-4CE9-9715-4F548183EDF5}"
          SQLTask:SqlStatementSource="DECLARE &#xA;@jobstatusid INT &#xA;select @jobstatusid=?&#xA;IF exists(select * from dbo.ETL_ERROR_LOG where [JOB_STATUS_ID]=@jobstatusid)&#xA; BEGIN&#xA; Update [dbo].[ETL_JOB_STATUS]&#xA;SET [PROCESSED_ON] =getdate(),&#xA;[JOB_STATUS]='Fail'&#xA;where [JOB_STATUS_ID]=@jobstatusid&#xA;  END&#xA;ELSE&#xA;BEGIN&#xA;Update [dbo].[ETL_JOB_STATUS]&#xA;SET [PROCESSED_ON] =getdate(),&#xA;[JOB_STATUS]='Success'&#xA;where [JOB_STATUS_ID]=@jobstatusid&#xA;END" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
          <SQLTask:ParameterBinding
            SQLTask:ParameterName="0"
            SQLTask:DtsVariableName="User::JOB_STATUS_ID"
            SQLTask:ParameterDirection="Input"
            SQLTask:DataType="131"
            SQLTask:ParameterSize="-1" />
        </SQLTask:SqlTaskData>
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Validate job status"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{32210D60-EC57-482E-92C8-7BF87CF610B6}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Validate job status"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{667BF556-E39C-4CE9-9715-4F548183EDF5}"
          SQLTask:SqlStatementSource="declare @STAGE varchar(100),&#xA;@TARGET_TABLENAME varchar(100)&#xA;select   @STAGE=?&#xA;select   @TARGET_TABLENAME=?&#xA;&#xA;select CASE WHEN JOB_STATUS='Success' then 0 ELSE 1 END AS  JOB_STATUS&#xA;&#xA;from [dbo].[ETL_JOB_STATUS]&#xA;  where STAGE=@STAGE and TARGET_TABLENAME=@TARGET_TABLENAME and &#xA;  JOB_STATUS_ID in (Select max(JOB_STATUS_ID) from [dbo].[ETL_JOB_STATUS]&#xA;  where STAGE=@STAGE and TARGET_TABLENAME=@TARGET_TABLENAME)"
          SQLTask:ResultType="ResultSetType_SingleRow" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
          <SQLTask:ResultBinding
            SQLTask:ResultName="0"
            SQLTask:DtsVariableName="User::Job_Status" />
          <SQLTask:ParameterBinding
            SQLTask:ParameterName="0"
            SQLTask:DtsVariableName="User::PreStage"
            SQLTask:ParameterDirection="Input"
            SQLTask:DataType="129"
            SQLTask:ParameterSize="-1" />
          <SQLTask:ParameterBinding
            SQLTask:ParameterName="1"
            SQLTask:DtsVariableName="User::SourceTable"
            SQLTask:ParameterDirection="Input"
            SQLTask:DataType="129"
            SQLTask:ParameterSize="-1" />
        </SQLTask:SqlTaskData>
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Validate mandatory constraint"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{BE515409-939E-4843-8724-084ABC38FFCE}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Validate mandatory constraint"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{0DDA9EEA-C132-4BF8-84DB-F5ED4DED3441}"
          SQLTask:SqlStatementSource="WITH PSTG_VALIDATION1 &#xA;AS&#xA;(&#xA;SELECT &#xA;&#xA;LTRIM(RTRIM(REPLACE(REPLACE([Acad_Yr],'NULL',''),'&quot;&quot;',''))) [Acad_Yr],&#xA;LTRIM(RTRIM(REPLACE(REPLACE([Student_ID],'NULL',''),'&quot;&quot;',''))) [Student_ID],&#xA;LTRIM(RTRIM(REPLACE(REPLACE([App_ID],'NULL',''),'&quot;&quot;',''))) [App_ID],&#xA;LTRIM(RTRIM(REPLACE(REPLACE([App_Type],'NULL',''),'&quot;&quot;',''))) [App_Type],&#xA;LTRIM(RTRIM(REPLACE(REPLACE([App_Status],'NULL',''),'&quot;&quot;',''))) [App_Status]&#xA;&#xA;FROM [dbo].[PSTG_EXT_FIN_AID_OUTCOME_STATUS])&#xA;SELECT&#xA; CASE WHEN EXISTS(select * from  PSTG_VALIDATION1&#xA;where ([Acad_Yr]='' or [Student_ID]='' OR [App_ID]='' or [App_Type]='' or [App_Status]=''&#xA; or [Acad_Yr] IS NULL or [Student_ID] IS NULL OR [App_ID] IS NULL or [App_Type] IS NULL or [App_Status] IS NULL))&#xA;THEN 1 &#xA;ELSE 0&#xA;END  as MandColValidation"
          SQLTask:ResultType="ResultSetType_SingleRow" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
          <SQLTask:ResultBinding
            SQLTask:ResultName="MandColValidation"
            SQLTask:DtsVariableName="User::Mandatory_constraint_Check" />
        </SQLTask:SqlTaskData>
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Validate primary key constraint"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{36B9BBC1-3182-4F46-AE50-ED5390566A98}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Validate primary key constraint"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{0DDA9EEA-C132-4BF8-84DB-F5ED4DED3441}"
          SQLTask:SqlStatementSource="WITH PSTG_VALIDATION&#xA;&#xA;AS&#xA;(&#xA;SELECT &#xA;&#xA;LTRIM(RTRIM(REPLACE(REPLACE([Acad_Yr],'NULL',''),'&quot;&quot;',''))) [Acad_Yr],&#xA;LTRIM(RTRIM(REPLACE(REPLACE([Student_ID],'NULL',''),'&quot;&quot;',''))) [Student_ID],&#xA;LTRIM(RTRIM(REPLACE(REPLACE([App_ID],'NULL',''),'&quot;&quot;',''))) [App_ID],&#xA;LTRIM(RTRIM(REPLACE(REPLACE([App_Type],'NULL',''),'&quot;&quot;',''))) [App_Type],&#xA;LTRIM(RTRIM(REPLACE(REPLACE([App_Status],'NULL',''),'&quot;&quot;',''))) [App_Status]&#xA;&#xA;&#xA;FROM [dbo].[PSTG_EXT_FIN_AID_OUTCOME_STATUS])&#xA;&#xA;SELECT&#xA;CASE WHEN EXISTS (SELECT  COUNT(1) COUNTOFPK,[Acad_Yr],[Student_ID],[App_ID],[App_Type],[App_Status]&#xA;FROM PSTG_VALIDATION&#xA;GROUP&#xA;BY [Acad_Yr],[Student_ID],[App_ID],[App_Type],[App_Status]&#xA;HAVING COUNT(1)&gt;1)&#xA;THEN 1 &#xA;ELSE 0  &#xA;END Duplicate_Check"
          SQLTask:ResultType="ResultSetType_SingleRow" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
          <SQLTask:ResultBinding
            SQLTask:ResultName="Duplicate_Check"
            SQLTask:DtsVariableName="User::Duplicate_Check" />
        </SQLTask:SqlTaskData>
      </DTS:ObjectData>
    </DTS:Executable>
  </DTS:Executables>
  <DTS:PrecedenceConstraints>
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint]"
      DTS:CreationName=""
      DTS:DTSID="{B7493C86-5E47-4F82-AA37-78030654D2E7}"
      DTS:From="Package\Load Into STG"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint"
      DTS:To="Package\Truncate Temp Table" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 1]"
      DTS:CreationName=""
      DTS:DTSID="{E44890BE-8FDC-463C-8397-264734EF7F66}"
      DTS:From="Package\Validate primary key constraint"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 1"
      DTS:To="Package\Validate mandatory constraint" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 2]"
      DTS:CreationName=""
      DTS:DTSID="{EBBBC529-5240-4B99-882B-688A914804A6}"
      DTS:From="Package\Create ETL Job Log"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 2"
      DTS:To="Package\JOB_STATUS_ID" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 3]"
      DTS:CreationName=""
      DTS:DTSID="{DD5BAFE0-0AA9-47C0-8C88-834CAF75BDCB}"
      DTS:From="Package\JOB_STATUS_ID"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 3"
      DTS:To="Package\Validate job status" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 4]"
      DTS:CreationName=""
      DTS:DTSID="{585DF8BA-0E2C-47C7-92F1-39103E16A13C}"
      DTS:From="Package\Process_Date"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 4"
      DTS:To="Package\Validate primary key constraint" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 5]"
      DTS:CreationName=""
      DTS:DTSID="{FA3A5C5E-4F88-45DC-8635-0D56A5614F30}"
      DTS:From="Package\Validate mandatory constraint"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 5"
      DTS:To="Package\TMP Load" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 6]"
      DTS:CreationName=""
      DTS:DTSID="{4B28D315-8DCE-4E1C-BB35-9A8895C61B35}"
      DTS:From="Package\Truncate Temp Table"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 6"
      DTS:To="Package\Update Succes" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 7]"
      DTS:CreationName=""
      DTS:DTSID="{E4BFE7D9-E512-4250-8074-DC5E7BD04CB0}"
      DTS:From="Package\TMP Load"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 7"
      DTS:To="Package\Load Into STG" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[FALSE]"
      DTS:CreationName=""
      DTS:DTSID="{72A32F2C-A3FD-4728-A50A-C88FE7F1F5F0}"
      DTS:EvalOp="1"
      DTS:Expression="(@[User::Duplicate_Check]==1 || @[User::Mandatory_constraint_Check]==1)"
      DTS:From="Package\Validate mandatory constraint"
      DTS:LogicalAnd="True"
      DTS:ObjectName="FALSE"
      DTS:To="Package\log to job status table" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[False]"
      DTS:CreationName=""
      DTS:DTSID="{FDF8C44B-1530-4A70-8C2B-DA6D169FDF6B}"
      DTS:EvalOp="1"
      DTS:Expression="@[User::Job_Status]==1"
      DTS:From="Package\Validate job status"
      DTS:LogicalAnd="True"
      DTS:ObjectName="False"
      DTS:To="Package\Error Log" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[TRUE]"
      DTS:CreationName=""
      DTS:DTSID="{480BC47B-D01E-4D08-B9A0-91810E8DFFB0}"
      DTS:EvalOp="3"
      DTS:Expression="@[User::Job_Status]==0"
      DTS:From="Package\Validate job status"
      DTS:LogicalAnd="True"
      DTS:ObjectName="TRUE"
      DTS:To="Package\Process_Date" />
  </DTS:PrecedenceConstraints>
  <DTS:EventHandlers>
    <DTS:EventHandler
      DTS:refId="Package.EventHandlers[OnError]"
      DTS:CreationName="OnError"
      DTS:DTSID="{B0324D53-2249-4E81-8DAE-D2FD9DF1C51D}"
      DTS:EventID="0"
      DTS:EventName="OnError"
      DTS:LocaleID="-1">
      <DTS:Variables>
        <DTS:Variable
          DTS:CreationName=""
          DTS:Description="The propagate property of the event"
          DTS:DTSID="{8842A9B6-EF99-4A72-B49E-086C130D8C92}"
          DTS:IncludeInDebugDump="6789"
          DTS:Namespace="System"
          DTS:ObjectName="Propagate">
          <DTS:VariableValue
            DTS:DataType="11">-1</DTS:VariableValue>
        </DTS:Variable>
      </DTS:Variables>
      <DTS:Executables>
        <DTS:Executable
          DTS:refId="Package.EventHandlers[OnError]\ETL_ERROR_LOG"
          DTS:CreationName="Microsoft.ExecuteSQLTask"
          DTS:Description="Execute SQL Task"
          DTS:DTSID="{C303A59B-ADE4-42DF-9A12-E29DCCD86483}"
          DTS:ExecutableType="Microsoft.ExecuteSQLTask"
          DTS:LocaleID="-1"
          DTS:ObjectName="ETL_ERROR_LOG">
          <DTS:Variables />
          <DTS:ObjectData>
            <SQLTask:SqlTaskData
              SQLTask:Connection="{667BF556-E39C-4CE9-9715-4F548183EDF5}"
              SQLTask:SqlStatementSource="[dbo].[usp_InsertETLErrorLog] ?, ?" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask">
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="0"
                SQLTask:DtsVariableName="User::JOB_STATUS_ID"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="131"
                SQLTask:ParameterSize="-1" />
              <SQLTask:ParameterBinding
                SQLTask:ParameterName="1"
                SQLTask:DtsVariableName="System::ErrorDescription"
                SQLTask:ParameterDirection="Input"
                SQLTask:DataType="130"
                SQLTask:ParameterSize="-1" />
            </SQLTask:SqlTaskData>
          </DTS:ObjectData>
        </DTS:Executable>
      </DTS:Executables>
    </DTS:EventHandler>
  </DTS:EventHandlers>
  <DTS:DesignTimeProperties><![CDATA[<?xml version="1.0"?>
<!--This CDATA section contains the layout information of the package. The section includes information such as (x,y) coordinates, width, and height.-->
<!--If you manually edit this section and make a mistake, you can delete it. -->
<!--The package will still be able to load normally but the previous layout information will be lost and the designer will automatically re-arrange the elements on the design surface.-->
<Objects
  Version="8">
  <!--Each node below will contain properties that do not affect runtime behavior.-->
  <Package
    design-time-name="Package">
    <LayoutInfo>
      <GraphLayout
        Capacity="32" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:mssgm="clr-namespace:Microsoft.SqlServer.Graph.Model;assembly=Microsoft.SqlServer.Graph">
        <NodeLayout
          Size="170,42"
          Id="Package\Create ETL Job Log"
          TopLeft="22,27" />
        <NodeLayout
          Size="123,42"
          Id="Package\Error Log"
          TopLeft="704,45" />
        <NodeLayout
          Size="142,42"
          Id="Package\JOB_STATUS_ID"
          TopLeft="205,11" />
        <NodeLayout
          Size="147,42"
          Id="Package\Load Into STG"
          TopLeft="161,388" />
        <NodeLayout
          Size="182,42"
          Id="Package\log to job status table"
          TopLeft="653,167" />
        <NodeLayout
          Size="142,42"
          Id="Package\Process_Date"
          TopLeft="310,85" />
        <NodeLayout
          Size="180,42"
          Id="Package\Truncate Temp Table"
          TopLeft="425,321" />
        <NodeLayout
          Size="148,42"
          Id="Package\Update Succes"
          TopLeft="656,295" />
        <NodeLayout
          Size="166,42"
          Id="Package\Validate job status"
          TopLeft="410,20" />
        <NodeLayout
          Size="220,42"
          Id="Package\Validate mandatory constraint"
          TopLeft="189,240" />
        <NodeLayout
          Size="225,42"
          Id="Package\Validate primary key constraint"
          TopLeft="291,157" />
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint]"
          TopLeft="257.666666666667,388">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="257.333333333333,-25"
              Start="0,0"
              End="257.333333333333,-17.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,-6.16150740242261" />
                  <mssgle:CubicBezierSegment
                    Point1="0,-6.16150740242261"
                    Point2="0,-10.1615074024226"
                    Point3="4,-10.1615074024226" />
                  <mssgle:LineSegment
                    End="253.333333333333,-10.1615074024226" />
                  <mssgle:CubicBezierSegment
                    Point1="253.333333333333,-10.1615074024226"
                    Point2="257.333333333333,-10.1615074024226"
                    Point3="257.333333333333,-14.1615074024226" />
                  <mssgle:LineSegment
                    End="257.333333333333,-17.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 1]"
          TopLeft="403.5,199">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="-139.833333333333,41"
              Start="0,0"
              End="-139.833333333333,33.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,20.4223826714802" />
                  <mssgle:CubicBezierSegment
                    Point1="0,20.4223826714802"
                    Point2="0,24.4223826714802"
                    Point3="-4,24.4223826714802" />
                  <mssgle:LineSegment
                    End="-135.833333333333,24.4223826714802" />
                  <mssgle:CubicBezierSegment
                    Point1="-135.833333333333,24.4223826714802"
                    Point2="-139.833333333333,24.4223826714802"
                    Point3="-139.833333333333,28.4223826714802" />
                  <mssgle:LineSegment
                    End="-139.833333333333,33.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 2]"
          TopLeft="107,69">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="169,-16"
              Start="0,0"
              End="169,-8.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,18.5" />
                  <mssgle:CubicBezierSegment
                    Point1="0,18.5"
                    Point2="0,22.5"
                    Point3="4,22.5" />
                  <mssgle:LineSegment
                    End="165,22.5" />
                  <mssgle:CubicBezierSegment
                    Point1="165,22.5"
                    Point2="169,22.5"
                    Point3="169,18.5" />
                  <mssgle:LineSegment
                    End="169,-8.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 3]"
          TopLeft="347,32">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="63,9"
              Start="0,0"
              End="55.5,9">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="27.5,0" />
                  <mssgle:CubicBezierSegment
                    Point1="27.5,0"
                    Point2="31.5,0"
                    Point3="31.5,4" />
                  <mssgle:LineSegment
                    End="31.5,5" />
                  <mssgle:CubicBezierSegment
                    Point1="31.5,5"
                    Point2="31.5,9"
                    Point3="35.5,9" />
                  <mssgle:LineSegment
                    End="55.5,9" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 4]"
          TopLeft="381,127">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="22.5,30"
              Start="0,0"
              End="22.5,22.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,11" />
                  <mssgle:CubicBezierSegment
                    Point1="0,11"
                    Point2="0,15"
                    Point3="4,15" />
                  <mssgle:LineSegment
                    End="18.5,15" />
                  <mssgle:CubicBezierSegment
                    Point1="18.5,15"
                    Point2="22.5,15"
                    Point3="22.5,19" />
                  <mssgle:LineSegment
                    End="22.5,22.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 6]"
          TopLeft="605,342">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="51,-26"
              Start="0,0"
              End="43.5,-26">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="21.5,0" />
                  <mssgle:CubicBezierSegment
                    Point1="21.5,0"
                    Point2="25.5,0"
                    Point3="25.5,-4" />
                  <mssgle:LineSegment
                    End="25.5,-22" />
                  <mssgle:CubicBezierSegment
                    Point1="25.5,-22"
                    Point2="25.5,-26"
                    Point3="29.5,-26" />
                  <mssgle:LineSegment
                    End="43.5,-26" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[FALSE]"
          TopLeft="334.333333333333,240">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="409.666666666667,-31"
              Start="0,0"
              End="409.666666666667,-23.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,-8.53429602888087" />
                  <mssgle:CubicBezierSegment
                    Point1="0,-8.53429602888087"
                    Point2="0,-12.5342960288809"
                    Point3="4,-12.5342960288809" />
                  <mssgle:LineSegment
                    End="405.666666666667,-12.5342960288809" />
                  <mssgle:CubicBezierSegment
                    Point1="405.666666666667,-12.5342960288809"
                    Point2="409.666666666667,-12.5342960288809"
                    Point3="409.666666666667,-16.5342960288809" />
                  <mssgle:LineSegment
                    End="409.666666666667,-23.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <mssgm:EdgeLabel
              BoundingBox="181.811731770834,-7.5342960288809,46.043203125,16"
              RelativePosition="Any" />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[False]"
          TopLeft="576,41">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="128,25"
              Start="0,0"
              End="120.5,25">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="60,0" />
                  <mssgle:CubicBezierSegment
                    Point1="60,0"
                    Point2="64,0"
                    Point3="64,4" />
                  <mssgle:LineSegment
                    End="64,21" />
                  <mssgle:CubicBezierSegment
                    Point1="64,21"
                    Point2="64,25"
                    Point3="68,25" />
                  <mssgle:LineSegment
                    End="120.5,25" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <mssgm:EdgeLabel
              BoundingBox="43.395,-22,41.21,16"
              RelativePosition="Any" />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[TRUE]"
          TopLeft="493,62">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="-112,23"
              Start="0,0"
              End="-112,15.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,7.5" />
                  <mssgle:CubicBezierSegment
                    Point1="0,7.5"
                    Point2="0,11.5"
                    Point3="-4,11.5" />
                  <mssgle:LineSegment
                    End="-108,11.5" />
                  <mssgle:CubicBezierSegment
                    Point1="-108,11.5"
                    Point2="-112,11.5"
                    Point3="-112,15.5" />
                  <mssgle:LineSegment
                    End="-112,15.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <mssgm:EdgeLabel
              BoundingBox="-77.4466015625,16.5,42.893203125,16"
              RelativePosition="Any" />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <NodeLayout
          Size="125,42"
          Id="Package\TMP Load"
          TopLeft="183,312" />
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 5]"
          TopLeft="299,282">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="-53.5,30"
              Start="0,0"
              End="-53.5,22.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,11" />
                  <mssgle:CubicBezierSegment
                    Point1="0,11"
                    Point2="0,15"
                    Point3="-4,15" />
                  <mssgle:LineSegment
                    End="-49.5,15" />
                  <mssgle:CubicBezierSegment
                    Point1="-49.5,15"
                    Point2="-53.5,15"
                    Point3="-53.5,19" />
                  <mssgle:LineSegment
                    End="-53.5,22.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 7]"
          TopLeft="245.5,354">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="-34.1666666666667,34"
              Start="0,0"
              End="-34.1666666666667,26.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,16.1803499327053" />
                  <mssgle:CubicBezierSegment
                    Point1="0,16.1803499327053"
                    Point2="0,20.1803499327053"
                    Point3="-4,20.1803499327053" />
                  <mssgle:LineSegment
                    End="-30.1666666666667,20.1803499327053" />
                  <mssgle:CubicBezierSegment
                    Point1="-30.1666666666667,20.1803499327053"
                    Point2="-34.1666666666667,20.1803499327053"
                    Point3="-34.1666666666667,24.1803499327053" />
                  <mssgle:LineSegment
                    End="-34.1666666666667,26.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </Package>
  <DtsEventHandler
    design-time-name="Package.EventHandlers[OnError]">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph">
        <NodeLayout
          Size="162,42"
          Id="Package.EventHandlers[OnError]\ETL_ERROR_LOG"
          TopLeft="60,60" />
      </GraphLayout>
    </LayoutInfo>
  </DtsEventHandler>
  <PrecedenceConstraint
    design-time-name="Package.PrecedenceConstraints[FALSE]">
    <ShowAnnotation>ConstraintName</ShowAnnotation>
  </PrecedenceConstraint>
  <PrecedenceConstraint
    design-time-name="Package.PrecedenceConstraints[False]">
    <ShowAnnotation>ConstraintName</ShowAnnotation>
  </PrecedenceConstraint>
  <PrecedenceConstraint
    design-time-name="Package.PrecedenceConstraints[TRUE]">
    <ShowAnnotation>ConstraintName</ShowAnnotation>
  </PrecedenceConstraint>
</Objects>]]></DTS:DesignTimeProperties>
</DTS:Executable>